!**********************************************************
!  TAX008:  Quarterly State Tax Report - Employee Detail *
!**********************************************************
!***********************************************************************
!                                                                      *
!                                                                      *
!                                                                      *
!                                                                      *
! This software and related documentation are provided under a         *
! license agreement containing restrictions on use and                 *
! disclosure and are protected by intellectual property                *
! laws. Except as expressly permitted in your license agreement        *
! or allowed by law, you may not use, copy, reproduce,                 *
! translate, broadcast, modify, license, transmit, distribute,         *
! exhibit, perform, publish or display any part, in any form or        *
! by any means. Reverse engineering, disassembly, or                   *
! decompilation of this software, unless required by law for           *
! interoperability, is prohibited.                                     *
! The information contained herein is subject to change without        *
! notice and is not warranted to be error-free. If you find any        *
! errors, please report them to us in writing.                         *
!                                                                      *
! Copyright (C) 1988, 2009, Oracle and/or its affiliates.              *
! All Rights Reserved.                                                 *
!                                                                      *
!***********************************************************************
!***********************************************************************
!                                                                      *
!          $Date:  2009/04/17:10:20:23                                 !
!       $Release:  HR9                                                 !
!    $Resolution:  766655                                              !
!                                                                      *
!***********************************************************************
!
!***********************************************************************
! Modified for Education & Government                                  *
! HP99999       Release 8 Technical Merge                              *
!***********************************************************************

#include 'setenv.sqc' !Set environment
#Include 'usarpt.sqc' !USA-specific variables


begin-setup
#Include 'ptset02.sqc'  !printer and pagesize initialization

  declare-report Employee-Detail
    layout=DEFAULT
    printer-type=HP
  end-declare

  declare-report Negative-Report
    layout=DEFAULT
    printer-type=HP
  end-declare

end-setup


begin-report
  do Init-Report
  do Process-Main
  do Stdapi-Term
end-report

begin-procedure Init-Report
  move 'TAX008' to $ReportID
  display 'Quarterly State Tax Report - Employee Detail'

  do Init-DateTime
  do Init-Number
  do Get-Current-DateTime
  do Get-Tax-Reporting-Run-Controls
  do Get-Calendar-Year-Id
  do Stdapi-Init
  do Initialize

end-procedure

begin-procedure Initialize
  move $PeriodEndDate to $AsOfDate  !for included procedures

  create-array
         name=TaxArray size=24
         field=TaxClass:char
         field=TxGrsQTD:number
         field=NLGrsQTD:number
         field=TaxQTD:number

end-procedure


begin-heading 17 For-Reports=(Employee-Detail)

  move 'Quarterly State Tax Report - Employee Detail' to $ReportTitle

  let $tempState =  rtrim($State, ' ')
  if $tempState = $priorState
   if $Company <> $priorCompany
     let $Change = 'Y'
   end-if
  end-if
  #Include 'stdhdg02.sqc'  !standard heading 1
  if $Company <> $priorCompany
    do Get-Company-Data
    move $Company to $priorCompany
    move ''       to $priorState  !force change in State below
  end-if

  if rtrim($State, ' ') <> $priorState  or $Change = 'Y'
    do Get-State-Tax-Data  !Employer_ID_SWT, Employer_ID_SUT, State Name
    let $priorState = rtrim($State, ' ')

    move 0 to #PAGE_NUM
    let $Change = 'N'
  end-if

  add 1 to #PAGE_NUM
  print $StateName         (5,2)
  do Format-DateTime($PeriodEndDate, $out, {DEFDATE}, '', '')
  print $out       (0,53)
  do Format-Number(#PAGE_NUM, $out, '999')
  print $out               (0,70)
  print $CompanyName       (+3,12)
  print $CompnyAdd1       (+1,12)
  let $field = RTRIM($CompnyCity, ' ')
  print $field             (+1,12)                    !City
  print &CT.State          ()      edit ,bxx

  move &CT.Postal      to $Zip
  move $Zip            to $ZipExtsn ~~~~~~xxxx

  if instr($Zip,'-',6) = 0 and $ZipExtsn <> '    '
    let $Zip = substr($Zip,1,5) || '-' || substr($Zip,6,4)
  end-if

  move $Zip         to $ZipExtsn ~~~~~xxxxx

  print $Zip               (0,+2)
  print 'Employer ID'      (+2,12)
  if RTRIM(&Employer_ID_SUT, ' ') <> ''
    print &Employer_ID_SUT (+0,+2)
  else
    print &Employer_ID_SWT (+0,+2)
  end-if
  print 'SUT Rate'         (+0,50)
  print &SUT_Experience_Rt (+0,+2) edit b9.999
  print ' '                                    (+3,2)
  print ' '                                    (0,15)
  print '------- Withholding -------'          (0,37)
  print '-------- Unemployment -------------------------'   (0,65)
  print '---------- Disability ---------'      (0,113)
  print '---- VPDI/FLI/Vol FLI/EIC ----'       (0,145)
  print 'SSN'                                  (+1,2)
  print 'Name'                                 (0,15)
  print '   TxGrs QTD        Tax QTD'          (0,37)
  print '     TxGrs QTD   NL Gross QTD        Tax QTD'      (0,65)
  print '    TxGrs QTD        Tax QTD'         (0,113)
  print '    TxGrs QTD       Tax QTD'          (0,145)
end-heading


begin-footing 12 For-Reports=(Employee-Detail)
  let #PgLinePos = 1
  let #DetLinePos = 1
  print 'Page Total'       (#PgLinePos,22)
  do Format-Number(#PgTotTxGrsSWT, $out, '999,999,999.99mi')
  print $out               (#PgLinePos,35)
  do Format-Number(#PgTotTaxSWT, $out, '999,999,999.99mi')
  print $out               (#PgLinePos,50)
  do Format-Number(#PgTotTxGrsSUT, $out, '999,999,999.99mi')
  print $out               (#PgLinePos,65)
  do Format-Number(#PgTotNlGrsSUT, $out, '999,999,999.99mi')
  print $out               (#PgLinePos,80)
  do Format-Number(#PgTotTaxSUT, $out, '999,999,999.99mi')
  print $out               (#PgLinePos,95)
  print 'ER'               (#PgLinePos,+0)
  add 1 to #PgLinePos
  if #PgTotTxGrsSUTEE <> 0 or #PgTotTaxSUTEE <> 0
    do Format-Number(#PgTotTxGrsSUTEE, $out, '999,999,999.99mi')
    print $out             (#PgLinePos,65)
    do Format-Number(#PgTotNlGrsSUTEE, $out, '999,999,999.99mi')
    print $out             (#PgLinePos,80)
    do Format-Number(#PgTotTaxSUTEE, $out, '999,999,999.99mi')
    print $out             (#PgLinePos,95)
    print 'EE'             (#PgLinePos,+0)
    add 1 to #PgLinePos
  end-if
  if #PgTotTxGrsSWAF  <> 0 or #PgTotTaxSWAF  <> 0
    do Format-Number(#PgTotTxGrsSWAF , $out, '999,999,999.99mi')
    print $out             (#PgLinePos,65)
    do Format-Number(#PgTotNlGrsSWAF , $out, '999,999,999.99mi')
    print $out             (#PgLinePos,80)
    do Format-Number(#PgTotTaxSWAF , $out, '999,999,999.99mi')
    print $out             (#PgLinePos,95)
    print 'SW'             (#PgLinePos,+0)
    add 1 to #PgLinePos
  end-if
  if #PgTotTxGrsWFDP  <> 0 or #PgTotTaxWFDP  <> 0
    do Format-Number(#PgTotTxGrsWFDP , $out, '999,999,999.99mi')
    print $out             (#PgLinePos,65)
    do Format-Number(#PgTotNlGrsWFDP , $out, '999,999,999.99mi')
    print $out             (#PgLinePos,80)
    do Format-Number(#PgTotTaxWFDP , $out, '999,999,999.99mi')
    print $out             (#PgLinePos,95)
    print 'WF'             (#PgLinePos,+0)
    add 1 to #PgLinePos
  end-if
  if #PgTotTxGrsHCSF  <> 0 or #PgTotTaxHCSF  <> 0
    do Format-Number(#PgTotTxGrsHCSF , $out, '999,999,999.99mi')
    print $out             (#PgLinePos,65)
    do Format-Number(#PgTotNlGrsHCSF , $out, '999,999,999.99mi')
    print $out             (#PgLinePos,80)
    do Format-Number(#PgTotTaxHCSF , $out, '999,999,999.99mi')
    print $out             (#PgLinePos,95)
    print 'HC'             (#PgLinePos,+0)
    add 1 to #PgLinePos
  end-if
  if #PgTotTxGrsSUTSp <> 0 or #PgTotTaxSUTSp <> 0
    do Format-Number(#PgTotTxGrsSUTSp, $out, '999,999,999.99mi')
    print $out               (#PgLinePos,65)
    do Format-Number(#PgTotNlGrsSUTSp, $out, '999,999,999.99mi')
    print $out               (#PgLinePos,80)
    do Format-Number(#PgTotTaxSUTSp, $out, '999,999,999.99mi')
    print $out               (#PgLinePos,95)
    print 'SP'               (#PgLinePos,+0)
    add 1 to #PgLinePos
  end-if
  do Format-Number(#PgTotTxGrsSDI, $out, '999,999,999.99mi')
  print $out               (1,112)
  do Format-Number(#PgTotTaxSDI, $out, '999,999,999.99mi')
  print $out               (1,127)
  do Format-Number(#PgTotTxGrsSDIE, $out, '999,999,999.99mi')
  print $out               (2,112)
  do Format-Number(#PgTotTaxSDIE, $out, '999,999,999.99mi')
  print $out               (2,127)
  print 'ER'               (2,+0)
  move #PgLinePos to #PgLineMax
  let #PgLinePos = 1
  if #PgTotTxGrsVPDIEE <> 0 or #PgTotTaxVPDIEE <> 0
    do Format-Number(#PgTotTxGrsVPDIEE, $out, '999,999,999.99mi')
    print $out               (#PgLinePos,144)
    do Format-Number(#PgTotTaxVPDIEE, $out, '999,999,999.99mi')
    print $out               (#PgLinePos,159)
    print 'VPDI EE'          (#PgLinePos,+0)
    add 1 to #PgLinePos
  end-if
  if #PgTotTxGrsVPDI <> 0 or #PgTotTaxVPDI <> 0
    do Format-Number(#PgTotTxGrsVPDI, $out, '999,999,999.99mi')
    print $out               (#PgLinePos,144)
    do Format-Number(#PgTotTaxVPDI, $out, '999,999,999.99mi')
    print $out               (#PgLinePos,159)
    print 'VPDI ER'          (#PgLinePos,+0)
    add 1 to #PgLinePos
  end-if
  if #PgTotTxGrsFLI <> 0 or #PgTotTaxFLI <> 0
    do Format-Number(#PgTotTxGrsFLI, $out, '999,999,999.99mi')
    print $out               (#PgLinePos,144)
    do Format-Number(#PgTotTaxFLI, $out, '999,999,999.99mi')
    print $out               (#PgLinePos,159)
    print 'FLI EE'           (#PgLinePos,+0)
    add 1 to #PgLinePos
  end-if
  if #PgTotTxGrsVFLIEE <> 0 or #PgTotTaxVFLIEE <> 0
    do Format-Number(#PgTotTxGrsVFLIEE, $out, '999,999,999.99mi')
    print $out               (#PgLinePos,144)
    do Format-Number(#PgTotTaxVFLIEE, $out, '999,999,999.99mi')
    print $out               (#PgLinePos,159)
    print 'VFLI EE'          (#PgLinePos,+0)
    add 1 to #PgLinePos
  end-if
  if #PgTotTxGrsVFLIER <> 0 or #PgTotTaxVFLIER <> 0
    do Format-Number(#PgTotTxGrsVFLIER, $out, '999,999,999.99mi')
    print $out               (#PgLinePos,144)
    do Format-Number(#PgTotTaxVFLIER, $out, '999,999,999.99mi')
    print $out               (#PgLinePos,159)
    print 'VFLI ER'          (#PgLinePos,+0)
    add 1 to #PgLinePos
  end-if
  if #PgTotTxGrsEIC <> 0 or #PgTotTaxEIC <> 0
    do Format-Number(#PgTotTxGrsEIC, $out, '999,999,999.99mi')
    print $out               (#PgLinePos,144)
    do Format-Number(#PgTotTaxEIC, $out, '999,999,999.99mi')
    print $out               (#PgLinePos,159)
    print 'EIC'              (#PgLinePos,+0)
    add 1 to #PgLinePos
  end-if

  if #PgLinePos > #PgLineMax
    move #PgLinePos to #PgLineMax
  end-if

  move 0 to #PgTotTxGrsSWT
  move 0 to #PgTotTaxSWT
  move 0 to #PgTotTxGrsSUT
  move 0 to #PgTotNlGrsSUT
  move 0 to #PgTotTaxSUT
  move 0 to #PgTotTxGrsSDI
  move 0 to #PgTotTaxSDI
  move 0 to #PgTotTxGrsSDIE
  move 0 to #PgTotTaxSDIE
  move 0 to #PgTotTxGrsSWAF
  move 0 to #PgTotNlGrsSWAF
  move 0 to #PgTotTaxSWAF
  move 0 to #PgTotTxGrsWFDP
  move 0 to #PgTotNlGrsWFDP
  move 0 to #PgTotTaxWFDP
  move 0 to #PgTotTxGrsHCSF
  move 0 to #PgTotNlGrsHCSF
  move 0 to #PgTotTaxHCSF
  move 0 to #PgTotTxGrsSUTEE
  move 0 to #PgTotNlGrsSUTEE
  move 0 to #PgTotTaxSUTEE
  move 0 to #PgTotTxGrsSUTSp
  move 0 to #PgTotNlGrsSUTSp
  move 0 to #PgTotTaxSUTSp
  move 0 to #PgTotTxGrsVPDIEE
  move 0 to #PgTotTaxVPDIEE
  move 0 to #PgTotTxGrsVPDI
  move 0 to #PgTotTaxVPDI
  move 0 to #PgTotTxGrsEIC
  move 0 to #PgTotTaxEIC
  move 0 to #PgTotTxGrsFLI
  move 0 to #PgTotTaxFLI
  move 0 to #PgTotTxGrsVFLIEE
  move 0 to #PgTotTaxVFLIEE
  move 0 to #PgTotTxGrsVFLIER
  move 0 to #PgTotTaxVFLIER

  if $Print_State_Totals = 'Y'
    move #PgLineMax to #PgLinePos
    add 1 to #PgLinePos
    print 'State Total'      (#PgLinePos,21)
    do Format-Number(#StTotTxGrsSWT, $out, '999,999,999.99mi')
    print $out               (#PgLinePos,35)
    do Format-Number(#StTotTaxSWT, $out, '999,999,999.99mi')
    print $out               (#PgLinePos,50)
    do Format-Number(#StTotTxGrsSUT, $out, '999,999,999.99mi')
    print $out               (#PgLinePos,65)
    do Format-Number(#StTotNlGrsSUT, $out, '999,999,999.99mi')
    print $out               (#PgLinePos,80)
    do Format-Number(#StTotTaxSUT, $out, '999,999,999.99mi')
    print $out               (#PgLinePos,95)
    print 'ER'               (#PgLinePos,+0)
    do Format-Number(#StTotTxGrsSDI, $out, '999,999,999.99mi')
    print $out               (#PgLinePos,112)
    do Format-Number(#StTotTaxSDI, $out, '999,999,999.99mi')
    print $out               (#PgLinePos,127)
    add 1 to #PgLinePos
    do Format-Number(#StTotTxGrsSDIE, $out, '999,999,999.99mi')
    print $out               (#PgLinePos,112)
    do Format-Number(#StTotTaxSDIE, $out, '999,999,999.99mi')
    print $out               (#PgLinePos,127)
    print 'ER'               (#PgLinePos,+0)
    if #StTotTxGrsSUTEE <> 0 or #StTotTaxSUTEE <> 0
      do Format-Number(#StTotTxGrsSUTEE, $out, '999,999,999.99mi')
      print $out             (#PgLinePos,65)
      do Format-Number(#StTotNlGrsSUTEE, $out, '999,999,999.99mi')
      print $out             (#PgLinePos,80)
      do Format-Number(#StTotTaxSUTEE, $out, '999,999,999.99mi')
      print $out             (#PgLinePos,95)
      print 'EE'             (#PgLinePos,+0)
      add 1 to #PgLinePos
    end-if
    if #StTotTxGrsSWAF  <> 0 or #StTotTaxSWAF  <> 0
      do Format-Number(#StTotTxGrsSWAF , $out, '999,999,999.99mi')
      print $out             (#PgLinePos,65)
      do Format-Number(#StTotNlGrsSWAF, $out, '999,999,999.99mi')
      print $out             (#PgLinePos,80)
      do Format-Number(#StTotTaxSWAF , $out, '999,999,999.99mi')
      print $out             (#PgLinePos,95)
      print 'SW'             (#PgLinePos,+0)
      add 1 to #PgLinePos
    end-if
    if #StTotTxGrsWFDP  <> 0 or #StTotTaxWFDP  <> 0
      do Format-Number(#StTotTxGrsWFDP , $out, '999,999,999.99mi')
      print $out             (#PgLinePos,65)
      do Format-Number(#StTotNlGrsWFDP, $out, '999,999,999.99mi')
      print $out             (#PgLinePos,80)
      do Format-Number(#StTotTaxWFDP , $out, '999,999,999.99mi')
      print $out             (#PgLinePos,95)
      print 'WF'             (#PgLinePos,+0)
      add 1 to #PgLinePos
    end-if
    if #StTotTxGrsHCSF  <> 0 or #StTotTaxHCSF  <> 0
      do Format-Number(#StTotTxGrsHCSF , $out, '999,999,999.99mi')
      print $out             (#PgLinePos,65)
      do Format-Number(#StTotNlGrsHCSF, $out, '999,999,999.99mi')
      print $out             (#PgLinePos,80)
      do Format-Number(#StTotTaxHCSF , $out, '999,999,999.99mi')
      print $out             (#PgLinePos,95)
      print 'HC'             (#PgLinePos,+0)
      add 1 to #PgLinePos
    end-if
    if #StTotTxGrsSUTSp <> 0 or #StTotTaxSUTSp <> 0
      do Format-Number(#StTotTxGrsSUTSp, $out, '999,999,999.99mi')
      print $out             (#PgLinePos,65)
      do Format-Number(#StTotNlGrsSUTSp, $out, '999,999,999.99mi')
      print $out             (#PgLinePos,80)
      do Format-Number(#StTotTaxSUTSp, $out, '999,999,999.99mi')
      print $out             (#PgLinePos,95)
      print 'SP'             (#PgLinePos,+0)
    end-if
    move #PgLineMax to #PgLinePos
    add 1 to #PgLinePos
    if #StTotTxGrsVPDIEE <> 0 or #StTotTaxVPDIEE <> 0
      do Format-Number(#StTotTxGrsVPDIEE, $out, '999,999,999.99mi')
      print $out               (#PgLinePos,144)
      do Format-Number(#StTotTaxVPDIEE, $out, '999,999,999.99mi')
      print $out               (#PgLinePos,159)
      print 'VPDI EE'          (#PgLinePos,+0)
      add 1 to #PgLinePos
    end-if
    if #StTotTxGrsVPDI <> 0 or #StTotTaxVPDI <> 0
      do Format-Number(#StTotTxGrsVPDI, $out, '999,999,999.99mi')
      print $out               (#PgLinePos,144)
      do Format-Number(#StTotTaxVPDI, $out, '999,999,999.99mi')
      print $out               (#PgLinePos,159)
      print 'VPDI ER'          (#PgLinePos,+0)
      add 1 to #PgLinePos
    end-if
    if #StTotTxGrsFLI <> 0 or #StTotTaxFLI <> 0
      do Format-Number(#StTotTxGrsFLI, $out, '999,999,999.99mi')
      print $out               (#PgLinePos,144)
      do Format-Number(#StTotTaxFLI, $out, '999,999,999.99mi')
      print $out               (#PgLinePos,159)
      print 'FLI EE'           (#PgLinePos,+0)
      add 1 to #PgLinePos
    end-if
    if #StTotTxGrsVFLIEE <> 0 or #StTotTaxVFLIEE <> 0
      do Format-Number(#StTotTxGrsVFLIEE, $out, '999,999,999.99mi')
      print $out               (#PgLinePos,144)
      do Format-Number(#StTotTaxVFLIEE, $out, '999,999,999.99mi')
      print $out               (#PgLinePos,159)
      print 'VFLI EE'          (#PgLinePos,+0)
      add 1 to #PgLinePos
    end-if
    if #StTotTxGrsVFLIER <> 0 or #StTotTaxVFLIER <> 0
      do Format-Number(#StTotTxGrsVFLIER, $out, '999,999,999.99mi')
      print $out               (#PgLinePos,144)
      do Format-Number(#StTotTaxVFLIER, $out, '999,999,999.99mi')
      print $out               (#PgLinePos,159)
      print 'VFLI ER'          (#PgLinePos,+0)
      add 1 to #PgLinePos
    end-if
    if #StTotTxGrsEIC <> 0 or #StTotTaxEIC <> 0
      do Format-Number(#StTotTxGrsEIC, $out, '999,999,999.99mi')
      print $out               (#PgLinePos,144)
      do Format-Number(#StTotTaxEIC, $out, '999,999,999.99mi')
      print $out               (#PgLinePos,159)
      print 'EIC'              (#PgLinePos,+0)
      add 1 to #PgLinePos
    end-if

    move 0 to #StTotTxGrsSWT
    move 0 to #StTotTaxSWT
    move 0 to #StTotTxGrsSUT
    move 0 to #StTotNlGrsSUT
    move 0 to #StTotTaxSUT
    move 0 to #StTotTxGrsSDI
    move 0 to #StTotTaxSDI
    move 0 to #StTotTxGrsSDIE
    move 0 to #StTotTaxSDIE
    move 0 to #StTotTxGrsSWAF
    move 0 to #StTotNlGrsSWAF
    move 0 to #StTotTaxSWAF
    move 0 to #StTotTxGrsWFDP
    move 0 to #StTotNlGrsWFDP
    move 0 to #StTotTaxWFDP
    move 0 to #StTotTxGrsHCSF
    move 0 to #StTotNlGrsHCSF
    move 0 to #StTotTaxHCSF
    move 0 to #StTotTxGrsSUTEE
    move 0 to #StTotNlGrsSUTEE
    move 0 to #StTotTaxSUTEE
    move 0 to #StTotTxGrsSUTSp
    move 0 to #StTotNlGrsSUTSp
    move 0 to #StTotTaxSUTSp
    move 0 to #StTotTxGrsVPDIEE
    move 0 to #StTotTaxVPDIEE
    move 0 to #StTotTxGrsVPDI
    move 0 to #StTotTaxVPDI
    move 0 to #StTotTxGrsEIC
    move 0 to #StTotTaxEIC
    move 0 to #StTotTxGrsFLI
    move 0 to #StTotTaxFLI
    move 0 to #StTotTxGrsVFLIEE
    move 0 to #StTotTaxVFLIEE
    move 0 to #StTotTxGrsVFLIER
    move 0 to #StTotTaxVFLIER
  end-if
end-footing


begin-heading 17 For-Reports=(Negative-Report)

  move 'Quarterly State Tax Report - Negative Wage Listing' to $ReportTitle

  let $tempState =  rtrim($State, ' ')
  if $tempState = $priorState2
   if $Company <> $priorCompany2
     let $Change2 = 'Y'
   end-if
  end-if
  #Include 'stdhdg02.sqc'  !standard heading 1
  if $Company <> $priorCompany2
    do Get-Company-Data
    move $Company to $priorCompany2
    move ''       to $priorState2  !force change in State below
  end-if

  if rtrim($State, ' ') <> $priorState2  or $Change2 = 'Y'
    do Get-State-Tax-Data  !Employer_ID_SWT, Employer_ID_SUT, State Name
    let $priorState2 = rtrim($State, ' ')

    move 0 to #PAGE_NUM2
    let $Change2 = 'N'
  end-if

  add 1 to #PAGE_NUM2
  print $StateName         (5,2)
  do Format-DateTime($PeriodEndDate, $out, {DEFDATE}, '', '')
  print $out       (0,53)
  do Format-Number(#PAGE_NUM2, $out, '999')
  print $out               (0,70)
  print $CompanyName       (+3,12)
  print $CompnyAdd1       (+1,12)
  let $field = RTRIM($CompnyCity, ' ')
  print $field             (+1,12)                    !City
  print &CT.State          ()      edit ,bxx

  move &CT.Postal      to $Zip
  move $Zip            to $ZipExtsn ~~~~~~xxxx

  if instr($Zip,'-',6) = 0 and $ZipExtsn <> '    '
    let $Zip = substr($Zip,1,5) || '-' || substr($Zip,6,4)
  end-if

  move $Zip         to $ZipExtsn ~~~~~xxxxx

  print $Zip               (0,+2)
  print 'Employer ID'      (+2,12)
  if RTRIM(&Employer_ID_SUT, ' ') <> ''
    print &Employer_ID_SUT (+0,+2)
  else
    print &Employer_ID_SWT (+0,+2)
  end-if
  print 'SUT Rate'         (+0,50)
  print &SUT_Experience_Rt (+0,+2) edit b9.999
  print ' '                                    (+3,2)
  print ' '                                    (0,15)
  print '------- Withholding -------'          (0,37)
  print '-------- Unemployment -------------------------'   (0,65)
  print '---------- Disability ---------'      (0,113)
  print '---- VPDI/FLI/Vol FLI/EIC ----'       (0,145)
  print 'SSN'                                  (+1,2)
  print 'Name'                                 (0,15)
  print '   TxGrs QTD        Tax QTD'          (0,37)
  print '     TxGrs QTD   NL Gross QTD        Tax QTD'      (0,65)
  print '    TxGrs QTD        Tax QTD'         (0,113)
  print '    TxGrs QTD       Tax QTD'          (0,145)
end-heading

begin-footing 12 For-Reports=(Negative-Report)
  let #NegPgLinePos = 1
  let #NegDetLinePos = 1
  print 'Page Total'       (#NegPgLinePos,22)
  do Format-Number(#NegPgTotTxGrsSWT, $out, '999,999,999.99mi')
  print $out               (#NegPgLinePos,35)
  do Format-Number(#NegPgTotTaxSWT, $out, '999,999,999.99mi')
  print $out               (#NegPgLinePos,50)
  do Format-Number(#NegPgTotTxGrsSUT, $out, '999,999,999.99mi')
  print $out               (#NegPgLinePos,65)
  do Format-Number(#NegPgTotNlGrsSUT, $out, '999,999,999.99mi')
  print $out               (#NegPgLinePos,80)
  do Format-Number(#NegPgTotTaxSUT, $out, '999,999,999.99mi')
  print $out               (#NegPgLinePos,95)
  print 'ER'               (#NegPgLinePos,+0)
  add 1 to #NegPgLinePos
  if #NegPgTotTxGrsSUTEE <> 0 or #NegPgTotTaxSUTEE <> 0
    do Format-Number(#NegPgTotTxGrsSUTEE, $out, '999,999,999.99mi')
    print $out             (#NegPgLinePos,65)
    do Format-Number(#NegPgTotNlGrsSUTEE, $out, '999,999,999.99mi')
    print $out             (#NegPgLinePos,80)
    do Format-Number(#NegPgTotTaxSUTEE, $out, '999,999,999.99mi')
    print $out             (#NegPgLinePos,95)
    print 'EE'             (#NegPgLinePos,+0)
    add 1 to #NegPgLinePos
  end-if
  if #NegPgTotTxGrsSWAF  <> 0 or #NegPgTotTaxSWAF  <> 0
    do Format-Number(#NegPgTotTxGrsSWAF , $out, '999,999,999.99mi')
    print $out             (#NegPgLinePos,65)
    do Format-Number(#NegPgTotNlGrsSWAF , $out, '999,999,999.99mi')
    print $out             (#NegPgLinePos,80)
    do Format-Number(#NegPgTotTaxSWAF , $out, '999,999,999.99mi')
    print $out             (#NegPgLinePos,95)
    print 'SW'             (#NegPgLinePos,+0)
    add 1 to #NegPgLinePos
  end-if
  if #NegPgTotTxGrsWFDP  <> 0 or #NegPgTotTaxWFDP  <> 0
    do Format-Number(#NegPgTotTxGrsWFDP , $out, '999,999,999.99mi')
    print $out             (#NegPgLinePos,65)
    do Format-Number(#NegPgTotNlGrsWFDP , $out, '999,999,999.99mi')
    print $out             (#NegPgLinePos,80)
    do Format-Number(#NegPgTotTaxWFDP , $out, '999,999,999.99mi')
    print $out             (#NegPgLinePos,95)
    print 'WF'             (#NegPgLinePos,+0)
    add 1 to #NegPgLinePos
  end-if
  if #NegPgTotTxGrsHCSF  <> 0 or #NegPgTotTaxHCSF  <> 0
    do Format-Number(#NegPgTotTxGrsHCSF , $out, '999,999,999.99mi')
    print $out             (#NegPgLinePos,65)
    do Format-Number(#NegPgTotNlGrsHCSF , $out, '999,999,999.99mi')
    print $out             (#NegPgLinePos,80)
    do Format-Number(#NegPgTotTaxHCSF , $out, '999,999,999.99mi')
    print $out             (#NegPgLinePos,95)
    print 'HC'             (#NegPgLinePos,+0)
    add 1 to #NegPgLinePos
  end-if
  if #NegPgTotTxGrsSUTSp <> 0 or #NegPgTotTaxSUTSp <> 0
    do Format-Number(#NegPgTotTxGrsSUTSp, $out, '999,999,999.99mi')
    print $out               (#NegPgLinePos,65)
    do Format-Number(#NegPgTotNlGrsSUTSp, $out, '999,999,999.99mi')
    print $out               (#NegPgLinePos,80)
    do Format-Number(#NegPgTotTaxSUTSp, $out, '999,999,999.99mi')
    print $out               (#NegPgLinePos,95)
    print 'SP'               (#NegPgLinePos,+0)
    add 1 to #NegPgLinePos
  end-if
  do Format-Number(#NegPgTotTxGrsSDI, $out, '999,999,999.99mi')
  print $out               (1,112)
  do Format-Number(#NegPgTotTaxSDI, $out, '999,999,999.99mi')
  print $out               (1,127)
  do Format-Number(#NegPgTotTxGrsSDIE, $out, '999,999,999.99mi')
  print $out               (2,112)
  do Format-Number(#NegPgTotTaxSDIE, $out, '999,999,999.99mi')
  print $out               (2,127)
  print 'ER'               (2,+0)
  move #NegPgLinePos to #NegPgLineMax
  let #NegPgLinePos = 1
  if #NegPgTotTxGrsVPDIEE <> 0 or #NegPgTotTaxVPDIEE <> 0
    do Format-Number(#NegPgTotTxGrsVPDIEE, $out, '999,999,999.99mi')
    print $out               (#NegPgLinePos,144)
    do Format-Number(#NegPgTotTaxVPDIEE, $out, '999,999,999.99mi')
    print $out               (#NegPgLinePos,159)
    print 'VPDI EE'          (#NegPgLinePos,+0)
    add 1 to #NegPgLinePos
  end-if
  if #NegPgTotTxGrsVPDI <> 0 or #NegPgTotTaxVPDI <> 0
    do Format-Number(#NegPgTotTxGrsVPDI, $out, '999,999,999.99mi')
    print $out               (#NegPgLinePos,144)
    do Format-Number(#NegPgTotTaxVPDI, $out, '999,999,999.99mi')
    print $out               (#NegPgLinePos,159)
    print 'VPDI ER'          (#NegPgLinePos,+0)
    add 1 to #NegPgLinePos
  end-if
  if #NegPgTotTxGrsFLI <> 0 or #NegPgTotTaxFLI <> 0
    do Format-Number(#NegPgTotTxGrsFLI, $out, '999,999,999.99mi')
    print $out               (#NegPgLinePos,144)
    do Format-Number(#NegPgTotTaxFLI, $out, '999,999,999.99mi')
    print $out               (#NegPgLinePos,159)
    print 'FLI EE'           (#NegPgLinePos,+0)
    add 1 to #NegPgLinePos
  end-if
  if #NegPgTotTxGrsVFLIEE <> 0 or #NegPgTotTaxVFLIEE <> 0
    do Format-Number(#NegPgTotTxGrsVFLIEE, $out, '999,999,999.99mi')
    print $out               (#NegPgLinePos,144)
    do Format-Number(#NegPgTotTaxVFLIEE, $out, '999,999,999.99mi')
    print $out               (#NegPgLinePos,159)
    print 'VFLI EE'          (#NegPgLinePos,+0)
    add 1 to #NegPgLinePos
  end-if
  if #NegPgTotTxGrsVFLIER <> 0 or #NegPgTotTaxVFLIER <> 0
    do Format-Number(#NegPgTotTxGrsVFLIER, $out, '999,999,999.99mi')
    print $out               (#NegPgLinePos,144)
    do Format-Number(#NegPgTotTaxVFLIER, $out, '999,999,999.99mi')
    print $out               (#NegPgLinePos,159)
    print 'VFLI ER'          (#NegPgLinePos,+0)
    add 1 to #NegPgLinePos
  end-if
  if #NegPgTotTxGrsEIC <> 0 or #NegPgTotTaxEIC <> 0
    do Format-Number(#NegPgTotTxGrsEIC, $out, '999,999,999.99mi')
    print $out               (#NegPgLinePos,144)
    do Format-Number(#NegPgTotTaxEIC, $out, '999,999,999.99mi')
    print $out               (#NegPgLinePos,159)
    print 'EIC'              (#NegPgLinePos,+0)
    add 1 to #NegPgLinePos
  end-if

  if #NegPgLinePos > #NegPgLineMax
    move #NegPgLinePos to #NegPgLineMax
  end-if

  move 0 to #NegPgTotTxGrsSWT
  move 0 to #NegPgTotTaxSWT
  move 0 to #NegPgTotTxGrsSUT
  move 0 to #NegPgTotNlGrsSUT
  move 0 to #NegPgTotTaxSUT
  move 0 to #NegPgTotTxGrsSDI
  move 0 to #NegPgTotTaxSDI
  move 0 to #NegPgTotTxGrsSDIE
  move 0 to #NegPgTotTaxSDIE
  move 0 to #NegPgTotTxGrsSWAF
  move 0 to #NegPgTotNlGrsSWAF
  move 0 to #NegPgTotTaxSWAF
  move 0 to #NegPgTotTxGrsWFDP
  move 0 to #NegPgTotNlGrsWFDP
  move 0 to #NegPgTotTaxWFDP
  move 0 to #NegPgTotTxGrsHCSF
  move 0 to #NegPgTotNlGrsHCSF
  move 0 to #NegPgTotTaxHCSF
  move 0 to #NegPgTotTxGrsSUTEE
  move 0 to #NegPgTotNlGrsSUTEE
  move 0 to #NegPgTotTaxSUTEE
  move 0 to #NegPgTotTxGrsSUTSp
  move 0 to #NegPgTotNlGrsSUTSp
  move 0 to #NegPgTotTaxSUTSp
  move 0 to #NegPgTotTxGrsVPDIEE
  move 0 to #NegPgTotTaxVPDIEE
  move 0 to #NegPgTotTxGrsVPDI
  move 0 to #NegPgTotTaxVPDI
  move 0 to #NegPgTotTxGrsEIC
  move 0 to #NegPgTotTaxEIC
  move 0 to #NegPgTotTxGrsFLI
  move 0 to #NegPgTotTaxFLI
  move 0 to #NegPgTotTxGrsVFLIEE
  move 0 to #NegPgTotTaxVFLIEE
  move 0 to #NegPgTotTxGrsVFLIER
  move 0 to #NegPgTotTaxVFLIER

  if $Print_Neg_State_Totals = 'Y'
    move #NegPgLineMax to #NegPgLinePos
    add 1 to #NegPgLinePos
    print 'State Total'      (#NegPgLinePos,21)
    do Format-Number(#NegStTotTxGrsSWT, $out, '999,999,999.99mi')
    print $out               (#NegPgLinePos,35)
    do Format-Number(#NegStTotTaxSWT, $out, '999,999,999.99mi')
    print $out               (#NegPgLinePos,50)
    do Format-Number(#NegStTotTxGrsSUT, $out, '999,999,999.99mi')
    print $out               (#NegPgLinePos,65)
    do Format-Number(#NegStTotNlGrsSUT, $out, '999,999,999.99mi')
    print $out               (#NegPgLinePos,80)
    do Format-Number(#NegStTotTaxSUT, $out, '999,999,999.99mi')
    print $out               (#NegPgLinePos,95)
    print 'ER'               (#NegPgLinePos,+0)
    do Format-Number(#NegStTotTxGrsSDI, $out, '999,999,999.99mi')
    print $out               (#NegPgLinePos,112)
    do Format-Number(#NegStTotTaxSDI, $out, '999,999,999.99mi')
    print $out               (#NegPgLinePos,127)
    add 1 to #NegPgLinePos
    do Format-Number(#NegStTotTxGrsSDIE, $out, '999,999,999.99mi')
    print $out               (#NegPgLinePos,112)
    do Format-Number(#NegStTotTaxSDIE, $out, '999,999,999.99mi')
    print $out               (#NegPgLinePos,127)
    print 'ER'               (#NegPgLinePos,+0)
    if #NegStTotTxGrsSUTEE <> 0 or #NegStTotTaxSUTEE <> 0
      do Format-Number(#NegStTotTxGrsSUTEE, $out, '999,999,999.99mi')
      print $out             (#NegPgLinePos,65)
      do Format-Number(#NegStTotNlGrsSUTEE, $out, '999,999,999.99mi')
      print $out             (#NegPgLinePos,80)
      do Format-Number(#NegStTotTaxSUTEE, $out, '999,999,999.99mi')
      print $out             (#NegPgLinePos,95)
      print 'EE'             (#NegPgLinePos,+0)
      add 1 to #NegPgLinePos
    end-if
    if #NegStTotTxGrsSWAF  <> 0 or #NegStTotTaxSWAF  <> 0
      do Format-Number(#NegStTotTxGrsSWAF , $out, '999,999,999.99mi')
      print $out             (#NegPgLinePos,65)
      do Format-Number(#NegStTotNlGrsSWAF, $out, '999,999,999.99mi')
      print $out             (#NegPgLinePos,80)
      do Format-Number(#NegStTotTaxSWAF , $out, '999,999,999.99mi')
      print $out             (#NegPgLinePos,95)
      print 'SW'             (#NegPgLinePos,+0)
      add 1 to #NegPgLinePos
    end-if
    if #NegStTotTxGrsWFDP  <> 0 or #NegStTotTaxWFDP  <> 0
      do Format-Number(#NegStTotTxGrsWFDP , $out, '999,999,999.99mi')
      print $out             (#NegPgLinePos,65)
      do Format-Number(#NegStTotNlGrsWFDP, $out, '999,999,999.99mi')
      print $out             (#NegPgLinePos,80)
      do Format-Number(#NegStTotTaxWFDP , $out, '999,999,999.99mi')
      print $out             (#NegPgLinePos,95)
      print 'WF'             (#NegPgLinePos,+0)
      add 1 to #NegPgLinePos
    end-if
    if #NegStTotTxGrsHCSF  <> 0 or #NegStTotTaxHCSF  <> 0
      do Format-Number(#NegStTotTxGrsHCSF , $out, '999,999,999.99mi')
      print $out             (#NegPgLinePos,65)
      do Format-Number(#NegStTotNlGrsHCSF, $out, '999,999,999.99mi')
      print $out             (#NegPgLinePos,80)
      do Format-Number(#NegStTotTaxHCSF , $out, '999,999,999.99mi')
      print $out             (#NegPgLinePos,95)
      print 'HC'             (#NegPgLinePos,+0)
      add 1 to #NegPgLinePos
    end-if
    if #NegStTotTxGrsSUTSp <> 0 or #NegStTotTaxSUTSp <> 0
      do Format-Number(#NegStTotTxGrsSUTSp, $out, '999,999,999.99mi')
      print $out             (#NegPgLinePos,65)
      do Format-Number(#NegStTotNlGrsSUTSp, $out, '999,999,999.99mi')
      print $out             (#NegPgLinePos,80)
      do Format-Number(#NegStTotTaxSUTSp, $out, '999,999,999.99mi')
      print $out             (#NegPgLinePos,95)
      print 'SP'             (#NegPgLinePos,+0)
    end-if
    move #NegPgLineMax to #NegPgLinePos
    add 1 to #NegPgLinePos
    if #NegStTotTxGrsVPDIEE <> 0 or #NegStTotTaxVPDIEE <> 0
      do Format-Number(#NegStTotTxGrsVPDIEE, $out, '999,999,999.99mi')
      print $out               (#NegPgLinePos,144)
      do Format-Number(#NegStTotTaxVPDIEE, $out, '999,999,999.99mi')
      print $out               (#NegPgLinePos,159)
      print 'VPDI EE'          (#NegPgLinePos,+0)
      add 1 to #NegPgLinePos
    end-if
    if #NegStTotTxGrsVPDI <> 0 or #NegStTotTaxVPDI <> 0
      do Format-Number(#NegStTotTxGrsVPDI, $out, '999,999,999.99mi')
      print $out               (#NegPgLinePos,144)
      do Format-Number(#NegStTotTaxVPDI, $out, '999,999,999.99mi')
      print $out               (#NegPgLinePos,159)
      print 'VPDI ER'          (#NegPgLinePos,+0)
      add 1 to #NegPgLinePos
    end-if
    if #NegStTotTxGrsFLI <> 0 or #NegStTotTaxFLI <> 0
      do Format-Number(#NegStTotTxGrsFLI, $out, '999,999,999.99mi')
      print $out               (#NegPgLinePos,144)
      do Format-Number(#NegStTotTaxFLI, $out, '999,999,999.99mi')
      print $out               (#NegPgLinePos,159)
      print 'FLI EE'           (#NegPgLinePos,+0)
      add 1 to #NegPgLinePos
    end-if
    if #NegStTotTxGrsVFLIEE <> 0 or #NegStTotTaxVFLIEE <> 0
      do Format-Number(#NegStTotTxGrsVFLIEE, $out, '999,999,999.99mi')
      print $out               (#NegPgLinePos,144)
      do Format-Number(#NegStTotTaxVFLIEE, $out, '999,999,999.99mi')
      print $out               (#NegPgLinePos,159)
      print 'VFLI EE'          (#NegPgLinePos,+0)
      add 1 to #NegPgLinePos
    end-if
    if #NegStTotTxGrsVFLIER <> 0 or #NegStTotTaxVFLIER <> 0
      do Format-Number(#NegStTotTxGrsVFLIER, $out, '999,999,999.99mi')
      print $out               (#NegPgLinePos,144)
      do Format-Number(#NegStTotTaxVFLIER, $out, '999,999,999.99mi')
      print $out               (#NegPgLinePos,159)
      print 'VFLI ER'          (#NegPgLinePos,+0)
      add 1 to #NegPgLinePos
    end-if
    if #NegStTotTxGrsEIC <> 0 or #NegStTotTaxEIC <> 0
      do Format-Number(#NegStTotTxGrsEIC, $out, '999,999,999.99mi')
      print $out               (#NegPgLinePos,144)
      do Format-Number(#NegStTotTaxEIC, $out, '999,999,999.99mi')
      print $out               (#NegPgLinePos,159)
      print 'EIC'              (#NegPgLinePos,+0)
      add 1 to #NegPgLinePos
    end-if

    move 0 to #NegStTotTxGrsSWT
    move 0 to #NegStTotTaxSWT
    move 0 to #NegStTotTxGrsSUT
    move 0 to #NegStTotNlGrsSUT
    move 0 to #NegStTotTaxSUT
    move 0 to #NegStTotTxGrsSDI
    move 0 to #NegStTotTaxSDI
    move 0 to #NegStTotTxGrsSDIE
    move 0 to #NegStTotTaxSDIE
    move 0 to #NegStTotTxGrsSWAF
    move 0 to #NegStTotNlGrsSWAF
    move 0 to #NegStTotTaxSWAF
    move 0 to #NegStTotTxGrsWFDP
    move 0 to #NegStTotNlGrsWFDP
    move 0 to #NegStTotTaxWFDP
    move 0 to #NegStTotTxGrsHCSF
    move 0 to #NegStTotNlGrsHCSF
    move 0 to #NegStTotTaxHCSF
    move 0 to #NegStTotTxGrsSUTEE
    move 0 to #NegStTotNlGrsSUTEE
    move 0 to #NegStTotTaxSUTEE
    move 0 to #NegStTotTxGrsSUTSp
    move 0 to #NegStTotNlGrsSUTSp
    move 0 to #NegStTotTaxSUTSp
    move 0 to #NegStTotTxGrsVPDIEE
    move 0 to #NegStTotTaxVPDIEE
    move 0 to #NegStTotTxGrsVPDI
    move 0 to #NegStTotTaxVPDI
    move 0 to #NegStTotTxGrsEIC
    move 0 to #NegStTotTaxEIC
    move 0 to #NegStTotTxGrsFLI
    move 0 to #NegStTotTaxFLI
    move 0 to #NegStTotTxGrsVFLIEE
    move 0 to #NegStTotTaxVFLIEE
    move 0 to #NegStTotTxGrsVFLIER
    move 0 to #NegStTotTaxVFLIER
  end-if
end-footing


begin-procedure Process-Main

  let $Print-Neg-Balances = 'N'
  let $Neg-Balances-Found = 'N'
  let $Neg-Report-Printed = 'N'
  let #I = 0

  Use-Report Employee-Detail

begin-SELECT
TEMP_SSN_MASK
FROM PS_INSTALLATION
end-SELECT

begin-SELECT
C.COMPANY        () on-break print=never level=1
C.STATE          () on-break print=never level=2 after=After-State
D1.NATIONAL_ID   () on-break print=never level=3 before=New-Employee
D.NAME           () on-break print=never level=3 before=New-Employee
C.EMPLID
C.TAX_CLASS
SUM(C.TXGRS_QTD) &C.TxGrs_QTD
SUM(C.TAX_QTD)   &C.Tax_QTD
SUM(C.NLGRS_QTD) &C.NLGrs_QTD

  do Process-Tax-Balance

FROM  PS_TAX_BALANCE C, PS_PERSON_NAME D, PS_PERS_NID D1
WHERE D.EMPLID   = C.EMPLID
  AND D1.EMPLID  = D.EMPLID
  AND D1.COUNTRY = {NID_Country}
  AND D1.NATIONAL_ID_TYPE = $PAYROLL_NID_TYPE
  AND C.STATE NOT IN ('$U','$UPR','$UAS','$UGU','$UVI') !Not a Federal entry
  AND C.LOCALITY      = ' '
  AND C.BALANCE_ID    = $Calendar_Year_Id
  AND C.BALANCE_YEAR  = &TX.Balance_Year
  AND C.BALANCE_QTR   = &TX.Balance_Qtr
  AND C.BALANCE_PERIOD  =
      (SELECT MAX(BALANCE_PERIOD)
       FROM   PS_TAX_BALANCE
       WHERE  EMPLID        = C.EMPLID
         AND  COMPANY       = C.COMPANY
         AND  BALANCE_ID    = C.BALANCE_ID
         AND  BALANCE_YEAR  = C.BALANCE_YEAR
         AND  BALANCE_QTR   = C.BALANCE_QTR
         AND  STATE         = C.STATE
         AND  LOCALITY      = C.LOCALITY
         AND  TAX_CLASS     = C.TAX_CLASS)
GROUP BY C.COMPANY, C.STATE, D1.NATIONAL_ID, D.NAME, C.EMPLID, C.TAX_CLASS
ORDER BY C.COMPANY, C.STATE, D1.NATIONAL_ID, D.NAME, C.EMPLID, C.TAX_CLASS
end-SELECT

  move 'Y' to $Print_State_Totals

  if $Neg-Report-Printed = 'Y'
     display 'Quarterly State Tax Report - Negative Wage Listing'
  end-if

end-procedure

begin-procedure New-Employee

  if (&D.Name <> $priorName) OR
     (&D1.NATIONAL_ID <> $priorSSN)
    next-listing need=5

    move &D1.NATIONAL_ID  to $S123 xxx       !isolate first 3 digits
    if $S123 = &Temp_SSN_Mask or RTRIM(&D1.NATIONAL_ID, ' ') = ''
      print 'Applied For' (1,2)
    else
      print &D1.NATIONAL_ID       (1,2)  edit xxxbxxbxxxx
    end-if

    print &D.Name         (1,15,19)

      if $Print-Neg-Balances = 'Y'
         let $Neg-Balances-Found = 'Y'
         do Print-Neg-Report-EmpName
         do Print-Negative-Report
      end-if

      move &D1.NATIONAL_ID to $priorSSN
    move &D.Name to $priorName

    move &C.EmplID  to $EmplID
    move &C.Company to $Company
    let $State = rtrim(&C.State, ' ')

    let #DetLinePos = 1
    let #DetLinePos2 = 1
    let $TaxClassA1042 = 'N'

      clear-array name=TaxArray
      let #I = 0
  end-if

end-procedure

begin-procedure Process-Tax-Balance

  if (&C.TxGrs_QTD < 0) OR
     (&C.Tax_QTD   < 0) OR
     (&C.NLGrs_QTD < 0)

      let $Print-Neg-Balances = 'Y'
  end-if

  put &C.Tax_Class   &C.TxGrs_QTD   &C.NLGrs_QTD   &C.Tax_QTD
      into TaxArray(#I)

  let #I = #I + 1


  evaluate &C.Tax_Class
    when = 'D'                                         !Disability
      do Format-Number(&C.TxGrs_QTD, $out, '99,999,999.99mi')
      print $out             (1,113)
      do Format-Number(&C.Tax_QTD, $out, '99,999,999.99mi')
      print $out             (1,128)

      add &C.TxGrs_QTD to #PgTotTxGrsSDI
      add &C.TxGrs_QTD to #StTotTxGrsSDI
      add &C.Tax_QTD   to #PgTotTaxSDI
      add &C.Tax_QTD   to #StTotTaxSDI
    break

    when = 'E'                                         !Disability Employer
      do Format-Number(&C.TxGrs_QTD, $out, '99,999,999.99mi')
      print $out             (2,113)
      do Format-Number(&C.Tax_QTD, $out, '99,999,999.99mi')
      print $out             (2,128)
      print 'ER'             (2,+0)

      add &C.TxGrs_QTD to #PgTotTxGrsSDIE
      add &C.TxGrs_QTD to #StTotTxGrsSDIE
      add &C.Tax_QTD   to #PgTotTaxSDIE
      add &C.Tax_QTD   to #StTotTaxSDIE
    break

    when = 'A'                                       !Withholding       !HP99999
      do Format-Number(&C.TxGrs_QTD, $out, '99,999,999.99mi')
      print $out             (1,36)
      do Format-Number(&C.Tax_QTD, $out, '99,999,999.99mi')
      print $out             (1,51)

      add &C.TxGrs_QTD to #PgTotTxGrsSWT
      add &C.TxGrs_QTD to #StTotTxGrsSWT
      add &C.Tax_QTD   to #PgTotTaxSWT
      add &C.Tax_QTD   to #StTotTaxSWT

      move 'Y'         to $TaxClassA1042
    break

    when = 'H'                                       !Withholding
      do Format-Number(&C.TxGrs_QTD, $out, '99,999,999.99mi')
      do Format-Number(&C.Tax_QTD, $out1, '99,999,999.99mi')

      if $TaxClassA1042 = 'Y'
         print $out    (2,36)
         print $out1   (2,51)
      else
         print $out    (1,36)
         print $out1   (1,51)
      end-if

      add &C.TxGrs_QTD to #PgTotTxGrsSWT
      add &C.TxGrs_QTD to #StTotTxGrsSWT
      add &C.Tax_QTD   to #PgTotTaxSWT
      add &C.Tax_QTD   to #StTotTaxSWT
    break

    when = 'U'                                        !Unemployment - ER
      do Format-Number(&C.TxGrs_QTD, $out, '99,999,999.99mi')
      print $out             (#DetLinePos,66)
      do Format-Number(&C.NLGrs_QTD, $out, '99,999,999.99mi')
      print $out             (#DetLinePos,81)
      do Format-Number(&C.Tax_QTD, $out, '99,999,999.99mi')
      print $out             (#DetLinePos,96)
      print 'ER'             (#DetLinePos,+0)

      add &C.TxGrs_QTD to #PgTotTxGrsSUT
      add &C.TxGrs_QTD to #StTotTxGrsSUT
      add &C.NLGrs_QTD to #PgTotNlGrsSUT
      add &C.NLGrs_QTD to #StTotNlGrsSUT
      add &C.Tax_QTD   to #PgTotTaxSUT
      add &C.Tax_QTD   to #StTotTaxSUT
      add 1            to #DetLinePos
    break

    when = 'L'                                        !New Jersey SWAF
      do Format-Number(&C.TxGrs_QTD, $out, '99,999,999.99mi')
      print $out             (#DetLinePos,66)
      do Format-Number(&C.NLGrs_QTD, $out, '99,999,999.99mi')
      print $out             (#DetLinePos,81)
      do Format-Number(&C.Tax_QTD, $out, '99,999,999.99mi')
      print $out             (#DetLinePos,96)
      print 'SW'             (#DetLinePos,+0)

      add &C.TxGrs_QTD to #PgTotTxGrsSWAF
      add &C.TxGrs_QTD to #StTotTxGrsSWAF
      add &C.NLGrs_QTD to #PgTotNlGrsSWAF
      add &C.NLGrs_QTD to #StTotNlGrsSWAF
      add &C.Tax_QTD   to #PgTotTaxSWAF
      add &C.Tax_QTD   to #StTotTaxSWAF
      add 1            to #DetLinePos
    break

    when = 'M'                                        !New Jersey WFDP
      do Format-Number(&C.TxGrs_QTD, $out, '99,999,999.99mi')
      print $out             (#DetLinePos,66)
      do Format-Number(&C.NLGrs_QTD, $out, '99,999,999.99mi')
      print $out             (#DetLinePos,81)
      do Format-Number(&C.Tax_QTD, $out, '99,999,999.99mi')
      print $out             (#DetLinePos,96)
      print 'WF'             (#DetLinePos,+0)

      add &C.TxGrs_QTD to #PgTotTxGrsWFDP
      add &C.TxGrs_QTD to #StTotTxGrsWFDP
      add &C.NLGrs_QTD to #PgTotNlGrsWFDP
      add &C.NLGrs_QTD to #StTotNlGrsWFDP
      add &C.Tax_QTD   to #PgTotTaxWFDP
      add &C.Tax_QTD   to #StTotTaxWFDP
      add 1            to #DetLinePos
    break

    when = 'N'                                        !New Jersey HCSF
      do Format-Number(&C.TxGrs_QTD, $out, '99,999,999.99mi')
      print $out             (#DetLinePos,66)
      do Format-Number(&C.NLGrs_QTD, $out, '99,999,999.99mi')
      print $out             (#DetLinePos,81)
      do Format-Number(&C.Tax_QTD, $out, '99,999,999.99mi')
      print $out             (#DetLinePos,96)
      print 'HC'             (#DetLinePos,+0)

      add &C.TxGrs_QTD to #PgTotTxGrsHCSF
      add &C.TxGrs_QTD to #StTotTxGrsHCSF
      add &C.NLGrs_QTD to #PgTotNlGrsHCSF
      add &C.NLGrs_QTD to #StTotNlGrsHCSF
      add &C.Tax_QTD   to #PgTotTaxHCSF
      add &C.Tax_QTD   to #StTotTaxHCSF
      add 1            to #DetLinePos
    break

    when = 'V'                                        !Unemployment - EE
      do Format-Number(&C.TxGrs_QTD, $out, '99,999,999.99mi')
      print $out             (#DetLinePos,66)
      do Format-Number(&C.NLGrs_QTD, $out, '99,999,999.99mi')
      print $out             (#DetLinePos,81)
      do Format-Number(&C.Tax_QTD, $out, '99,999,999.99mi')
      print $out             (#DetLinePos,96)
      print 'EE'             (#DetLinePos,+0)

      add &C.TxGrs_QTD to #PgTotTxGrsSUTEE
      add &C.TxGrs_QTD to #StTotTxGrsSUTEE
      add &C.NLGrs_QTD to #PgTotNlGrsSUTEE
      add &C.NLGrs_QTD to #StTotNlGrsSUTEE
      add &C.Tax_QTD   to #PgTotTaxSUTEE
      add &C.Tax_QTD   to #StTotTaxSUTEE
      add 1            to #DetLinePos
    break

    when = 'S'                                     !Special Unemployment
      do Format-Number(&C.TxGrs_QTD, $out, '99,999,999.99mi')
      print $out             (#DetLinePos,66)
      do Format-Number(&C.NLGrs_QTD, $out, '99,999,999.99mi')
      print $out             (#DetLinePos,81)
      do Format-Number(&C.Tax_QTD, $out, '99,999,999.99mi')
      print $out             (#DetLinePos,96)
      print 'SP'             (#DetLinePos,+0)

      add &C.TxGrs_QTD to #PgTotTxGrsSUTSp
      add &C.TxGrs_QTD to #StTotTxGrsSUTSp
      add &C.NLGrs_QTD to #PgTotNlGrsSUTSp
      add &C.NLGrs_QTD to #StTotNlGrsSUTSp
      add &C.Tax_QTD   to #PgTotTaxSUTSp
      add &C.Tax_QTD   to #StTotTaxSUTSp
      add 1            to #DetLinePos
    break

    when = 'X'                                         !VPDI Employer
      do Format-Number(&C.TxGrs_QTD, $out, '99,999,999.99mi')
      print $out             (#DetLinePos2,145)
      do Format-Number(&C.Tax_QTD, $out, '99,999,999.99mi')
      print $out             (#DetLinePos2,160)
      print 'VPDI ER'        (#DetLinePos2,+0)

      add &C.TxGrs_QTD to #PgTotTxGrsVPDI
      add &C.TxGrs_QTD to #StTotTxGrsVPDI
      add &C.Tax_QTD   to #PgTotTaxVPDI
      add &C.Tax_QTD   to #StTotTaxVPDI
      add 1            to #DetLinePos2
    break

    when = 'W'                                         !VPDI Employee
      do Format-Number(&C.TxGrs_QTD, $out, '99,999,999.99mi')
      print $out             (#DetLinePos2,145)
      do Format-Number(&C.Tax_QTD, $out, '99,999,999.99mi')
      print $out             (#DetLinePos2,160)
      print 'VPDI EE'        (#DetLinePos2,+0)

      add &C.TxGrs_QTD to #PgTotTxGrsVPDIEE
      add &C.TxGrs_QTD to #StTotTxGrsVPDIEE
      add &C.Tax_QTD   to #PgTotTaxVPDIEE
      add &C.Tax_QTD   to #StTotTaxVPDIEE
      add 1            to #DetLinePos2
    break

    when = 'I'                                         !FLI Employee
      do Format-Number(&C.TxGrs_QTD, $out, '99,999,999.99mi')
      print $out             (#DetLinePos2,145)
      do Format-Number(&C.Tax_QTD, $out, '99,999,999.99mi')
      print $out             (#DetLinePos2,160)
      print 'FLI EE'         (#DetLinePos2,+0)

      add &C.TxGrs_QTD to #PgTotTxGrsFLI
      add &C.TxGrs_QTD to #StTotTxGrsFLI
      add &C.Tax_QTD   to #PgTotTaxFLI
      add &C.Tax_QTD   to #StTotTaxFLI
      add 1            to #DetLinePos2
    break

    when = 'O'                                         !VFLI Employee
      do Format-Number(&C.TxGrs_QTD, $out, '99,999,999.99mi')
      print $out             (#DetLinePos2,145)
      do Format-Number(&C.Tax_QTD, $out, '99,999,999.99mi')
      print $out             (#DetLinePos2,160)
      print 'VFLI EE'        (#DetLinePos2,+0)

      add &C.TxGrs_QTD to #PgTotTxGrsVFLIEE
      add &C.TxGrs_QTD to #StTotTxGrsVFLIEE
      add &C.Tax_QTD   to #PgTotTaxVFLIEE
      add &C.Tax_QTD   to #StTotTaxVFLIEE
      add 1            to #DetLinePos2
    break

    when = 'Y'                                         !VFLI Employer
      do Format-Number(&C.TxGrs_QTD, $out, '99,999,999.99mi')
      print $out             (#DetLinePos2,145)
      do Format-Number(&C.Tax_QTD, $out, '99,999,999.99mi')
      print $out             (#DetLinePos2,160)
      print 'VFLI ER'        (#DetLinePos2,+0)

      add &C.TxGrs_QTD to #PgTotTxGrsVFLIER
      add &C.TxGrs_QTD to #StTotTxGrsVFLIER
      add &C.Tax_QTD   to #PgTotTaxVFLIER
      add &C.Tax_QTD   to #StTotTaxVFLIER
      add 1            to #DetLinePos2
    break

    when = 'C'                                         !EIC IN
      do Format-Number(&C.TxGrs_QTD, $out, '99,999,999.99mi')
      print $out             (#DetLinePos2,145)
      do Format-Number(&C.Tax_QTD, $out, '99,999,999.99mi')
      print $out             (#DetLinePos2,160)
      print 'EIC'            (#DetLinePos2,+0)

      add &C.TxGrs_QTD to #PgTotTxGrsEIC
      add &C.TxGrs_QTD to #StTotTxGrsEIC
      add &C.Tax_QTD   to #PgTotTaxEIC
      add &C.Tax_QTD   to #StTotTaxEIC
      add 1            to #DetLinePos2

  end-evaluate
end-procedure


begin-procedure After-State

  if $Print-Neg-Balances = 'Y'
     let $Neg-Balances-Found = 'Y'
     do Print-Neg-Report-EmpName
     do Print-Negative-Report
  end-if

  if $Neg-Balances-Found = 'Y'
     Use-Report Negative-Report
     move 'Y' to $Print_Neg_State_Totals
     new-page
     move 'N' to $Print_Neg_State_Totals
     move 'N' to $Neg-Balances-Found
     move ''  to $priorState2
     Use-Report Employee-Detail
  end-if

  move 'Y' to $Print_State_Totals
  new-page
  move 'N' to $Print_State_Totals
  move '' to $priorName
  move '' to $priorSSN
  move '' to $priorState

end-procedure


begin-procedure Print-Neg-Report-EmpName

  Use-Report Negative-Report
  next-listing need=5

  move $priorSSN to $S123 xxx       !isolate first 3 digits
  if $S123 = &Temp_SSN_Mask or RTRIM($priorSSN, ' ') = ''
     print 'Applied For' (1,2)
  else
     print $priorSSN     (1,2)  edit xxxbxxbxxxx
  end-if

  print $priorName       (1,15,19)

  let #NegDetLinePos  = 1
  let #NegDetLinePos2 = 1
  let $NegTaxClassA1042 = 'N'

  let $Neg-Report-Printed = 'Y'
  let #I = 0

end-procedure


Begin-Procedure Print-Negative-Report

  while #I < 24

    get $TaxClass   #NegTxGrs   #NegNLGrs   #NegTax
        from TaxArray(#I)

    if $TaxClass <> ''
       evaluate $TaxClass

       when = 'D'                                         !Disability
         do Format-Number(#NegTxGrs, $out, '99,999,999.99mi')
         print $out             (1,113)
         do Format-Number(#NegTax, $out, '99,999,999.99mi')
         print $out             (1,128)

         add #NegTxGrs to #NegPgTotTxGrsSDI
         add #NegTxGrs to #NegStTotTxGrsSDI
         add #NegTax   to #NegPgTotTaxSDI
         add #NegTax   to #NegStTotTaxSDI
       break

       when = 'E'                                         !Disability Employer
         do Format-Number(#NegTxGrs, $out, '99,999,999.99mi')
         print $out             (2,113)
         do Format-Number(#NegTax, $out, '99,999,999.99mi')
         print $out             (2,128)
         print 'ER'             (2,+0)

         add #NegTxGrs to #NegPgTotTxGrsSDIE
         add #NegTxGrs to #NegStTotTxGrsSDIE
         add #NegTax   to #NegPgTotTaxSDIE
         add #NegTax   to #NegStTotTaxSDIE
       break

       when = 'A'                                       !Withholding       !HP99999
         do Format-Number(#NegTxGrs, $out, '99,999,999.99mi')
         print $out             (1,36)
         do Format-Number(#NegTax, $out, '99,999,999.99mi')
         print $out             (1,51)

         add #NegTxGrs to #NegPgTotTxGrsSWT
         add #NegTxGrs to #NegStTotTxGrsSWT
         add #NegTax   to #NegPgTotTaxSWT
         add #NegTax   to #NegStTotTaxSWT

         let $NegTaxClassA1042 = 'Y'
       break

       when = 'H'                                       !Withholding
         do Format-Number(#NegTxGrs, $out, '99,999,999.99mi')
         do Format-Number(#NegTax, $out1, '99,999,999.99mi')

         if $NegTaxClassA1042 = 'Y'
            print $out    (2,36)
            print $out1   (2,51)
         else
            print $out    (1,36)
            print $out1   (1,51)
         end-if

         add #NegTxGrs to #NegPgTotTxGrsSWT
         add #NegTxGrs to #NegStTotTxGrsSWT
         add #NegTax   to #NegPgTotTaxSWT
         add #NegTax   to #NegStTotTaxSWT
       break

       when = 'U'                                        !Unemployment - ER
         do Format-Number(#NegTxGrs, $out, '99,999,999.99mi')
         print $out             (#NegDetLinePos,66)
         do Format-Number(#NegNLGrs, $out, '99,999,999.99mi')
         print $out             (#NegDetLinePos,81)
         do Format-Number(#NegTax, $out, '99,999,999.99mi')
         print $out             (#NegDetLinePos,96)
         print 'ER'             (#NegDetLinePos,+0)

         add #NegTxGrs to #NegPgTotTxGrsSUT
         add #NegTxGrs to #NegStTotTxGrsSUT
         add #NegNLGrs to #NegPgTotNlGrsSUT
         add #NegNLGrs to #NegStTotNlGrsSUT
         add #NegTax   to #NegPgTotTaxSUT
         add #NegTax   to #NegStTotTaxSUT
         add 1         to #NegDetLinePos
       break

       when = 'L'                                        !New Jersey SWAF
         do Format-Number(#NegTxGrs, $out, '99,999,999.99mi')
         print $out             (#NegDetLinePos,66)
         do Format-Number(#NegNLGrs, $out, '99,999,999.99mi')
         print $out             (#NegDetLinePos,81)
         do Format-Number(#NegTax, $out, '99,999,999.99mi')
         print $out             (#NegDetLinePos,96)
         print 'SW'             (#NegDetLinePos,+0)

         add #NegTxGrs to #NegPgTotTxGrsSWAF
         add #NegTxGrs to #NegStTotTxGrsSWAF
         add #NegNLGrs to #NegPgTotNlGrsSWAF
         add #NegNLGrs to #NegStTotNlGrsSWAF
         add #NegTax   to #NegPgTotTaxSWAF
         add #NegTax   to #NegStTotTaxSWAF
         add 1         to #NegDetLinePos
       break

       when = 'M'                                        !New Jersey WFDP
         do Format-Number(#NegTxGrs, $out, '99,999,999.99mi')
         print $out             (#NegDetLinePos,66)
         do Format-Number(#NegNLGrs, $out, '99,999,999.99mi')
         print $out             (#NegDetLinePos,81)
         do Format-Number(#NegTax, $out, '99,999,999.99mi')
         print $out             (#NegDetLinePos,96)
         print 'WF'             (#NegDetLinePos,+0)

         add #NegTxGrs to #NegPgTotTxGrsWFDP
         add #NegTxGrs to #NegStTotTxGrsWFDP
         add #NegNLGrs to #NegPgTotNlGrsWFDP
         add #NegNLGrs to #NegStTotNlGrsWFDP
         add #NegTax   to #NegPgTotTaxWFDP
         add #NegTax   to #NegStTotTaxWFDP
         add 1         to #NegDetLinePos
       break

       when = 'N'                                        !New Jersey HCSF
         do Format-Number(#NegTxGrs, $out, '99,999,999.99mi')
         print $out             (#NegDetLinePos,66)
         do Format-Number(#NegNLGrs, $out, '99,999,999.99mi')
         print $out             (#NegDetLinePos,81)
         do Format-Number(#NegTax, $out, '99,999,999.99mi')
         print $out             (#NegDetLinePos,96)
         print 'HC'             (#NegDetLinePos,+0)

         add #NegTxGrs to #NegPgTotTxGrsHCSF
         add #NegTxGrs to #NegStTotTxGrsHCSF
         add #NegNLGrs to #NegPgTotNlGrsHCSF
         add #NegNLGrs to #NegStTotNlGrsHCSF
         add #NegTax   to #NegPgTotTaxHCSF
         add #NegTax   to #NegStTotTaxHCSF
         add 1         to #NegDetLinePos
       break

       when = 'V'                                        !Unemployment - EE
         do Format-Number(#NegTxGrs, $out, '99,999,999.99mi')
         print $out             (#NegDetLinePos,66)
         do Format-Number(#NegNLGrs, $out, '99,999,999.99mi')
         print $out             (#NegDetLinePos,81)
         do Format-Number(#NegTax, $out, '99,999,999.99mi')
         print $out             (#NegDetLinePos,96)
         print 'EE'             (#NegDetLinePos,+0)

         add #NegTxGrs to #NegPgTotTxGrsSUTEE
         add #NegTxGrs to #NegStTotTxGrsSUTEE
         add #NegNLGrs to #NegPgTotNlGrsSUTEE
         add #NegNLGrs to #NegStTotNlGrsSUTEE
         add #NegTax   to #NegPgTotTaxSUTEE
         add #NegTax   to #NegStTotTaxSUTEE
         add 1         to #NegDetLinePos
       break

       when = 'S'                                     !Special Unemployment
         do Format-Number(#NegTxGrs, $out, '99,999,999.99mi')
         print $out             (#NegDetLinePos,66)
         do Format-Number(#NegNLGrs, $out, '99,999,999.99mi')
         print $out             (#NegDetLinePos,81)
         do Format-Number(#NegTax, $out, '99,999,999.99mi')
         print $out             (#NegDetLinePos,96)
         print 'SP'             (#NegDetLinePos,+0)

         add #NegTxGrs to #NegPgTotTxGrsSUTSp
         add #NegTxGrs to #NegStTotTxGrsSUTSp
         add #NegNLGrs to #NegPgTotNlGrsSUTSp
         add #NegNLGrs to #NegStTotNlGrsSUTSp
         add #NegTax   to #NegPgTotTaxSUTSp
         add #NegTax   to #NegStTotTaxSUTSp
         add 1         to #NegDetLinePos
       break

       when = 'X'                                         !VPDI Employer
         do Format-Number(#NegTxGrs, $out, '99,999,999.99mi')
         print $out             (#NegDetLinePos2,145)
         do Format-Number(#NegTax, $out, '99,999,999.99mi')
         print $out             (#NegDetLinePos2,160)
         print 'VPDI ER'        (#NegDetLinePos2,+0)

         add #NegTxGrs to #NegPgTotTxGrsVPDI
         add #NegTxGrs to #NegStTotTxGrsVPDI
         add #NegTax   to #NegPgTotTaxVPDI
         add #NegTax   to #NegStTotTaxVPDI
         add 1         to #NegDetLinePos2
       break

       when = 'W'                                         !VPDI Employee
         do Format-Number(#NegTxGrs, $out, '99,999,999.99mi')
         print $out             (#NegDetLinePos2,145)
         do Format-Number(#NegTax, $out, '99,999,999.99mi')
         print $out             (#NegDetLinePos2,160)
         print 'VPDI EE'        (#NegDetLinePos2,+0)

         add #NegTxGrs to #NegPgTotTxGrsVPDIEE
         add #NegTxGrs to #NegStTotTxGrsVPDIEE
         add #NegTax   to #NegPgTotTaxVPDIEE
         add #NegTax   to #NegStTotTaxVPDIEE
         add 1         to #NegDetLinePos2
       break

       when = 'I'                                         !FLI Employee
         do Format-Number(#NegTxGrs, $out, '99,999,999.99mi')
         print $out             (#NegDetLinePos2,145)
         do Format-Number(#NegTax, $out, '99,999,999.99mi')
         print $out             (#NegDetLinePos2,160)
         print 'FLI EE'         (#NegDetLinePos2,+0)

         add #NegTxGrs to #NegPgTotTxGrsFLI
         add #NegTxGrs to #NegStTotTxGrsFLI
         add #NegTax   to #NegPgTotTaxFLI
         add #NegTax   to #NegStTotTaxFLI
         add 1         to #NegDetLinePos2
       break

       when = 'O'                                         !VFLI Employee
         do Format-Number(#NegTxGrs, $out, '99,999,999.99mi')
         print $out             (#NegDetLinePos2,145)
         do Format-Number(#NegTax, $out, '99,999,999.99mi')
         print $out             (#NegDetLinePos2,160)
         print 'VFLI EE'        (#NegDetLinePos2,+0)

         add #NegTxGrs to #NegPgTotTxGrsVFLIEE
         add #NegTxGrs to #NegStTotTxGrsVFLIEE
         add #NegTax   to #NegPgTotTaxVFLIEE
         add #NegTax   to #NegStTotTaxVFLIEE
         add 1         to #NegDetLinePos2
       break

       when = 'Y'                                         !VFLI Employer
         do Format-Number(#NegTxGrs, $out, '99,999,999.99mi')
         print $out             (#NegDetLinePos2,145)
         do Format-Number(#NegTax, $out, '99,999,999.99mi')
         print $out             (#NegDetLinePos2,160)
         print 'VFLI ER'        (#NegDetLinePos2,+0)

         add #NegTxGrs to #NegPgTotTxGrsVFLIER
         add #NegTxGrs to #NegStTotTxGrsVFLIER
         add #NegTax   to #NegPgTotTaxVFLIER
         add #NegTax   to #NegStTotTaxVFLIER
         add 1         to #NegDetLinePos2
       break

       when = 'C'                                         !EIC IN
         do Format-Number(#NegTxGrs, $out, '99,999,999.99mi')
         print $out             (#NegDetLinePos2,145)
         do Format-Number(#NegTax, $out, '99,999,999.99mi')
         print $out             (#NegDetLinePos2,160)
         print 'EIC'            (#NegDetLinePos2,+0)

         add #NegTxGrs to #NegPgTotTxGrsEIC
         add #NegTxGrs to #NegStTotTxGrsEIC
         add #NegTax   to #NegPgTotTaxEIC
         add #NegTax   to #NegStTotTaxEIC
         add 1         to #NegDetLinePos2

       end-evaluate
    end-if

    let #I = #I + 1

  end-while

  move 'N' to $Print-Neg-Balances

  Use-Report Employee-Detail

end-procedure


#Include 'taxrnctl.sqc'  !Get-Tax-Reporting-Run-Controls procedure
#Include 'getcodta.sqc'  !Get-Company-Data procedure
#Include 'getstdta.sqc'  !Get-State-Tax-Data procedure
#Include 'curdttim.sqc'  !Get-Current-DateTime procedure
#Include 'datetime.sqc'  !Routines for date and time formatting
#Include 'number.sqc'    !Routines to format numbers
#Include 'stdapi.sqc'    !Update Process API
#Include 'getbalid.sqc'  !Get-Calendar-Year-Id
