!***********************************************************************
!  TAX920AU:  Audit W-2c Batch                                         *

!***********************************************************************
!***********************************************************************
!                                                                      *
!               Confidentiality Information:                           *
!                                                                      *
! This module contains confidential and proprietary information        *
! of Oracle; it is not to be copied, reproduced, or transmitted        *
! in any form, by any means, in whole or in part, nor is it to         *
! be used for any purpose other than that for which it is              *
! expressly provided under the applicable license agreement.           *
!                                                                      *
! Copyright (C) 2006 Oracle. All Rights Reserved.                      *
!                                                                      *
!***********************************************************************
!                                                                      *
!          $Date:  2006/11/14:14:55:07                                 !
!       $Release:  HR9                                                 !
!      $Revision:  103                                                 !
!                                                                      *
!***********************************************************************

#include 'setenv.sqc'   !Set environment
#include 'setup02.sqc'


begin-setup
!include 'setupdb.sqc'               ! Database specific setup


end-setup


begin-report

  do Init-Report
  do Stdapi-Term
end-report

begin-procedure Init-Report
  display ''
  display 'Printing W-2c Audit'

  date-time () hh:mi:ss &t1
  display &t1

  move 'TAX920AU' to $ReportID
  move 'W-2C Audit Report' to $ReportTitle
  do Init-DateTime
  do Init-Number
  do Stdapi-Init
  do Initialization
  do Read-Employee-Data

  if $EmployeeFound = 'N'
    display ' '
    display '****** No Employee Records Selected ******'
    display ' '
    new-page
    print '********************************'  (+3,1)
    print '  No Employee Records Selected  '  (+1,1)
    print '********************************'  (+1,1)
  else
    display ''
    display 'Upon successful conclusion of this program, '
    display 'one audit file will have been created that contains '
    display 'detail information on each employee and summary information '
    display 'for the W-3c totals report. '
    display ''
    display ''
  end-if

  date-time () hh:mi:ss &t2
  display &t2
end-procedure

begin-heading 8
  #Include 'stdhdg01.sqc'

  print 'W2 Rpt Company '              (3,1)
  print $A.W2_Reporting_Co             (0,+2)
  print $A.Descr                       (0,+2)
  let $TaxYear = 'Tax Year ' || $CalYear
  print $TaxYear                       (3,)    center
  print 'Audit Report ' (5,1)
  print 'Batch Number:' (,+5)
  print #W2c_Batch_Nbr  (,+2) edit B99999

  print 'Emplid' (+2,1)
  print 'Form W-2 Box' (,36)
  print 'State' (,51)
  print 'Locality' (,62)
  print 'Previous ' (,87)
  print 'Corrected ' (,119)
  print 'Increase/decrease ' (,146)
  print 'Name' (+1,1)
  print 'SSN' (+1,1)

end-heading

begin-procedure Initialization
  do Get-Current-DateTime
  move '1' to $MMLZero
  move '1' to $Year4
  do Format-DateTime($AsOfToday, $910Date, {DEFYMD},'','')

  move $910Date to $AsOfYear xxxx   !extract the current year
  move $AsOfYear  to #AsOfYear
  move #AsOfYear  to #saveAsOfYear
  subtract 1    from #AsOfYear

  do Init-Values
  do Get-W2C-Run-Controls

  let $AsOfDate = $CalYear || '1231'
  do Format-DateTime($AsOfDate, $AsOfDate, {DEFCMP}, '', 'native')


begin-SELECT
TEMP_SSN_MASK
FROM PS_INSTALLATION
end-SELECT

  create-array name=StateLocals size=50
    field=Box:char
    field=State:char
    field=Locality:char
    field=Amount:number
    field=PrvAmount:number

  create-array name=StateSWT size=50
    field=State:char
    field=SWT:char

  create-array name=LocalPrintName size=80
    field=State:char
    field=Locality:char
    field=LocalName:char

end-procedure


begin-procedure Read-Employee-Data
  move 'N' to $EmployeeFound

begin-SELECT
E.COMPANY          () ON-BREAK LEVEL=1 PRINT=NEVER BEFORE=BEFORE-COMPANY
                                                   AFTER=AFTER-COMPANY
E.W2C_ADD_EMPLID   () ON-BREAK LEVEL=2 PRINT=NEVER BEFORE=BEFORE-EMPLID
E.W2C_SSN
E.W2C_NAME
E.W2C_STATUS
E.ADDRESS1
E.ADDRESS2
E.CITY
E.STATE
E.POSTAL
E.COUNTRY
E.STATUTORY_EE
E.PENSION_PLAN
E.DEFERRED_COMP
E.DECEASED
E.LEGAL_REP
E.PRV_SSN
E.PRV_W2_NAME
E.PRV_ADDRESS1
E.PRV_ADDRESS2
E.PRV_CITY
E.PRV_STATE
E.PRV_POSTAL
E.PRV_COUNTRY
E.PRV_STATUTORY_EE
E.PRV_PENSION_PLAN
E.PRV_DEFERRED_COMP
E.PRV_DECEASED
E.PRV_LEGAL_REP
E.W2C_BATCH_NBR
E.CALENDAR_YEAR
E.DESCRLONG

  move 'Y' to $EmployeeFound
  if &E.W2C_STATUS  <> 'V'
    do Load-Amounts
    do Print-W2C
    add 1 to #W3c_Count
  else
    print  $E.EmplID  (+3,1)
    print  $E.W2_Name (+1,1)
    print '***** Voided W-2c ***** ' (,+9)
    print  $E.SSN (+1,1)
  end-if

FROM  PS_W2C_DATA E
WHERE E.W2C_BATCH_NBR    = #W2c_Batch_Nbr
ORDER BY E.COMPANY, E.W2C_SSN
end-SELECT
end-procedure

begin-procedure Before-Company

begin-SELECT
A.W2_REPORTING_CO
A.DESCR
A.FEDERAL_EIN
A.ADDRESS1
A.ADDRESS2
A.CITY
A.STATE
A.POSTAL
A.COUNTRY
A.TAXFORM_ID

  move &A.Federal_EIN     to $Federal_EIN 099999999
  move $Federal_EIN       to $A.Federal_EIN xx-xxxxxxx
  move &A.Descr           to $A.Descr
  move &A.Address1        to $A.Address1
  move &A.Address2        to $A.Address2
  move &A.Country         to $A.Country
  let  $A.City            =  RTRIM(&A.City,' ')
  let  $A.State           =  RTRIM(&A.State,' ')
  move &A.POSTAL          to $A.Postal
  move &A.W2_Reporting_Co to $A.W2_Reporting_Co


  UPPERCASE $A.Descr
  UPPERCASE $A.Address1
  UPPERCASE $A.Address2
  UPPERCASE $A.Country
  UPPERCASE $A.City

  move $A.Federal_EIN     to $W3c_EIN
  move $A.Descr           to $W3c_Descr
  move $A.Address1        to $W3c_Address1
  move $A.Address2        to $W3c_Address2
  if $A.Country = 'USA'
    move $A.Postal        to $ZipExtsn ~~~~~~xxxx
    if instr($A.Postal,'-',6) = 0
    and $ZipExtsn <> '    '
      let $A.Postal = substr($A.Postal,1,5) || '-' || substr($A.Postal,6,4)
    end-if
    let $W3c_Address3 = $A.City || ', ' || $A.State || ' ' || $A.Postal
  else
    let $W3c_Address3 = $A.City || ', ' || $A.State || ' ' ||
            $A.Country || ' ' || $A.Postal
  end-if

  move 0 to #W3c_Count

FROM  PS_W2_COMPANY A
WHERE A.COMPANY  = &E.COMPANY
  AND A.W2_REPORTING_CO <> ' '
  AND A.CALENDAR_YEAR = (SELECT MAX(CALENDAR_YEAR)
                         FROM PS_W2_COMPANY
                         WHERE A.COMPANY = COMPANY
                           AND A.TAXFORM_ID = TAXFORM_ID
                           AND CALENDAR_YEAR <= &E.CALENDAR_YEAR)
end-SELECT
end-procedure

begin-procedure After-Company

  do Print-W3c-Totals
  do Init-W3c-Totals
end-procedure

begin-procedure Before-EmplID
  display 'processing ' noline
  display &E.W2C_ADD_EMPLID

  move &E.W2C_ADD_EMPLID   to $E.EmplID

  move &E.W2C_SSN to $S123 xxx
  if $S123 = &Temp_SSN_Mask or RTRIM(&E.W2C_SSN, ' ') = ''
    move 'Unavailable' to $E.SSN
  else
    move &E.W2C_SSN to $E.SSN xxx-xx-xxxx
  end-if

  move &E.PRV_SSN to $S123 xxx
  if $S123 = &Temp_SSN_Mask or RTRIM(&E.PRV_SSN, ' ') = ''
    move 'Unavailable' to $E.Prv_SSN
  else
    move &E.PRV_SSN to $E.Prv_SSN xxx-xx-xxxx
  end-if

  move &E.W2C_Name to $E.W2_Name

  move &E.Pension_Plan    to $E.Pension_Plan
  move &E.Deferred_Comp   to $E.Deferred_Comp
  move &E.Statutory_Ee    to $E.Statutory_Ee
  move &E.Deceased        to $E.Deceased
  move &E.Legal_Rep       to $E.Legal_Rep

  move &E.Address1        to $E.Address1
  move &E.Address2        to $E.Address2
  move &E.Country         to $E.Country
  let  $E.City            =  RTRIM(&E.City,' ')
  let  $E.State           =  RTRIM(&E.State,' ')
  move &E.Postal          to $E.Postal

  move &E.Prv_W2_Name         to $E.Prv_W2_Name
  move &E.Prv_Address1        to $E.Prv_Address1
  move &E.Prv_Address2        to $E.Prv_Address2
  move &E.Prv_Country         to $E.Prv_Country
  let  $E.Prv_City            =  RTRIM(&E.Prv_City,' ')
  let  $E.Prv_State           =  RTRIM(&E.Prv_State,' ')
  move &E.Prv_Postal          to $E.Prv_Postal

  move &E.Prv_Pension_Plan    to $E.Prv_Pension_Plan
  move &E.Prv_Deferred_Comp   to $E.Prv_Deferred_Comp
  move &E.Prv_Statutory_Ee    to $E.Prv_Statutory_Ee
  move &E.Prv_Deceased        to $E.Prv_Deceased
  move &E.Prv_Legal_Rep       to $E.Prv_Legal_Rep

  uppercase $E.W2_Name
  uppercase $E.Address1
  uppercase $E.Address2
  uppercase $E.Country
  uppercase $E.City

  uppercase $E.Prv_W2_Name
  uppercase $E.Prv_Address1
  uppercase $E.Prv_Address2
  uppercase $E.Prv_Country
  uppercase $E.Prv_City

end-procedure


begin-procedure Print-W2C

  move 0 to #NextStateLoc
  move 0 to #HoldNextStateLoc
  move 0 to #StateSWTCount
  move 1 to #j

  do Print-EE-Data
  do Print-Amounts
  if #StateLocalCount > 0
    do Print-State-Local-Amounts
  end-if

  print &E.DESCRLONG (+2,40) WRAP 132 12

  do Init-Values

end-procedure


begin-procedure Init-Values
  move 0 to #01
  move 0 to #02
  move 0 to #03
  move 0 to #04
  move 0 to #05
  move 0 to #06
  move 0 to #07
  move 0 to #08
  move 0 to #09
  move 0 to #10
  move 0  to #11AB
  move 0 to #BlankBoxCount
  move 'N' to $Amt11A
  move 'N' to $Amt11B
  move 0 to #12
  move 0 to #13A
  move 0 to #13B
  move 0 to #13C
  move 0 to #13D
  move 0 to #13E
  move 0 to #13F
  move 0 to #13G
  move 0 to #13H
  move 0 to #13J
  move 0 to #13K
  move 0 to #13L
  move 0 to #13M
  move 0 to #13N
  move 0 to #13P
  move 0 to #13Q
  move 0 to #13R
  move 0 to #13S
  move 0 to #13T
  move 0 to #14A
  move 0 to #14B
  move 0 to #14C
  move 0 to #14D
  move 0 to #14E
  move 0 to #14F
  move 0 to #14G
  move 0 to #14H
  move 0 to #14I
  move 0 to #14J
  move 0 to #14K
  move 0 to #14L
  move 0 to #14M
  move 0 to #14N
  move 0 to #14O
  move 0 to #14P
  move 0 to #14Q
  move 0 to #14R
  move 0 to #14S
  move 0 to #14T
  move 0 to #14U
  move 0 to #14V
  move 0 to #14W
  move 0 to #14X
  move 0 to #14Y
  move 0 to #14Z
  move 0 to #14YN
  move 0 to #14YT
  move 0 to #14ZN

  move 0 to #Prv_01
  move 0 to #Prv_02
  move 0 to #Prv_03
  move 0 to #Prv_04
  move 0 to #Prv_05
  move 0 to #Prv_06
  move 0 to #Prv_07
  move 0 to #Prv_08
  move 0 to #Prv_09
  move 0 to #Prv_10
  move 0  to #Prv_11AB
  move 'N' to $Prv_Amt11A
  move 'N' to $Prv_Amt11B
  move 0 to #Prv_12
  move 0 to #Prv_13A
  move 0 to #Prv_13B
  move 0 to #Prv_13C
  move 0 to #Prv_13D
  move 0 to #Prv_13E
  move 0 to #Prv_13F
  move 0 to #Prv_13G
  move 0 to #Prv_13H
  move 0 to #Prv_13J
  move 0 to #Prv_13K
  move 0 to #Prv_13L
  move 0 to #Prv_13M
  move 0 to #Prv_13N
  move 0 to #Prv_13P
  move 0 to #Prv_13Q
  move 0 to #Prv_13R
  move 0 to #Prv_13S
  move 0 to #Prv_13T
  move 0 to #Prv_14A
  move 0 to #Prv_14B
  move 0 to #Prv_14C
  move 0 to #Prv_14D
  move 0 to #Prv_14E
  move 0 to #Prv_14F
  move 0 to #Prv_14G
  move 0 to #Prv_14H
  move 0 to #Prv_14I
  move 0 to #Prv_14J
  move 0 to #Prv_14K
  move 0 to #Prv_14L
  move 0 to #Prv_14M
  move 0 to #Prv_14N
  move 0 to #Prv_14O
  move 0 to #Prv_14P
  move 0 to #Prv_14Q
  move 0 to #Prv_14R
  move 0 to #Prv_14S
  move 0 to #Prv_14T
  move 0 to #Prv_14U
  move 0 to #Prv_14V
  move 0 to #Prv_14W
  move 0 to #Prv_14X
  move 0 to #Prv_14Y
  move 0 to #Prv_14Z
  move 0 to #Prv_14YN
  move 0 to #Prv_14YT
  move 0 to #Prv_14ZN

  clear-array name = StateLocals

end-procedure



begin-procedure Load-Amounts
  move 0 to #StateLocalCount
begin-SELECT
D.STATE
D.LOCALITY
D.BOX
D.CURRENT_AMOUNT
D.PRV_AMOUNT


  move &D.CURRENT_AMOUNT to #Amount
  move &D.PRV_AMOUNT to #Prv_Amount
  if #Amount <> #Prv_Amount

   let $D.Box = &D.Box
   move $D.Box to $Box xx
   let $Pos3 = substr($D.Box, 3,1)

   if $Box = '14'
     and $Pos3 > ' '
     let $D.Box = &D.Box
     let $D.Box = rpad($D.Box,4,' ')
   else
     let $D.Box = RTRIM(&D.Box,' ')
   end-if

   evaluate $D.Box
     when = '01'                                 !Federal wages
       let  #01 = #Amount
       let  #Prv_01 = #Prv_Amount
       add  #Amount to #01_T
       add  #Prv_Amount to #Prv_01_T
       break
     when = '02'                                 !Federal tax
       let  #02 = #Amount
       let  #Prv_02 = #Prv_Amount
       add  #Amount to #02_T
       add  #Prv_Amount to #Prv_02_T
       break
     when = '03'                                 !SS wages
       let  #03 = #Amount
       let  #Prv_03 = #Prv_Amount
       add  #Amount to #03_T
       add  #Prv_Amount to #Prv_03_T
       break
     when = '04'                                 !SS Tax
       let  #04 = #Amount
       let  #Prv_04 = #Prv_Amount
       add  #Amount to #04_T
       add  #Prv_Amount to #Prv_04_T
       break
    when = '05'                                 !Medicare wages
       let  #05 = #Amount
       let  #Prv_05 = #Prv_Amount
       add  #Amount to #05_T
       add  #Prv_Amount to #Prv_05_T
       break
     when = '06'                                 !Medicare tax
       let  #06 = #Amount
       let  #Prv_06 = #Prv_Amount
       add  #Amount to #06_T
       add  #Prv_Amount to #Prv_06_T
       break
     when = '07'                                 !SS tips
       let  #07 = #Amount
       let  #Prv_07 = #Prv_Amount
       add  #Amount to #07_T
       add  #Prv_Amount to #Prv_07_T
       break
     when = '08'                                 !Allocated tips
       let  #08 = #Amount
       let  #Prv_08 = #Prv_Amount
       add  #Amount to #08_T
       add  #Prv_Amount to #Prv_08_T
       break
     when = '09'                                 !EIC
       add 1 to #BlankBoxCount
       let  #09 = #Amount
       let  #Prv_09 = #Prv_Amount
       add  #Amount to #09_T
       add  #Prv_Amount to #Prv_09_T
       break
     when = '10'                                 !Dependent care
       add 1 to #BlankBoxCount
       let  #10 = #Amount
       let  #Prv_10 = #Prv_Amount
       add  #Amount to #10_T
       add  #Prv_Amount to #Prv_10_T
       break
     when = '11A'                                !non-qualified 457
       if #11AB = 0
         add 1 to #BlankBoxCount
       end-if
       add  #Amount to #11AB
       add  #Prv_Amount to #Prv_11AB

       if #Amount > 0
         move 'Y' to $Amt11A
       end-if

       if #Prv_Amount > 0
         move 'Y' to $Prv_Amt11A
       end-if

       break
     when = '11B'                                !non-qualified non-457

       if #11AB = 0
         add 1 to #BlankBoxCount
       end-if
       add  #Amount to #11AB
       add  #Prv_Amount to #Prv_11AB

       if #Amount > 0
         move 'Y' to $Amt11B
       end-if

       if #Prv_Amount > 0
         move 'Y' to $Prv_Amt11B
       end-if

       break
     when = '12'                                 !Benefits incl in Box 1
       add 1 to #BlankBoxCount
       let  #12 = #Amount
       let  #Prv_12 = #Prv_Amount
       add  #Amount to #12_T
       add  #Prv_Amount to #Prv_12_T
       break
     when = '13A'                                !Uncoll SS tax on tips
       add 1 to #BlankBoxCount
       add  #Amount to #13A
       add  #Prv_Amount to #Prv_13A
       add  #Amount to #13A_T
       add  #Prv_Amount to #Prv_13A_T
       break
     when = '13B'                                !Uncoll Medi tax on tips
       add 1 to #BlankBoxCount
       add  #Amount to #13B
       add  #Prv_Amount to #Prv_13B
       add  #Amount to #13B_T
       add  #Prv_Amount to #Prv_13B_T
       break
     when = '13C'                                !GTL
       add 1 to #BlankBoxCount
       add  #Amount to #13C
       add  #Prv_Amount to #Prv_13C
       add  #Amount to #13C_T
       add  #Prv_Amount to #Prv_13C_T
       break
     when = '13D'                                !401(k)
       add 1 to #BlankBoxCount
       add  #Amount to #13D
       add  #Prv_Amount to #Prv_13D
       add  #Amount to #13D_T
       add  #Prv_Amount to #Prv_13D_T
       break
     when = '13E'                                !403(b)
       add 1 to #BlankBoxCount
       add  #Amount to #13E
       add  #Prv_Amount to #Prv_13E
       add  #Amount to #13E_T
       add  #Prv_Amount to #Prv_13E_T
       break
     when = '13F'                                !408(k)(6)
       add 1 to #BlankBoxCount
       add  #Amount to #13F
       add  #Prv_Amount to #Prv_13F
       add  #Amount to #13F_T
       add  #Prv_Amount to #Prv_13F_T
       break
     when = '13G'                                !457(b)
       add 1 to #BlankBoxCount
       add  #Amount to #13G
       add  #Prv_Amount to #Prv_13G
       add  #Amount to #13G_T
       add  #Prv_Amount to #Prv_13G_T
       break
     when = '13H'                                !501(c)(18)(D)
       add 1 to #BlankBoxCount
       add  #Amount to #13H
       add  #Prv_Amount to #Prv_13H
       add  #Amount to #13H_T
       add  #Prv_Amount to #Prv_13H_T
       break
     when = '13J'                                !Sick pay
       add 1 to #BlankBoxCount
       add  #Amount to #13J
       add  #Prv_Amount to #Prv_13J
       add  #Amount to #13J_T
       add  #Prv_Amount to #Prv_13J_T
       break
     when = '13K'                                !Excise tax
       add 1 to #BlankBoxCount
       add  #Amount to #13K
       add  #Prv_Amount to #Prv_13K
       add  #Amount to #13K_T
       add  #Prv_Amount to #Prv_13K_T
       break
     when = '13L'                                !Business expense
       add 1 to #BlankBoxCount
       add  #Amount to #13L
       add  #Prv_Amount to #Prv_13L
       add  #Amount to #13L_T
       add  #Prv_Amount to #Prv_13L_T
       break
     when = '13M'                                !Uncoll SS tax - GTL
       add 1 to #BlankBoxCount
       add  #Amount to #13M
       add  #Prv_Amount to #Prv_13M
       add  #Amount to #13M_T
       add  #Prv_Amount to #Prv_13M_T
       break
     when = '13N'                                !Uncoll Medi tax - GTL
       add 1 to #BlankBoxCount
       add  #Amount to #13N
       add  #Prv_Amount to #Prv_13N
       add  #Amount to #13N_T
       add  #Prv_Amount to #Prv_13N_T
       break
     when = '13P'                                !Excl Moving Exp
       add 1 to #BlankBoxCount
       add  #Amount to #13P
       add  #Prv_Amount to #Prv_13P
       add  #Amount to #13P_T
       add  #Prv_Amount to #Prv_13P_T
       break
     when = '13Q'                                !Basic Qtrs and Subsistence
       add 1 to #BlankBoxCount
       add  #Amount to #13Q
       add  #Prv_Amount to #Prv_13Q
       add  #Amount to #13Q_T
       add  #Prv_Amount to #Prv_13Q_T
       break
     when = '13R'                                !Medical spending acct
       add 1 to #BlankBoxCount
       add  #Amount to #13R
       add  #Prv_Amount to #Prv_13R
       add  #Amount to #13R_T
       add  #Prv_Amount to #Prv_13R_T
       break
     when = '13S'                                !Section 418(p) simple
       add 1 to #BlankBoxCount                   ! retirement
       add  #Amount to #13S
       add  #Prv_Amount to #Prv_13S
       add  #Amount to #13S_T
       add  #Prv_Amount to #Prv_13S_T
       break
     when = '13T'                                !Adoption expense
       add 1 to #BlankBoxCount
       add  #Amount to #13T
       add  #Prv_Amount to #Prv_13T
       add  #Amount to #13T_T
       add  #Prv_Amount to #Prv_13T_T
       break
     when = '14A '                                !CASDI
       add 1 to #BlankBoxCount
       add  #Amount to #14A
       add  #Prv_Amount to #Prv_14A
       add  #Amount to #14A_T
       add  #Prv_Amount to #Prv_14A_T
       break
     when = '14B '                                !VPDI
       add 1 to #BlankBoxCount
       add  #Amount to #14B
       add  #Prv_Amount to #Prv_14B
       add  #Amount to #14B_T
       add  #Prv_Amount to #Prv_14B_T
       break
     when = '14C '                                !WD
       add 1 to #BlankBoxCount
       add  #Amount to #14C
       add  #Prv_Amount to #Prv_14C
       add  #Amount to #14C_T
       add  #Prv_Amount to #Prv_14C_T
       break
     when = '14D '                                !UI/HC
       add 1 to #BlankBoxCount
       add  #Amount to #14D
       add  #Prv_Amount to #Prv_14D
       add  #Amount to #14D_T
       add  #Prv_Amount to #Prv_14D_T
       break
     when = '14E '                                !NJSDI
       add 1 to #BlankBoxCount
       add  #Amount to #14E
       add  #Prv_Amount to #Prv_14E
       add  #Amount to #14E_T
       add  #Prv_Amount to #Prv_14E_T
       break
     when = '14F '                                !VPDI
       add 1 to #BlankBoxCount
       add  #Amount to #14F
       add  #Prv_Amount to #Prv_14F
       add  #Amount to #14F_T
       add  #Prv_Amount to #Prv_14F_T
       break
     when = '14G '                                !PA EE unemployment
       add 1 to #BlankBoxCount
       add  #Amount to #14G
       add  #Prv_Amount to #Prv_14G
       add  #Amount to #14G_T
       add  #Prv_Amount to #Prv_14G_T
       break
     when = '14H '                                !
       add 1 to #BlankBoxCount
       add  #Amount to #14H
       add  #Prv_Amount to #Prv_14H
       add  #Amount to #14H_T
       add  #Prv_Amount to #Prv_14H_T
       break
     when = '14I '                                !
       add 1 to #BlankBoxCount
       add  #Amount to #14I
       add  #Prv_Amount to #Prv_14I
       add  #Amount to #14I_T
       add  #Prv_Amount to #Prv_14I_T
       break
     when = '14J '                                !
       add 1 to #BlankBoxCount
       add  #Amount to #14J
       add  #Prv_Amount to #Prv_14J
       add  #Amount to #14J_T
       add  #Prv_Amount to #Prv_14J_T
       break
     when = '14K '                                !
       add 1 to #BlankBoxCount
       add  #Amount to #14K
       add  #Prv_Amount to #Prv_14K
       add  #Amount to #14K_T
       add  #Prv_Amount to #Prv_14K_T
       break
     when = '14L '                                !
       add 1 to #BlankBoxCount
       add  #Amount to #14L
       add  #Prv_Amount to #Prv_14L
       add  #Amount to #14L_T
       add  #Prv_Amount to #Prv_14L_T
       break
     when = '14M '                                !
       add 1 to #BlankBoxCount
       add  #Amount to #14M
       add  #Prv_Amount to #Prv_14M
       add  #Amount to #14M_T
       add  #Prv_Amount to #Prv_14M_T
       break
     when = '14N '                                !
       add 1 to #BlankBoxCount
       add  #Amount to #14N
       add  #Prv_Amount to #Prv_14N
       add  #Amount to #14N_T
       add  #Prv_Amount to #Prv_14N_T
       break
     when = '14O '                                !
       add 1 to #BlankBoxCount
       add  #Amount to #14O
       add  #Prv_Amount to #Prv_14O
       add  #Amount to #14O_T
       add  #Prv_Amount to #Prv_14O_T
       break
     when = '14P '                                !
       add 1 to #BlankBoxCount
       add  #Amount to #14P
       add  #Prv_Amount to #Prv_14P
       add  #Amount to #14P_T
       add  #Prv_Amount to #Prv_14P_T
       break
     when = '14Q '                                !
       add 1 to #BlankBoxCount
       add  #Amount to #14Q
       add  #Prv_Amount to #Prv_14Q
       add  #Amount to #14Q_T
       add  #Prv_Amount to #Prv_14Q_T
       break
     when = '14R '                                !
       add 1 to #BlankBoxCount
       add  #Amount to #14R
       add  #Prv_Amount to #Prv_14R
       add  #Amount to #14R_T
       add  #Prv_Amount to #Prv_14R_T
       break
     when = '14S '                                !
       add 1 to #BlankBoxCount
       add  #Amount to #14S
       add  #Prv_Amount to #Prv_14S
       add  #Amount to #14S_T
       add  #Prv_Amount to #Prv_14S_T
       break
     when = '14T '                                !
       add 1 to #BlankBoxCount
       add  #Amount to #14T
       add  #Prv_Amount to #Prv_14T
       add  #Amount to #14T_T
       add  #Prv_Amount to #Prv_14T_T
       break
     when = '14U '                                !
       add 1 to #BlankBoxCount
       add  #Amount to #14U
       add  #Prv_Amount to #Prv_14U
       add  #Amount to #14U_T
       add  #Prv_Amount to #Prv_14U_T
       break
     when = '14V '                                !
       add 1 to #BlankBoxCount
       add  #Amount to #14V
       add  #Prv_Amount to #Prv_14V
       add  #Amount to #14V_T
       add  #Prv_Amount to #Prv_14V_T
       break
     when = '14W '                                !
       add 1 to #BlankBoxCount
       add  #Amount to #14W
       add  #Prv_Amount to #Prv_14W
       add  #Amount to #14W_T
       add  #Prv_Amount to #Prv_14W_T
       break
     when = '14X '                                !
       add 1 to #BlankBoxCount
       add  #Amount to #14X
       add  #Prv_Amount to #Prv_14X
       add  #Amount to #14X_T
       add  #Prv_Amount to #Prv_14X_T
       break
     when = '14Y '                                !
       add 1 to #BlankBoxCount
       add  #Amount to #14Y
       add  #Prv_Amount to #Prv_14Y
       add  #Amount to #14Y_T
       add  #Prv_Amount to #Prv_14Y_T
       break
     when = '14YN'                                !
       add 1 to #BlankBoxCount
       add  #Amount to #14YN
       add  #Prv_Amount to #Prv_14YN
       add  #Amount to #14YN_T
       add  #Prv_Amount to #Prv_14YN_T
       break
     when = '14YT'                                !
       add 1 to #BlankBoxCount
       add  #Amount to #14YT
       add  #Prv_Amount to #Prv_14YT
       add  #Amount to #14YT_T
       add  #Prv_Amount to #Prv_14YT_T
       break
     when = '14Z '                                !
       add 1 to #BlankBoxCount
       add  #Amount to #14Z
       add  #Prv_Amount to #Prv_14Z
       add  #Amount to #14Z_T
       add  #Prv_Amount to #Prv_14Z_T
       break
     when = '14ZN'                                !
       add 1 to #BlankBoxCount
       add  #Amount to #14ZN
       add  #Prv_Amount to #Prv_14ZN
       add  #Amount to #14ZN_T
       add  #Prv_Amount to #Prv_14ZN_T
       break
     when = '17'                                 !State wages
         add 1 to #StateLocalCount

         PUT &D.BOX      INTO STATELOCALS(#STATELOCALCOUNT) BOX
         PUT &D.STATE    INTO STATELOCALS(#STATELOCALCOUNT) STATE
         PUT ' '         INTO STATELOCALS(#STATELOCALCOUNT) LOCALITY

         PUT #Amount INTO STATELOCALS(#STATELOCALCOUNT) AMOUNT
         PUT #Prv_Amount INTO STATELOCALS(#STATELOCALCOUNT) PRVAMOUNT
       break
     when = '18'                                 !State tax
         add 1 to #StateLocalCount

         PUT &D.BOX      INTO STATELOCALS(#STATELOCALCOUNT) BOX
         PUT &D.STATE    INTO STATELOCALS(#STATELOCALCOUNT) STATE
         PUT ' '         INTO STATELOCALS(#STATELOCALCOUNT) LOCALITY

         PUT #Amount INTO STATELOCALS(#STATELOCALCOUNT) AMOUNT
         PUT #Prv_Amount INTO STATELOCALS(#STATELOCALCOUNT) PRVAMOUNT
       break
     when = '20'                                 !Local wages
         add 1 to #StateLocalCount

         PUT &D.BOX      INTO STATELOCALS(#STATELOCALCOUNT) BOX
         PUT &D.STATE    INTO STATELOCALS(#STATELOCALCOUNT) STATE
         PUT &D.LOCALITY INTO STATELOCALS(#STATELOCALCOUNT)LOCALITY

         PUT #Amount INTO STATELOCALS(#STATELOCALCOUNT) AMOUNT
         PUT #Prv_Amount INTO STATELOCALS(#STATELOCALCOUNT) PRVAMOUNT
       break
     when = '21'                                 !Local tax
         add 1 to #StateLocalCount

         PUT &D.BOX      INTO STATELOCALS(#STATELOCALCOUNT) BOX
         PUT &D.STATE    INTO STATELOCALS(#STATELOCALCOUNT) STATE
         PUT &D.LOCALITY INTO STATELOCALS(#STATELOCALCOUNT) LOCALITY

         PUT #Amount INTO STATELOCALS(#STATELOCALCOUNT) AMOUNT
         PUT #Prv_Amount INTO STATELOCALS(#STATELOCALCOUNT) PRVAMOUNT
       break
     when-other
       move $D.Box to $Box xx
         display 'UNKNOWN BOX IDENTIFIER:'
         display $D.Box
         display 'Processing Stopped'
         STOP
   end-evaluate

  end-if


FROM  PS_W2C_AMOUNTS D
WHERE D.W2C_BATCH_NBR   = &E.W2C_BATCH_NBR
AND   D.COMPANY         = &E.COMPANY
AND   D.W2C_ADD_EMPLID  = &E.W2C_ADD_EMPLID
AND   D.CALENDAR_YEAR   = &E.CALENDAR_YEAR
ORDER BY D.STATE, D.LOCALITY, D.BOX
end-SELECT
end-procedure

begin-procedure Print-Amounts

  let $F_W2c = 'B99999999.99'
  if #01 <> #Prv_01
    let #01_Diff = #01 - #Prv_01
    print 'Box 1' (+2,40)

    do Format-W2c-Number(#Prv_01, $out, $F_W2c)         !Federal wages
    print $out (,83)

    do Format-W2c-Number(#01, $out, $F_W2c)
    print $out (,116)

    do Format-W2c-Number(#01_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps
  end-if


  if #02 <> #Prv_02
    let #02_Diff = #02 - #Prv_02
    print 'Box 2' (+2,40)

    do Format-W2c-Number(#Prv_02, $out, $F_W2c)        !Federal tax
    print $out (,83)

    do Format-W2c-Number(#02, $out, $F_W2c)
    print $out (,116)

    do Format-W2c-Number(#02_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #03 <> #Prv_03
    let #03_Diff = #03 - #Prv_03
    print 'Box 3' (+2,40)

    do Format-W2c-Number(#Prv_03, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#03, $out, $F_W2c)              !SS wages
    print $out (,116)

    do Format-W2c-Number(#03_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #04 <> #Prv_04
    let #04_Diff = #04 - #Prv_04
    print 'Box 4' (+2,40)

    do Format-W2c-Number(#Prv_04, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#04, $out, $F_W2c)              !SS Tax
    print $out (,116)

    do Format-W2c-Number(#04_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #05 <> #Prv_05
    let #05_Diff = #05 - #Prv_05
    print 'Box 5' (+2,40)

    do Format-W2c-Number(#Prv_05, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#05, $out, $F_W2c)              !Medicare wages
    print $out (,116)

    do Format-W2c-Number(#05_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if


  if #06 <> #Prv_06
    let #06_Diff = #06 - #Prv_06
    print 'Box 6' (+2,40)

    do Format-W2c-Number(#Prv_06, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#06, $out, $F_W2c)              !Medicare tax
    print $out (,116)

    do Format-W2c-Number(#06_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #07 <> #Prv_07
    let #07_Diff = #07 - #Prv_07
    print 'Box 7' (+2,40)

    do Format-W2c-Number(#Prv_07, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#07, $out, $F_W2c)           !SS tips
    print $out (,116)

    do Format-W2c-Number(#07_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if


  if #08 <> #Prv_08
    let #08_Diff = #08 - #Prv_08
    print 'Box 8' (+2,40)

    do Format-W2c-Number(#Prv_08, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#08, $out, $F_W2c)              !Allocated tips
    print $out (,116)

    do Format-W2c-Number(#08_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if


  if #09 <> #Prv_09
    let #09_Diff = #09 - #Prv_09
    print 'Box 9' (+2,40)

    do Format-W2c-Number(#Prv_09, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#09, $out, $F_W2c)              !EIC
    print $out (,116)

    do Format-W2c-Number(#09_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if


  if #10 <> #Prv_10                               !Dependent care
    let #10_Diff = #10 - #Prv_10
    print 'Box 10' (+2,40)

    do Format-W2c-Number(#Prv_10, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#10, $out, $F_W2c)
    print $out (,116)

    do Format-W2c-Number(#10_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #11AB <> #Prv_11AB                             !non-qualified plan

    let #11AB_Diff = #11AB - #Prv_11AB
    print 'Box 11' (+2,40)

    add  #Amount to #11AB_T
    add  #Prv_Amount to #Prv_11AB_T

    do Format-W2c-Number(#Prv_11AB, $out, $F_W2c)

    if $Prv_Amt11A = 'Y'
      if $Prv_Amt11B = 'N'
        let $out =  'G' || $out
      end-if
    end-if

    print $out (,83)

    do Format-W2c-Number(#11AB, $out, $F_W2c)

    if $Amt11A = 'Y'
      if $Amt11B = 'N'
        let $out =  'G' || $out
      end-if
    end-if

    print $out (,116)



    do Format-W2c-Number(#11AB_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #12 <> #Prv_12
    let #12_Diff = #12 - #Prv_12
    print 'Box 12' (+2,40)

    do Format-W2c-Number(#Prv_12, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#12, $out, $F_W2c)              !Benefits incl in Box 1
    print $out (,116)

    do Format-W2c-Number(#12_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #13A <> #Prv_13A                               !Uncoll SS tax on tips
    let #13A_Diff = #13A - #Prv_13A
    print 'Box 13A' (+2,40)

    do Format-W2c-Number(#Prv_13A, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#13A, $out, $F_W2c)
    print $out (,116)

    do Format-W2c-Number(#13A_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #13B <> #Prv_13B
    let #13B_Diff = #13B - #Prv_13B
    print 'Box 13B' (+2,40)

    do Format-W2c-Number(#Prv_13B, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#13B, $out, $F_W2c)             !Uncoll Medi tax on tips
    print $out (,116)

    do Format-W2c-Number(#13B_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #13C <> #Prv_13C
    let #13C_Diff = #13C - #Prv_13C
    print 'Box 13C' (+2,40)

    do Format-W2c-Number(#Prv_13C, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#13C, $out, $F_W2c)              !GTL
    print $out (,116)

    do Format-W2c-Number(#13C_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #13D <> #Prv_13D
    let #13D_Diff = #13D - #Prv_13D
    print 'Box 13D' (+2,40)

    do Format-W2c-Number(#Prv_13D, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#13D, $out, $F_W2c)              !401(k)
    print $out (,116)

    do Format-W2c-Number(#13D_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #13E <> #Prv_13E
    let #13E_Diff = #13E - #Prv_13E
    print 'Box 13E' (+2,40)

    do Format-W2c-Number(#Prv_13E, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#13E, $out, $F_W2c)              !403(b)
    print $out (,116)

    do Format-W2c-Number(#13E_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #13F <> #Prv_13F
    let #13F_Diff = #13F - #Prv_13F
    print 'Box 13F' (+2,40)

    do Format-W2c-Number(#Prv_13F, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#13F, $out, $F_W2c)              !408(k)(6)
    print $out (,116)

    do Format-W2c-Number(#13F_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #13G <> #Prv_13G
    let #13G_Diff = #13G - #Prv_13G
    print 'Box 13G' (+2,40)

    do Format-W2c-Number(#Prv_13G, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#13G, $out, $F_W2c)              !457(b)
    print $out (,116)

    do Format-W2c-Number(#13G_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #13H <> #Prv_13H
    let #13H_Diff = #13H - #Prv_13H
    print 'Box 13H' (+2,40)

    do Format-W2c-Number(#Prv_13H, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#13H, $out, $F_W2c)              !501(c)(18)(D)
    print $out (,116)

    do Format-W2c-Number(#13H_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #13J <> #Prv_13J
    let #13J_Diff = #13J - #Prv_13J
    print 'Box 13J' (+2,40)

    do Format-W2c-Number(#Prv_13J, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#13J, $out, $F_W2c)              !Sick pay
    print $out (,116)

    do Format-W2c-Number(#13J_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #13K <> #Prv_13K
    let #13K_Diff = #13K - #Prv_13K
    print 'Box 13K' (+2,40)

    do Format-W2c-Number(#Prv_13K, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#13K, $out, $F_W2c)              !Excise tax
    print $out (,116)

    do Format-W2c-Number(#13K_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #13L <> #Prv_13L
    let #13L_Diff = #13L - #Prv_13L
    print 'Box 13L' (+2,40)

    do Format-W2c-Number(#Prv_13L, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#13L, $out, $F_W2c)              !Business expense
    print $out (,116)

    do Format-W2c-Number(#13L_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #13M <> #Prv_13M
    let #13M_Diff = #13M - #Prv_13M
    print 'Box 13M' (+2,40)

    do Format-W2c-Number(#Prv_13M, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#13M, $out, $F_W2c)              !Uncoll SS tax - GTL
    print $out (,116)

    do Format-W2c-Number(#13M_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #13N <> #Prv_13N
    let #13N_Diff = #13N - #Prv_13N
    print 'Box 13N' (+2,40)

    do Format-W2c-Number(#Prv_13N, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#13N, $out, $F_W2c)              !Uncoll Medi tax - GTL
    print $out (,116)

    do Format-W2c-Number(#13N_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #13P <> #Prv_13P
    let #13P_Diff = #13P - #Prv_13P
    print 'Box 13P' (+2,40)

    do Format-W2c-Number(#Prv_13P, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#13P, $out, $F_W2c)              !Excl Moving Exp
    print $out (,116)

    do Format-W2c-Number(#13P_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #13Q <> #Prv_13Q
    let #13Q_Diff = #13Q - #Prv_13Q
    print 'Box 13Q' (+2,40)

    do Format-W2c-Number(#Prv_13Q, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#13Q, $out, $F_W2c)              !Basic Qtrs and Subsistence
    print $out (,116)

    do Format-W2c-Number(#13Q_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #13R <> #Prv_13R
    let #13R_Diff = #13R - #Prv_13R
    print 'Box 13R' (+2,40)

    do Format-W2c-Number(#Prv_13R, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#13R, $out, $F_W2c)              !Medical spending acct
    print $out (,116)

    do Format-W2c-Number(#13R_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #13S <> #Prv_13S
    let #13S_Diff = #13S - #Prv_13S
    print 'Box 13S' (+2,40)

    do Format-W2c-Number(#Prv_13S, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#13S, $out, $F_W2c)              !Section 418(p) simple
    print $out (,116)                                     ! retirement

    do Format-W2c-Number(#13S_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #13T <> #Prv_13T
    let #13T_Diff = #13T - #Prv_13T
    print 'Box 13T' (+2,40)

    do Format-W2c-Number(#Prv_13T, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#13T, $out, $F_W2c)              !Adoption expense
    print $out (,116)

    do Format-W2c-Number(#13T_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #14A <> #Prv_14A
    let #14A_Diff = #14A - #Prv_14A
    print 'Box 14A' (+2,40)

    do Format-W2c-Number(#Prv_14A, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#14A, $out, $F_W2c)              !CASDI
    print $out (,116)

    do Format-W2c-Number(#14A_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #14B <> #Prv_14B
    let #14B_Diff = #14B - #Prv_14B
    print 'Box 14B' (+2,40)

    do Format-W2c-Number(#Prv_14B, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#14B, $out, $F_W2c)              !VPDI
    print $out (,116)

    do Format-W2c-Number(#14B_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #14C <> #Prv_14C
    let #14C_Diff = #14C - #Prv_14C
    print 'Box 14C' (+2,40)

    do Format-W2c-Number(#Prv_14C, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#14C, $out, $F_W2c)              !WD
    print $out (,116)

    do Format-W2c-Number(#14C_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #14D <> #Prv_14D
    let #14D_Diff = #14D - #Prv_14D
    print 'Box 14D' (+2,40)

    do Format-W2c-Number(#Prv_14D, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#14D, $out, $F_W2c)              !UI/HC
    print $out (,116)

    do Format-W2c-Number(#14D_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #14E <> #Prv_14E
    let #14E_Diff = #14E - #Prv_14E
    print 'Box 14E' (+2,40)

    do Format-W2c-Number(#Prv_14E, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#14E, $out, $F_W2c)              !NJSDI
    print $out (,116)

    do Format-W2c-Number(#14E_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #14F <> #Prv_14F
    let #14F_Diff = #14F - #Prv_14F
    print 'Box 14F' (+2,40)

    do Format-W2c-Number(#Prv_14F, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#14F, $out, $F_W2c)              !VPDI
    print $out (,116)

    do Format-W2c-Number(#14F_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #14G <> #Prv_14G
    let #14G_Diff = #14G - #Prv_14G
    print 'Box 14G' (+2,40)

    do Format-W2c-Number(#Prv_14G, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#14G, $out, $F_W2c)              !
    print $out (,116)

    do Format-W2c-Number(#14G_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #14H <> #Prv_14H
    let #14H_Diff = #14H - #Prv_14H
    print 'Box 14H' (+2,40)

    do Format-W2c-Number(#Prv_14H, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#14H, $out, $F_W2c)              !
    print $out (,116)

    do Format-W2c-Number(#14H_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #14I <> #Prv_14I
    let #14I_Diff = #14I - #Prv_14I
    print 'Box 14I' (+2,40)

    do Format-W2c-Number(#Prv_14I, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#14I, $out, $F_W2c)              !
    print $out (,116)

    do Format-W2c-Number(#14I_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #14J <> #Prv_14J
    let #14J_Diff = #14J - #Prv_14J
    print 'Box 14J' (+2,40)

    do Format-W2c-Number(#Prv_14J, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#14J, $out, $F_W2c)              !
    print $out (,116)

    do Format-W2c-Number(#14J_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #14K <> #Prv_14K
    let #14K_Diff = #14K - #Prv_14K
    print 'Box 14K' (+2,40)

    do Format-W2c-Number(#Prv_14K, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#14K, $out, $F_W2c)              !
    print $out (,116)

    do Format-W2c-Number(#14K_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #14L <> #Prv_14L
    let #14L_Diff = #14L - #Prv_14L
    print 'Box 14L' (+2,40)

    do Format-W2c-Number(#Prv_14L, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#14L, $out, $F_W2c)              !
    print $out (,116)

    do Format-W2c-Number(#14L_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #14M <> #Prv_14M
    let #14M_Diff = #14M - #Prv_14M
    print 'Box 14M' (+2,40)

    do Format-W2c-Number(#Prv_14M, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#14M, $out, $F_W2c)              !
    print $out (,116)

    do Format-W2c-Number(#14M_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #14N <> #Prv_14N
    let #14N_Diff = #14N - #Prv_14N
    print 'Box 14N' (+2,40)

    do Format-W2c-Number(#Prv_14N, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#14N, $out, $F_W2c)              !
    print $out (,116)

    do Format-W2c-Number(#14N_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #14O <> #Prv_14O
    let #14O_Diff = #14O - #Prv_14O
    print 'Box 14O' (+2,40)

    do Format-W2c-Number(#Prv_14O, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#14O, $out, $F_W2c)              !
    print $out (,116)

    do Format-W2c-Number(#14O_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #14P <> #Prv_14P
    let #14P_Diff = #14P - #Prv_14P
    print 'Box 14P' (+2,40)

    do Format-W2c-Number(#Prv_14P, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#14P, $out, $F_W2c)              !
    print $out (,116)

    do Format-W2c-Number(#14P_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #14Q <> #Prv_14Q
    let #14Q_Diff = #14Q - #Prv_14Q
    print 'Box 14Q' (+2,40)

    do Format-W2c-Number(#Prv_14Q, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#14Q, $out, $F_W2c)              !
    print $out (,116)

    do Format-W2c-Number(#14Q_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #14R <> #Prv_14R
    let #14R_Diff = #14R - #Prv_14R
    print 'Box 14R' (+2,40)

    do Format-W2c-Number(#Prv_14R, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#14R, $out, $F_W2c)              !
    print $out (,116)

    do Format-W2c-Number(#14R_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #14S <> #Prv_14S
    let #14S_Diff = #14S - #Prv_14S
    print 'Box 14S' (+2,40)

    do Format-W2c-Number(#Prv_14S, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#14S, $out, $F_W2c)              !
    print $out (,116)

    do Format-W2c-Number(#14S_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #14T <> #Prv_14T
    let #14T_Diff = #14T - #Prv_14T
    print 'Box 14T' (+2,40)

    do Format-W2c-Number(#Prv_14T, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#14T, $out, $F_W2c)              !
    print $out (,116)

    do Format-W2c-Number(#14T_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #14U <> #Prv_14U
    let #14U_Diff = #14U - #Prv_14U
    print 'Box 14U' (+2,40)

    do Format-W2c-Number(#Prv_14U, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#14U, $out, $F_W2c)              !
    print $out (,116)

    do Format-W2c-Number(#14U_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #14V <> #Prv_14V
    let #14V_Diff = #14V - #Prv_14V
    print 'Box 14V' (+2,40)

    do Format-W2c-Number(#Prv_14V, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#14V, $out, $F_W2c)              !
    print $out (,116)

    do Format-W2c-Number(#14V_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #14W <> #Prv_14W
    let #14W_Diff = #14W - #Prv_14W
    print 'Box 14W' (+2,40)

    do Format-W2c-Number(#Prv_14W, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#14W, $out, $F_W2c)              !
    print $out (,116)

    do Format-W2c-Number(#14W_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #14X <> #Prv_14X
    let #14X_Diff = #14X - #Prv_14X
    print 'Box 14X' (+2,40)

    do Format-W2c-Number(#Prv_14X, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#14X, $out, $F_W2c)              !
    print $out (,116)

    do Format-W2c-Number(#14X_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #14Y <> #Prv_14Y
    let #14Y_Diff = #14Y - #Prv_14Y
    print 'Box 14Y' (+2,40)

    do Format-W2c-Number(#Prv_14Y, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#14Y, $out, $F_W2c)              !
    print $out (,116)

    do Format-W2c-Number(#14Y_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #14Z <> #Prv_14Z
    let #14Z_Diff = #14Z - #Prv_14Z
    print 'Box 14Z' (+2,40)

    do Format-W2c-Number(#Prv_14Z, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#14Z, $out, $F_W2c)              !
    print $out (,116)

    do Format-W2c-Number(#14Z_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

end-procedure



begin-procedure Print-State-Local-Amounts

  move 1 to #NextStateLoc

  get $Box $State $Locality #Amount #PrvAmount
                         from StateLocals(#NextStateLoc)
  let $Prv_Box = RTRIM($Box,' ')
  let $Prv_State = RTRIM($State,' ')
  let $Prv_Locality = RTRIM($Locality,' ')

  while #NextStateLoc <= #StateLocalCount

  let $Box = RTRIM($Box,' ')
  let $State = RTRIM($State,' ')
  let $Locality = RTRIM($Locality,' ')
  let #Diff = #Amount - #PrvAmount
  evaluate $Box

  when = '17'                                 !State wages


    print 'Box 17' (+2,40)
    print $State (,52)

    do Format-W2c-Number(#PrvAmount, $out, $F_W2c)         !State wages
    print $out (,83)

    do Format-W2c-Number(#Amount, $out, $F_W2c)
    print $out (,116)

    do Format-W2c-Number(#Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

    let $Prv_Box = RTRIM($Box,' ')
    let $Prv_State = RTRIM($State,' ')
    let $Prv_Locality = RTRIM($Locality,' ')
    add 1 to #NextStateLoc

    if #NextStateLoc <= #StateLocalCount
       get $Box $State $Locality #Amount #PrvAmount
                    from StateLocals(#NextStateLoc)
    end-if
    break
  when = '18'                                 !State taxes

    print 'Box 18' (+2,40)
    print $State (,52)

    do Format-W2c-Number(#PrvAmount, $out, $F_W2c)         !State wages
    print $out (,83)

    do Format-W2c-Number(#Amount, $out, $F_W2c)
    print $out (,116)

    do Format-W2c-Number(#Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

    let $Prv_Box = RTRIM($Box,' ')
    let $Prv_State = RTRIM($State,' ')
    let $Prv_Locality = RTRIM($Locality,' ')
    add 1 to #NextStateLoc


    if #NextStateLoc <= #StateLocalCount
       get $Box $State $Locality #Amount #PrvAmount
                    from StateLocals(#NextStateLoc)
    end-if
    break

  when = '20'                                 !Local wages

    print 'Box 20' (+2,40)
    print $State (,52)
    do Get-Locality-Print-Name
    print $LocalityPrintName  (,61)

    do Format-W2c-Number(#PrvAmount, $out, $F_W2c)         !Local wages
    print $out (,83)

    do Format-W2c-Number(#Amount, $out, $F_W2c)
    print $out (,116)

    do Format-W2c-Number(#Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

    let $Prv_Box = RTRIM($Box,' ')
    let $Prv_State = RTRIM($State,' ')
    let $Prv_Locality = RTRIM($Locality,' ')
    add 1 to #NextStateLoc


    if #NextStateLoc <= #StateLocalCount
       get $Box $State $Locality #Amount #PrvAmount
                    from StateLocals(#NextStateLoc)
    end-if
    break

  when = '21'                                 !Local tax

    print 'Box 21' (+2,40)
    print $State (,52)

    if $Prv_Locality <> $Locality or $Prv_Box <> '20'
       or $Prv_State <> $State
      do Get-Locality-Print-Name
    end-if
    print $LocalityPrintName (,61)


    do Format-W2c-Number(#PrvAmount, $out, $F_W2c)         !Local taxes
    print $out (,83)

    do Format-W2c-Number(#Amount, $out, $F_W2c)
    print $out (,116)

    do Format-W2c-Number(#Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps


    let $Prv_Box = RTRIM($Box,' ')
    let $Prv_State = RTRIM($State,' ')
    let $Prv_Locality = RTRIM($Locality,' ')
    add 1 to #NextStateLoc


    if #NextStateLoc <= #StateLocalCount
       get $Box $State $Locality #Amount #PrvAmount
                    from StateLocals(#NextStateLoc)
    end-if
    break
end-evaluate
end-while
end-procedure


begin-procedure Print-EE-Data


  print  $E.EmplID  (+3,1)
  print  $E.W2_Name (+1,1)
  if ($E.W2_Name <> $E.Prv_W2_Name)
    print  $E.Prv_W2_Name (,79)
    print  $E.W2_Name (,113)
  end-if


  print  $E.SSN (+1,1)
  if ($E.SSN <> $E.Prv_SSN)
    print  $E.Prv_SSN (,85)
    print  $E.SSN (,119
  end-if


  if ($E.Prv_Statutory_Ee <> $E.Statutory_Ee)
  or ($E.Prv_Deceased <> $E.Deceased)
  or ($E.Prv_Pension_Plan <> $E.Pension_Plan)
  or ($E.Prv_Legal_Rep <>  $E.Legal_Rep)
  or ($E.Prv_Deferred_Comp <> $E.Deferred_Comp)

  move 'N' to $Box15_Flag
  print  'Box 15 Entries ' (+2,40)

     if $E.Prv_Statutory_Ee = 'Y'
       move 'Y' to $Box15_Flag
       print  'Stat. EE' (,85)
       if $E.Statutory_Ee = 'Y'
         move 'Y' to $Box15_Flag
         print  'Stat. EE' (,119)
       end-if
     else
       if $E.Statutory_Ee = 'Y'
       move 'Y' to $Box15_Flag
         print  'Stat. EE' (,119)
       end-if
     end-if

     if $Box15_Flag = 'Y' and ($E.Prv_Deceased = 'Y' or $E.Deceased = 'Y')
       print ' ' (+1,1)
     end-if

     if $E.Prv_Deceased = 'Y'
       move 'Y' to $Box15_Flag
       print  'Deceased' (,85)
       if $E.Deceased = 'Y'
         move 'Y' to $Box15_Flag
         print  'Deceased' (,119)
       end-if
     else
       if $E.Deceased = 'Y'
         move 'Y' to $Box15_Flag
         print  'Deceased' (,119)
       end-if
     end-if

     if $Box15_Flag = 'Y' and ($E.Prv_Pension_Plan = 'Y' or $E.Pension_Plan = 'Y')
       print ' ' (+1,1)
     end-if

     if $E.Prv_Pension_Plan = 'Y'
       move 'Y' to $Box15_Flag
       print  'Pension Plan' (,85)
       if $E.Pension_Plan = 'Y'
         move 'Y' to $Box15_Flag
         print  'Pension Plan' (,119)
       end-if
     else
       if $E.Pension_Plan = 'Y'
         move 'Y' to $Box15_Flag
         print  'Pension Plan' (,119)
       end-if
     end-if

     if $Box15_Flag = 'Y' and ($E.Prv_Legal_Rep = 'Y' or $E.Legal_Rep = 'Y')
       print ' ' (+1,1)
     end-if

     if $E.Prv_Legal_Rep = 'Y'
       move 'Y' to $Box15_Flag
       print  'Legal Rep' (,85)
       if $E.Legal_Rep = 'Y'
         move 'Y' to $Box15_Flag
         print  'Legal Rep' (,119)
       end-if
     else
       if $E.Legal_Rep = 'Y'
         move 'Y' to $Box15_Flag
         print  'Legal Rep' (,119)
       end-if
     end-if

     if $Box15_Flag = 'Y' and ($E.Prv_Deferred_Comp = 'Y' or $E.Deferred_Comp = 'Y')
       print ' ' (+1,1)
     end-if

     if $E.Prv_Deferred_Comp = 'Y'
       print  'Deferred Comp' (,85)
       if $E.Deferred_Comp = 'Y'
         print  'Deferred Comp' (,119)
       end-if
     else
       if $E.Deferred_Comp = 'Y'
         print  'Deferred Comp' (,119)
       end-if
     end-if

  end-if

end-procedure

begin-procedure Get-Locality-Print-Name
  move 'N' to $LocalityNameFound
  move ''  to $LocalityPrintName

begin-SELECT
L2.W2_PRT_NAME
L2.LOCALITY_ABBRV

  move 'Y' to $LocalityNameFound

FROM  PS_LOCAL_TAX_TBL2 L2
WHERE L2.STATE     = $State
  AND L2.LOCALITY  = $Locality
  AND L2.EFFDT =
      (SELECT MAX(EFFDT)
       FROM   PS_LOCAL_TAX_TBL2
       WHERE  STATE    = L2.STATE
         AND  LOCALITY = L2.LOCALITY
         AND  EFFDT   <= $AsOfDate)
end-SELECT

  if $LocalityNameFound = 'Y' and RTRIM(&L2.W2_Prt_Name,' ') <> ''
    move &L2.W2_Prt_Name to $LocalityPrintName
  else
    if $LocalityNameFound = 'Y' and RTRIM(&L2.Locality_Abbrv,' ') <> ''
       move &L2.Locality_Abbrv to $LocalityPrintName
    else
       do Get-Locality-Abbrv
    end-if
  end-if

  uppercase $LocalityPrintName
  PUT $State INTO LocalPrintName(#LocalPrintCount) State
  PUT $Locality INTO LocalPrintName(#LocalPrintCount) Locality
  PUT $LocalityPrintName INTO LocalPrintName(#LocalPrintCount) LocalName
  add 1 to #LocalPrintCount

end-procedure

begin-procedure Get-Locality-Abbrv
begin-SELECT
L.LOCALITY_NAME

  let $LocalityPrintName  = SUBSTR(&L.LOCALITY_NAME,1,16)

FROM  PS_LOCAL_TAX_TBL L
WHERE L.STATE      = $State
  AND L.LOCALITY   = $Locality
  AND L.EFFDT =
      (SELECT MAX(EFFDT)
       FROM   PS_LOCAL_TAX_TBL
       WHERE  STATE    = L.STATE
         AND  LOCALITY = L.LOCALITY
         AND  EFFDT   <= $AsOfDate)
end-SELECT

end-procedure


begin-procedure Get-State-SWT

begin-SELECT DISTINCT
S.EMPLOYER_ID_SWT


   PUT $State INTO STATESWT(#StateSWTCount) State
   PUT &S.EMPLOYER_ID_SWT INTO STATESWT(#StateSWTCount) SWT
   add 1 to #StateSWTCount


FROM  PS_CO_STATETAX_TBL S
WHERE S.COMPANY        = &E.COMPANY
  AND S.STATE          = $State
  AND S.EFF_STATUS     = 'A'
  AND S.EFFDT =
      (SELECT MAX(EFFDT)
       FROM   PS_CO_STATETAX_TBL
       WHERE  COMPANY = &E.COMPANY
         AND  STATE   = $State
         AND  EFF_STATUS = 'A'
         AND  EFFDT  <= $AsOfDate)
end-SELECT

end-procedure


begin-procedure Get-W2C-Run-Controls

begin-SELECT

W2C.W2C_RECENT_BATCH
W2C.W2C_BATCH_NBR

FROM  PS_RC_TAX920AU   W2C
WHERE W2C.OPRID            = $Prcs_OprID
AND   W2C.RUN_CNTL_ID      = $Prcs_Run_Cntl_ID

end-SELECT


  do Get-W2C-Parameters
  if &W2C.W2C_RECENT_BATCH  = 'Y'
    do Get-Most-Recent-Batch
  else
    move &W2C.W2C_BATCH_NBR to #W2c_Batch_Nbr
  end-if
  do Get-Tax-Year

end-procedure


begin-procedure Get-Most-Recent-Batch
begin-SELECT

COUNT(*)   &W2cCount

FROM PS_W2C_DATA CT
WHERE CT.W2C_BATCH_NBR = &W2C_INSTALL.W2C_BATCH_NBR

end-SELECT

if &W2cCount > 0
    let #W2c_Batch_Nbr = &W2C_INSTALL.W2C_BATCH_NBR
else
    let #W2c_Batch_Nbr = &W2C_INSTALL.W2C_BATCH_NBR  - 1
end-if
end-procedure

begin-procedure Get-W2C-Parameters

begin-SELECT
W2C_INSTALL.W2C_BATCH_NBR
W2C_INSTALL.W2C_BATCH_YR


FROM  PS_W2C_INSTALL W2C_INSTALL

end-SELECT


move &W2C_INSTALL.W2C_BATCH_NBR to #W2c_Batch_Nbr

end-procedure

begin-procedure Get-Tax-Year
begin-SELECT DISTINCT
CALENDAR_YEAR

FROM  PS_W2C_DATA
WHERE   W2C_BATCH_NBR = #W2c_Batch_Nbr

end-SELECT

move &CALENDAR_YEAR to $CalYear
end-procedure

begin-procedure Print-W3c-Totals
  new-page
  print 'W-3c Totals ' (+4,1)
  print $W3c_Descr (+2,1)
  print $W3c_Address1 (+1,1)
  if RTRIM($W3c_Address2 , ' ') <> ''
    print $W3c_Address2 (+1,1)
  end-if
   print $W3c_Address3 (+1,1)


  print 'Number of Forms W-2c ' (+2,1)
  print #W3c_Count (,+5)  edit B9999

  print 'Employer Federal EIN  ' (+2,1)
  print $W3c_EIN (,+5)


  let $F_T = 'B99999999.99'

  if #01_T <> #Prv_01_T
    print 'Box 1 ' (+2,40)
    let #01_Diff_T = #01_T - #Prv_01_T

    do Format-W2c-Number(#Prv_01_T , $out, $F_T)         !Federal wages
    print $out (,83)

    do Format-W2c-Number(#01_T , $out, $F_T)
    print $out (,116)

    do Format-W2c-Number(#01_Diff_T , $out, $F_T)
    print $out (,147) edit 9999999999.99ps
  end-if


  if #02_T  <> #Prv_02_T
    print 'Box 2 ' (+2,40)
    let #02_Diff_T  = #02_T  - #Prv_02_T

    do Format-W2c-Number(#Prv_02_T , $out, $F_T)        !Federal tax
    print $out (,83)

    do Format-W2c-Number(#02_T , $out, $F_T)
    print $out (,116)

    do Format-W2c-Number(#02_Diff_T , $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #03_T  <> #Prv_03_T
    print 'Box 3 ' (+2,40)
    let #03_Diff_T  = #03_T  - #Prv_03_T

    do Format-W2c-Number(#Prv_03_T , $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#03_T , $out, $F_T)              !SS wages
    print $out (,116)

    do Format-W2c-Number(#03_Diff_T , $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #04_T <> #Prv_04_T
    print 'Box 4 ' (+2,40)
    let #04_Diff_T  = #04_T  - #Prv_04_T

    do Format-W2c-Number(#Prv_04_T , $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#04_T , $out, $F_T)              !SS Tax
    print $out (,116)

    do Format-W2c-Number(#04_Diff_T , $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #05_T <> #Prv_05_T
    print 'Box 5 ' (+2,40)
    let #05_Diff_T = #05_T - #Prv_05_T

    do Format-W2c-Number(#Prv_05_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#05_T, $out, $F_T)              !Medicare wages
    print $out (,116)

    do Format-W2c-Number(#05_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if


  if #06_T <> #Prv_06_T
    print 'Box 6 ' (+2,40)
    let #06_Diff_T = #06_T - #Prv_06_T

    do Format-W2c-Number(#Prv_06_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#06_T, $out, $F_T)              !Medicare tax
    print $out (,116)

    do Format-W2c-Number(#06_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #07_T <> #Prv_07_T
    print 'Box 7 ' (+2,40)
    let #07_Diff_T = #07_T - #Prv_07_T


    do Format-W2c-Number(#Prv_07_T, $out, $F_T)
    print $out (,83)


    do Format-W2c-Number(#07_T, $out, $F_T)           !SS tips
    print $out (,116)

    do Format-W2c-Number(#07_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if


  if #08_T <> #Prv_08_T
    print 'Box 8 ' (+2,40)
    let #08_Diff_T = #08_T - #Prv_08_T

    do Format-W2c-Number(#Prv_08_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#08_T, $out, $F_T)              !Allocated tips
    print $out (,116)

    do Format-W2c-Number(#08_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #09_T <> #Prv_09_T
    print 'Box 9 ' (+2,40)
    let #09_Diff_T = #09_T - #Prv_09_T

    do Format-W2c-Number(#Prv_09_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#09_T, $out, $F_T)              !Allocated tips
    print $out (,116)

    do Format-W2c-Number(#09_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #10_T <> #Prv_10_T
    print 'Box 10 ' (+2,40)
    let #10_Diff_T = #10_T - #Prv_10_T

    do Format-W2c-Number(#Prv_10_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#10_T, $out, $F_T)              !Allocated tips
    print $out (,116)

    do Format-W2c-Number(#10_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #11AB_T <> #Prv_11AB_T
    print 'Box 11 ' (+2,40)
    let #11AB_Diff_T = #11AB_T - #Prv_11AB_T

    do Format-W2c-Number(#Prv_11AB_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#11AB_T, $out, $F_T)              !11AB
    print $out (,116)

    do Format-W2c-Number(#11AB_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #12_T <> #Prv_12_T
    print 'Box 12 ' (+2,40)
    let #12_Diff_T = #12_T - #Prv_12_T

    do Format-W2c-Number(#Prv_12_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#12_T, $out, $F_T)              !Allocated tips
    print $out (,116)

    do Format-W2c-Number(#12_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #13A_T <> #Prv_13A_T
    print 'Box 13A' (+2,40)
    let #13A_Diff_T = #13A_T - #Prv_13A_T

    do Format-W2c-Number(#Prv_13A_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#13A_T, $out, $F_T)              !
    print $out (,116)

    do Format-W2c-Number(#13A_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #13B_T <> #Prv_13B_T
    print 'Box 13B' (+2,40)
    let #13B_Diff_T = #13B_T - #Prv_13B_T

    do Format-W2c-Number(#Prv_13B_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#13B_T, $out, $F_T)              !
    print $out (,116)

    do Format-W2c-Number(#13B_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #13C_T <> #Prv_13C_T
    print 'Box 13C' (+2,40)
    let #13C_Diff_T = #13C_T - #Prv_13C_T

    do Format-W2c-Number(#Prv_13C_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#13C_T, $out, $F_T)              !
    print $out (,116)

    do Format-W2c-Number(#13C_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #13D_T <> #Prv_13D_T
    print 'Box 13D' (+2,40)
    let #13D_Diff_T = #13D_T - #Prv_13D_T

    do Format-W2c-Number(#Prv_13D_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#13D_T, $out, $F_T)              !
    print $out (,116)

    do Format-W2c-Number(#13D_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #13E_T <> #Prv_13E_T
    print 'Box 13E' (+2,40)
    let #13E_Diff_T = #13E_T - #Prv_13E_T

    do Format-W2c-Number(#Prv_13E_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#13E_T, $out, $F_T)              !
    print $out (,116)

    do Format-W2c-Number(#13E_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #13F_T <> #Prv_13F_T
    print 'Box 13F' (+2,40)
    let #13F_Diff_T = #13F_T - #Prv_13F_T

    do Format-W2c-Number(#Prv_13F_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#13F_T, $out, $F_T)              !
    print $out (,116)

    do Format-W2c-Number(#13F_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #13G_T <> #Prv_13G_T
    print 'Box 13G' (+2,40)
    let #13G_Diff_T = #13G_T - #Prv_13G_T

    do Format-W2c-Number(#Prv_13G_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#13G_T, $out, $F_T)              !
    print $out (,116)

    do Format-W2c-Number(#13G_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #13H_T <> #Prv_13H_T
    print 'Box 13H' (+2,40)
    let #13H_Diff_T = #13H_T - #Prv_13H_T

    do Format-W2c-Number(#Prv_13H_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#13H_T, $out, $F_T)              !
    print $out (,116)

    do Format-W2c-Number(#13H_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #13J_T <> #Prv_13J_T
    print 'Box 13J' (+2,40)
    let #13J_Diff_T = #13J_T - #Prv_13J_T

    do Format-W2c-Number(#Prv_13J_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#13J_T, $out, $F_T)              !
    print $out (,116)

    do Format-W2c-Number(#13J_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #13K_T <> #Prv_13K_T
    print 'Box 13K' (+2,40)
    let #13K_Diff_T = #13K_T - #Prv_13K_T

    do Format-W2c-Number(#Prv_13K_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#13K_T, $out, $F_T)              !
    print $out (,116)

    do Format-W2c-Number(#13K_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #13L_T <> #Prv_13L_T
    print 'Box 13L' (+2,40)
    let #13L_Diff_T = #13L_T - #Prv_13L_T

    do Format-W2c-Number(#Prv_13L_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#13L_T, $out, $F_T)              !
    print $out (,116)

    do Format-W2c-Number(#13L_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #13M_T <> #Prv_13M_T
    print 'Box 13M' (+2,40)
    let #13M_Diff_T = #13M_T - #Prv_13M_T

    do Format-W2c-Number(#Prv_13M_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#13M_T, $out, $F_T)              !
    print $out (,116)

    do Format-W2c-Number(#13M_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #13N_T <> #Prv_13N_T
    print 'Box 13N' (+2,40)
    let #13N_Diff_T = #13N_T - #Prv_13N_T

    do Format-W2c-Number(#Prv_13N_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#13N_T, $out, $F_T)              !
    print $out (,116)

    do Format-W2c-Number(#13N_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #13P_T <> #Prv_13P_T
    print 'Box 13P' (+2,40)
    let #13P_Diff_T = #13P_T - #Prv_13P_T

    do Format-W2c-Number(#Prv_13P_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#13P_T, $out, $F_T)              !
    print $out (,116)

    do Format-W2c-Number(#13P_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #13Q_T <> #Prv_13Q_T
    print 'Box 13Q' (+2,40)
    let #13Q_Diff_T = #13Q_T - #Prv_13Q_T

    do Format-W2c-Number(#Prv_13Q_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#13Q_T, $out, $F_T)              !
    print $out (,116)

    do Format-W2c-Number(#13Q_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #13R_T <> #Prv_13R_T
    print 'Box 13R' (+2,40)
    let #13R_Diff_T = #13R_T - #Prv_13R_T

    do Format-W2c-Number(#Prv_13R_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#13R_T, $out, $F_T)              !
    print $out (,116)

    do Format-W2c-Number(#13R_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #13S_T <> #Prv_13S_T
    print 'Box 13S' (+2,40)
    let #13S_Diff_T = #13S_T - #Prv_13S_T

    do Format-W2c-Number(#Prv_13S_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#13S_T, $out, $F_T)              !
    print $out (,116)

    do Format-W2c-Number(#13S_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #13T_T <> #Prv_13T_T
    print 'Box 13T' (+2,40)
    let #13T_Diff_T = #13T_T - #Prv_13T_T

    do Format-W2c-Number(#Prv_13T_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#13T_T, $out, $F_T)              !
    print $out (,116)

    do Format-W2c-Number(#13T_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #14A_T <> #Prv_14A_T
    print 'Box 14A' (+2,40)
    let #14A_Diff_T = #14A_T - #Prv_14A_T

    do Format-W2c-Number(#Prv_14A_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#14A_T, $out, $F_T)
    print $out (,116)

    do Format-W2c-Number(#14A_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #14B_T <> #Prv_14B_T
    print 'Box 14B' (+2,40)
    let #14B_Diff_T = #14B_T - #Prv_14B_T

    do Format-W2c-Number(#Prv_14B_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#14B_T, $out, $F_T)
    print $out (,116)

    do Format-W2c-Number(#14B_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #14C_T <> #Prv_14C_T
    print 'Box 14C' (+2,40)
    let #14C_Diff_T = #14C_T - #Prv_14C_T

    do Format-W2c-Number(#Prv_14C_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#14C_T, $out, $F_T)              !
    print $out (,116)

    do Format-W2c-Number(#14C_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #14D_T <> #Prv_14D_T
    print 'Box 14D' (+2,40)
    let #14D_Diff_T = #14D_T - #Prv_14D_T

    do Format-W2c-Number(#Prv_14D_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#14D_T, $out, $F_T)              !
    print $out (,116)

    do Format-W2c-Number(#14D_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #14E_T <> #Prv_14E_T
    print 'Box 14E' (+2,40)
    let #14E_Diff_T = #14E_T - #Prv_14E_T

    do Format-W2c-Number(#Prv_14E_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#14E_T, $out, $F_T)              !
    print $out (,116)

    do Format-W2c-Number(#14E_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #14F_T <> #Prv_14F_T
    print 'Box 14F' (+2,40)
    let #14F_Diff_T = #14F_T - #Prv_14F_T

    do Format-W2c-Number(#Prv_14F_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#14F_T, $out, $F_T)              !
    print $out (,116)

    do Format-W2c-Number(#14F_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #14G_T <> #Prv_14G_T
    print 'Box 14G' (+2,40)
    let #14G_Diff_T = #14G_T - #Prv_14G_T

    do Format-W2c-Number(#Prv_14G_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#14G_T, $out, $F_T)
    print $out (,116)

    do Format-W2c-Number(#14G_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #14H_T <> #Prv_14H_T
    print 'Box 14H' (+2,40)
    let #14H_Diff_T = #14H_T - #Prv_14H_T

    do Format-W2c-Number(#Prv_14H_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#14H_T, $out, $F_T)
    print $out (,116)

    do Format-W2c-Number(#14H_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #14I_T <> #Prv_14I_T
    print 'Box 14I' (+2,40)
    let #14I_Diff_T = #14I_T - #Prv_14I_T

    do Format-W2c-Number(#Prv_14I_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#14I_T, $out, $F_T)
    print $out (,116)

    do Format-W2c-Number(#14I_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #14J_T <> #Prv_14J_T
    print 'Box 14J' (+2,40)
    let #14J_Diff_T = #14J_T - #Prv_14J_T

    do Format-W2c-Number(#Prv_14J_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#14J_T, $out, $F_T)
    print $out (,116)

    do Format-W2c-Number(#14J_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #14K_T <> #Prv_14K_T
    print 'Box 14K' (+2,40)
    let #14K_Diff_T = #14K_T - #Prv_14K_T

    do Format-W2c-Number(#Prv_14K_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#14K_T, $out, $F_T)
    print $out (,116)

    do Format-W2c-Number(#14K_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #14L_T <> #Prv_14L_T
    print 'Box 14L' (+2,40)
    let #14L_Diff_T = #14L_T - #Prv_14L_T

    do Format-W2c-Number(#Prv_14L_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#14L_T, $out, $F_T)
    print $out (,116)

    do Format-W2c-Number(#14L_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #14M_T <> #Prv_14M_T
    print 'Box 14M' (+2,40)
    let #14M_Diff_T = #14M_T - #Prv_14M_T

    do Format-W2c-Number(#Prv_14M_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#14M_T, $out, $F_T)
    print $out (,116)

    do Format-W2c-Number(#14M_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #14N_T <> #Prv_14N_T
    print 'Box 14N' (+2,40)
    let #14N_Diff_T = #14N_T - #Prv_14N_T

    do Format-W2c-Number(#Prv_14N_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#14N_T, $out, $F_T)
    print $out (,116)

    do Format-W2c-Number(#14N_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #14O_T <> #Prv_14O_T
    print 'Box 14O' (+2,40)
    let #14O_Diff_T = #14O_T - #Prv_14O_T

    do Format-W2c-Number(#Prv_14O_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#14O_T, $out, $F_T)
    print $out (,116)

    do Format-W2c-Number(#14O_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #14P_T <> #Prv_14P_T
    print 'Box 14P' (+2,40)
    let #14P_Diff_T = #14P_T - #Prv_14P_T

    do Format-W2c-Number(#Prv_14P_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#14P_T, $out, $F_T)
    print $out (,116)

    do Format-W2c-Number(#14P_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #14Q_T <> #Prv_14Q_T
    print 'Box 14Q' (+2,40)
    let #14Q_Diff_T = #14Q_T - #Prv_14Q_T

    do Format-W2c-Number(#Prv_14Q_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#14Q_T, $out, $F_T)
    print $out (,116)

    do Format-W2c-Number(#14Q_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #14R_T <> #Prv_14R_T
    print 'Box 14R' (+2,40)
    let #14R_Diff_T = #14R_T - #Prv_14R_T

    do Format-W2c-Number(#Prv_14R_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#14R_T, $out, $F_T)
    print $out (,116)

    do Format-W2c-Number(#14R_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #14S_T <> #Prv_14S_T
    print 'Box 14S' (+2,40)
    let #14S_Diff_T = #14S_T - #Prv_14S_T

    do Format-W2c-Number(#Prv_14S_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#14S_T, $out, $F_T)
    print $out (,116)

    do Format-W2c-Number(#14S_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #14T_T <> #Prv_14T_T
    print 'Box 14T' (+2,40)
    let #14T_Diff_T = #14T_T - #Prv_14T_T

    do Format-W2c-Number(#Prv_14T_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#14T_T, $out, $F_T)
    print $out (,116)

    do Format-W2c-Number(#14T_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #14U_T <> #Prv_14U_T
    print 'Box 14U' (+2,40)
    let #14U_Diff_T = #14U_T - #Prv_14U_T

    do Format-W2c-Number(#Prv_14U_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#14U_T, $out, $F_T)
    print $out (,116)

    do Format-W2c-Number(#14U_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #14V_T <> #Prv_14V_T
    print 'Box 14V' (+2,40)
    let #14V_Diff_T = #14V_T - #Prv_14V_T

    do Format-W2c-Number(#Prv_14V_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#14V_T, $out, $F_T)
    print $out (,116)

    do Format-W2c-Number(#14V_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #14W_T <> #Prv_14W_T
    print 'Box 14W' (+2,40)
    let #14W_Diff_T = #14W_T - #Prv_14W_T

    do Format-W2c-Number(#Prv_14W_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#14W_T, $out, $F_T)
    print $out (,116)

    do Format-W2c-Number(#14W_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #14X_T <> #Prv_14X_T
    print 'Box 14X' (+2,40)
    let #14X_Diff_T = #14X_T - #Prv_14X_T

    do Format-W2c-Number(#Prv_14X_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#14X_T, $out, $F_T)
    print $out (,116)

    do Format-W2c-Number(#14X_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #14Y_T <> #Prv_14Y_T
    print 'Box 14Y' (+2,40)
    let #14Y_Diff_T = #14Y_T - #Prv_14Y_T

    do Format-W2c-Number(#Prv_14Y_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#14Y_T, $out, $F_T)
    print $out (,116)

    do Format-W2c-Number(#14Y_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #14Z_T <> #Prv_14Z_T
    print 'Box 14Z' (+2,40)
    let #14Z_Diff_T = #14Z_T - #Prv_14Z_T

    do Format-W2c-Number(#Prv_14Z_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#14Z_T, $out, $F_T)
    print $out (,116)

    do Format-W2c-Number(#14Z_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

   do Get-State-Local-Totals

   new-page

end-procedure

begin-procedure Get-State-Local-Totals
let $PrvState = ' '
let $PrvLocalPrintName = ' '

begin-SELECT
SL.BOX
SL.STATE
SL.LOCALITY
#ifdef DB2ALL
DECIMAL(SUM(SL.PRV_AMOUNT),15,3) &SL.PRV_AMOUNT
DECIMAL(SUM(SL.CURRENT_AMOUNT),15,3) &SL.CURRENT_AMOUNT
#else
SUM(SL.PRV_AMOUNT) &SL.PRV_AMOUNT
SUM(SL.CURRENT_AMOUNT) &SL.CURRENT_AMOUNT
#endif
  move &SL.PRV_AMOUNT to #Prv_Amount
  move &SL.CURRENT_AMOUNT to #Current_Amount

    if RTRIM(&SL.STATE, ' ') <> RTRIM($PrvState , ' ')
       let #SearchSWTCount = 0
       while #SearchSWTCount <= #StateSWTCount
          get $State $SWT from STATESWT(#SearchSWTCount)
          if RTRIM(&SL.STATE,' ') = RTRIM($State,' ')
             let $SWTLine = RTRIM(&SL.STATE,' ')  || ' SWT   ' || $SWT
             print $SWTLine (+2,4)
             let $PrvState = $State
             break
           else
            add 1 to #SearchSWTCount
          end-if
       end-while
    end-if

    print 'Box' (+2,40)
    print &SL.BOX (,+1)
    if RTRIM(&SL.STATE, ' ') <> ''
       print &SL.STATE (,52)



       if RTRIM(&SL.BOX,' ') = '20'
       or RTRIM(&SL.BOX,' ') = '21'
          if  &SL.LOCALITY <> $PrvLocalPrintName
            let #SearchLocCount = 0
            while #SearchLocCount <=  #LocalPrintCount
             get $State $Locality $LocalName from LOCALPRINTNAME (#SearchLocCount)
             if RTRIM(&SL.STATE,' ') = RTRIM($State,' ')
             and RTRIM(&SL.LOCALITY,' ') = RTRIM($Locality,' ')
               print $LocalName (,61)
               let $PrvState = $State
               let $PrvLocalPrintName = $Locality
               break
             else
               add 1 to #SearchLocCount
             end-if
            end-while
         end-if
       end-if

    end-if

    let #SL_Diff = #Current_Amount - #Prv_Amount



    do Format-W2c-Number(#Prv_Amount, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#Current_Amount, $out, $F_T)
    print $out (,116)

    do Format-W2c-Number(#SL_Diff, $out, $F_T)
    print $out (,147) edit 9999999999.99ps


FROM PS_W2C_AMOUNTS  SL, PS_W2C_DATA WD
WHERE SL.W2C_BATCH_NBR = #W2c_Batch_Nbr
AND SL.COMPANY = &A.W2_REPORTING_CO
AND SL.BOX IN ('17','18','20','21')
AND SL.W2C_BATCH_NBR = WD.W2C_BATCH_NBR
AND SL.COMPANY = WD.COMPANY
AND SL.CALENDAR_YEAR = WD.CALENDAR_YEAR
AND SL.W2C_ADD_EMPLID = WD.W2C_ADD_EMPLID
AND SL.PRV_SSN = WD.PRV_SSN
AND WD.W2C_STATUS <> 'V'
GROUP BY SL.STATE,SL.BOX,SL.LOCALITY
ORDER BY SL.STATE,SL.BOX,SL.LOCALITY

end-SELECT
end-procedure


begin-procedure Init-W3c-Totals

  clear-array name = StateSWT
  clear-array name = LocalPrintName


  let #01_T =0
  let #Prv_01_T = 0
  let #02_T =0
  let #Prv_02_T = 0
  let #03_T =0
  let #Prv_03_T = 0
  let #04_T =0
  let #Prv_04_T = 0
  let #05_T =0
  let #Prv_05_T = 0
  let #06_T =0
  let #Prv_06_T = 0
  let #07_T =0
  let #Prv_07_T = 0
  let #08_T =0
  let #Prv_08_T = 0
  let #09_T =0
  let #Prv_09_T = 0
  let #10_T =0
  let #Prv_10_T = 0
  let #11AB_T =0
  let #Prv_11AB_T = 0
  let #12_T =0
  let #Prv_12_T = 0

  let #13A_T =0
  let #Prv_13A_T = 0
  let #13B_T =0
  let #Prv_13B_T = 0
  let #13C_T =0
  let #Prv_13C_T = 0
  let #13D_T =0
  let #Prv_13D_T = 0
  let #13E_T =0
  let #Prv_13E_T = 0
  let #13F_T =0
  let #Prv_13F_T = 0
  let #13G_T =0
  let #Prv_13G_T = 0
  let #13H_T =0
  let #Prv_13H_T = 0
  let #13J_T =0
  let #Prv_13J_T = 0
  let #13K_T =0
  let #Prv_13K_T = 0
  let #13L_T =0
  let #Prv_13L_T = 0
  let #13M_T =0
  let #Prv_13M_T = 0
  let #13N_T =0
  let #Prv_13N_T = 0
  let #13P_T =0
  let #Prv_13P_T = 0
  let #13Q_T =0
  let #Prv_13Q_T = 0
  let #13R_T =0
  let #Prv_13R_T = 0
  let #13S_T =0
  let #Prv_13S_T = 0
  let #13T_T =0
  let #Prv_13T_T = 0
  let #14A_T =0
  let #Prv_14A_T = 0
  let #14B_T =0
  let #Prv_14B_T = 0
  let #14C_T =0
  let #Prv_14C_T = 0
  let #14D_T =0
  let #Prv_14D_T = 0
  let #14E_T =0
  let #Prv_14E_T = 0
  let #14F_T =0
  let #Prv_14F_T = 0
  let #14G_T =0
  let #Prv_14G_T = 0
  let #14H_T =0
  let #Prv_14H_T = 0
  let #14I_T =0
  let #Prv_14I_T = 0
  let #14J_T =0
  let #Prv_14J_T = 0
  let #14K_T =0
  let #Prv_14K_T = 0
  let #14L_T =0
  let #Prv_14L_T = 0
  let #14M_T =0
  let #Prv_14M_T = 0
  let #14N_T =0
  let #Prv_14N_T = 0
  let #14O_T =0
  let #Prv_14O_T = 0
  let #14P_T =0
  let #Prv_14P_T = 0
  let #14Q_T =0
  let #Prv_14Q_T = 0
  let #14R_T =0
  let #Prv_14R_T = 0
  let #14S_T =0
  let #Prv_14S_T = 0
  let #14T_T =0
  let #Prv_14T_T = 0
  let #14U_T =0
  let #Prv_14U_T = 0
  let #14V_T =0
  let #Prv_14V_T = 0
  let #14W_T =0
  let #Prv_14W_T = 0
  let #14X_T =0
  let #Prv_14X_T = 0
  let #14Y_T =0
  let #Prv_14Y_T = 0
  let #14Z_T =0
  let #Prv_14Z_T = 0

end-procedure



begin-procedure Format-W2c-Number(#in, :$out, $mask)

  if #in <> 0
    move #in to $out :$mask
    let $out = translate($out,',.',$_Delimiters)
  else
      let $out = '          0'
  end-if


end-procedure


#Include 'curdttim.sqc'  !Get-Current-DateTime procedure
#Include 'datetime.sqc'  !Routines for date and time formatting
#Include 'number.sqc'    !Routines to format numbers

#Include 'stdapi.sqc'    !Update Process API
