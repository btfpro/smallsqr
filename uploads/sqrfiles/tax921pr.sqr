!***********************************************************************
!  TAX921PR:  Audit W-2cPR Batch- Puerto Rico                          *
!***********************************************************************
!***********************************************************************
!                                                                      *
!                                                                      *
!                                                                      *
! This software and related documentation are provided under a         *
! license agreement containing restrictions on use and                 *
! disclosure and are protected by intellectual property                *
! laws. Except as expressly permitted in your license agreement        *
! or allowed by law, you may not use, copy, reproduce,                 *
! translate, broadcast, modify, license, transmit, distribute,         *
! exhibit, perform, publish or display any part, in any form or        *
! by any means. Reverse engineering, disassembly, or                   *
! decompilation of this software, unless required by law for           *
! interoperability, is prohibited.                                     *
! The information contained herein is subject to change without        *
! notice and is not warranted to be error-free. If you find any        *
! errors, please report them to us in writing.                         *
!                                                                      *
!                                                                      *
! Copyright (C) 1988, 2012, Oracle and/or its affiliates.              *
! All Rights Reserved.                                                 *
!***********************************************************************
!                                                                      *
!          $Date:  2012/03/14:11:35:18                                 !
!       $Release:  HR9                                                 !
!    $Resolution:  872517                                              !
!                                                                      *
!***********************************************************************

#include 'setenv.sqc'   !Set environment
#include 'setup02.sqc'


begin-setup
!include 'setupdb.sqc'               ! Database specific setup


end-setup


begin-report

  do Init-Report
  do Stdapi-Term
end-report

begin-procedure Init-Report
  display ''
  display 'Printing W-2cPR Audit'

  date-time () hh:mi:ss &t1
  display &t1
  let $Taxform_ID = 'P'
  let $Program = 'W2c'
  move 'TAX921PR' to $ReportID
  move 'W-2cPR Audit Report- Puerto Rico' to $ReportTitle
  do Init-DateTime
  do Init-Number
  do Stdapi-Init
  do Initialization
  do Assign-Year-End-Variables
  do Read-Employee-Data

  if $EmployeeFound = 'N'
    display ' '
    display '****** No Employee Records Selected ******'
    display ' '
    new-page
    print '********************************'  (+3,1)
    print '  No Employee Records Selected  '  (+1,1)
    print '********************************'  (+1,1)
  else
    display ''
    display 'Upon successful conclusion of this program, '
    display 'one audit file will have been created that contains '
    display 'detail information on each employee and summary information '
    display 'for the W-3cPR totals report. '
    display ''
    display ''
  end-if

  date-time () hh:mi:ss &t2
  display &t2
end-procedure

begin-heading 8
  #Include 'stdhdg01.sqc'

  print 'W2 Rpt Company '              (3,1)
  print $A.W2_Reporting_Co             (0,+2)
  print $A.Descr                       (0,+2)
  let $TaxYear = 'Tax Year ' || $CalYear
  print $TaxYear                       (3,)    center
  print 'Audit Report ' (5,1)
  print 'Batch Number:' (,+5)
  print #W2c_Batch_Nbr  (,+2) edit B99999

  print 'Emplid' (+2,1)
  print 'Form W-2 Box' (,36)
  print 'State' (,51)
  print 'Locality' (,62)
  print 'Previous ' (,87)
  print 'Corrected ' (,119)
  print 'Increase/decrease ' (,146)
  print 'Name' (+1,1)
  print 'SSN' (+1,1)

end-heading

begin-procedure Initialization
  do Get-Current-DateTime
  move '1' to $MMLZero
  move '1' to $Year4
  do Format-DateTime($AsOfToday, $910Date, {DEFYMD},'','')

  move $910Date to $AsOfYear xxxx   !extract the current year
  move $AsOfYear  to #AsOfYear
  move #AsOfYear  to #saveAsOfYear
  subtract 1    from #AsOfYear

  do Init-Values
  do Get-W2C-Run-Controls

  let $AsOfDate = $CalYear || '1231'
  do Format-DateTime($AsOfDate, $AsOfDate, {DEFCMP}, '', 'native')


begin-SELECT
TEMP_SSN_MASK
FROM PS_INSTALLATION
end-SELECT

end-procedure

begin-procedure Read-Employee-Data

  move 'N' to $EmployeeFound

begin-SELECT
E.COMPANY          () ON-BREAK LEVEL=1 PRINT=NEVER BEFORE=BEFORE-COMPANY
                                                   AFTER=AFTER-COMPANY
E.W2C_ADD_EMPLID   () ON-BREAK LEVEL=2 PRINT=NEVER BEFORE=BEFORE-EMPLID
E.W2C_SSN
E.W2C_FNAME
E.W2C_MIDDLE_NAME
E.W2C_LNAME
E.W2C_SUFFIX
E.W2C_STATUS
E.ADDRESS1
E.ADDRESS2
E.CITY
E.STATE
E.POSTAL
E.COUNTRY
E.PRV_SSN
E.PRV_YE_FNAME
E.PRV_YE_MIDDLE_NAME
E.PRV_YE_LNAME
E.PRV_YE_SUFFIX
E.PRV_ADDRESS1
E.PRV_ADDRESS2
E.PRV_CITY
E.PRV_STATE
E.PRV_POSTAL
E.PRV_COUNTRY
E.W2C_BATCH_NBR
E.CALENDAR_YEAR
E.W2C_TAXFORM_ID
E.DESCRLONG

  move 'Y' to $EmployeeFound
  if &E.W2C_STATUS  <> 'V'
    do Load-Amounts
    do Add-To-Totals
    do Print-W2C
    add 1 to #W3c_Count
  else
    print  $E.EmplID  (+3,1)
    print  $E.W2_Name (+1,1)
    print '***** Voided W-2cPR ***** ' (,+9)
    print  $E.SSN (+1,1)
  end-if

FROM  PS_YE_W2CP_DATA E
WHERE E.W2C_BATCH_NBR    = #W2c_Batch_Nbr
AND E.W2C_TAXFORM_ID         = 'P'
ORDER BY E.COMPANY, E.W2C_SSN
end-SELECT

end-procedure

begin-procedure Before-Company

begin-SELECT
A.W2_REPORTING_CO
A.DESCR
A.FEDERAL_EIN
A.ADDRESS1
A.ADDRESS2
A.CITY
A.STATE
A.POSTAL
A.COUNTRY
A.TAXFORM_ID

  move &A.Federal_EIN     to $Federal_EIN 099999999
  move $Federal_EIN       to $A.Federal_EIN xx-xxxxxxx
  move &A.Descr           to $A.Descr
  move &A.Address1        to $A.Address1
  move &A.Address2        to $A.Address2
  move &A.Country         to $A.Country
  let  $A.City            =  RTRIM(&A.City,' ')
  let  $A.State           =  RTRIM(&A.State,' ')
  move &A.POSTAL          to $A.Postal
  move &A.W2_Reporting_Co to $A.W2_Reporting_Co


  UPPERCASE $A.Descr
  UPPERCASE $A.Address1
  UPPERCASE $A.Address2
  UPPERCASE $A.Country
  UPPERCASE $A.City

  move $A.Federal_EIN     to $W3c_EIN
  move $A.Descr           to $W3c_Descr
  move $A.Address1        to $W3c_Address1
  move $A.Address2        to $W3c_Address2
  if $A.Country = 'USA'
    move $A.Postal        to $ZipExtsn ~~~~~~xxxx
    if instr($A.Postal,'-',6) = 0
    and $ZipExtsn <> '    '
      let $A.Postal = substr($A.Postal,1,5) || '-' || substr($A.Postal,6,4)
    end-if
    let $W3c_Address3 = $A.City || ', ' || $A.State || ' ' || $A.Postal
  else
    let $W3c_Address3 = $A.City || ', ' || $A.State || ' ' ||
            $A.Country || ' ' || $A.Postal
  end-if

  move 0 to #W3c_Count

FROM  PS_W2_COMPANY A
WHERE A.COMPANY  = &E.COMPANY
  AND A.W2_REPORTING_CO <> ' '
  AND A.CALENDAR_YEAR = (SELECT MAX(CALENDAR_YEAR)
                         FROM PS_W2_COMPANY
                         WHERE A.COMPANY = COMPANY
                           AND A.TAXFORM_ID = TAXFORM_ID
                           AND CALENDAR_YEAR <= &E.CALENDAR_YEAR)
end-SELECT
end-procedure

begin-procedure After-Company

  do Print-W3c-Totals
  do Init-W3c-Totals
end-procedure

begin-procedure Before-EmplID
  !display 'processing ' noline
  !display &E.W2C_ADD_EMPLID

  move &E.W2C_ADD_EMPLID   to $E.EmplID

  move &E.W2C_SSN to $S123 xxx
  if $S123 = &Temp_SSN_Mask or RTRIM(&E.W2C_SSN, ' ') = ''
    move 'Applied For' to $E.SSN
  else
    move &E.W2C_SSN to $E.SSN xxx-xx-xxxx
  end-if

  move &E.PRV_SSN to $S123 xxx
  if $S123 = &Temp_SSN_Mask or RTRIM(&E.PRV_SSN, ' ') = ''
    move 'Applied For' to $E.Prv_SSN
  else
    move &E.PRV_SSN to $E.Prv_SSN xxx-xx-xxxx
  end-if

  let  $E.W2C_FNAME        =  RTRIM(&E.W2C_FNAME,' ')
  let  $E.W2C_MIDDLE_NAME  =  RTRIM(&E.W2C_MIDDLE_NAME ,' ')
  let  $E.W2C_LNAME        =  RTRIM(&E.W2C_LNAME ,' ')
  let  $E.W2C_SUFFIX       =  RTRIM(&E.W2C_SUFFIX ,' ')
  let  $E.W2_Name = $E.W2C_FNAME || ' ' || $E.W2C_MIDDLE_NAME || ' ' ||
       $E.W2C_LNAME || ' ' || $E.W2C_SUFFIX

  move &E.ADDRESS1        to $E.Address1
  move &E.ADDRESS2        to $E.Address2
  move &E.COUNTRY         to $E.Country
  let  $E.CITY            =  RTRIM(&E.City,' ')
  let  $E.STATE           =  RTRIM(&E.State,' ')
  move &E.POSTAL          to $E.Postal


  let  $E.PRV_YE_FNAME        =  RTRIM(&E.PRV_YE_FNAME,' ')
  let  $E.PRV_YE_MIDDLE_NAME  =  RTRIM(&E.PRV_YE_MIDDLE_NAME ,' ')
  let  $E.PRV_YE_LNAME        =  RTRIM(&E.PRV_YE_LNAME ,' ')
  let  $E.PRV_YE_SUFFIX       =  RTRIM(&E.PRV_YE_SUFFIX ,' ')
  let  $E.Prv_W2_Name         = $E.PRV_YE_FNAME || ' ' || $E.PRV_YE_MIDDLE_NAME || ' ' ||
       $E.PRV_YE_LNAME || ' ' || $E.PRV_YE_SUFFIX

  move &E.PRV_ADDRESS1        to $E.Prv_Address1
  move &E.PRV_ADDRESS2        to $E.Prv_Address2
  move &E.PRV_COUNTRY         to $E.Prv_Country
  let  $E.PRV_CITY            =  RTRIM(&E.Prv_City,' ')
  let  $E.PRV_STATE           =  RTRIM(&E.Prv_State,' ')
  move &E.PRV_POSTAL          to $E.Prv_Postal

  uppercase $E.W2_Name
  uppercase $E.Address1
  uppercase $E.Address2
  uppercase $E.Country
  uppercase $E.City

  uppercase $E.Prv_W2_Name
  uppercase $E.Prv_Address1
  uppercase $E.Prv_Address2
  uppercase $E.Prv_Country
  uppercase $E.Prv_City

end-procedure


begin-procedure Print-W2C

  do Print-EE-Data
  do Print-Amounts

  print &E.DESCRLONG (+2,40) WRAP 132 12

  do Init-Values

end-procedure


begin-procedure Init-Values
  move 0 to #Cost_Pension_Annuity
  move 0 to #Wages
  move 0 to #Reimbursed_Expense
  move 0 to #Tax_Withheld
  move 0 to #Retire_Fund
  move 0 to #CODA_Plans
  move 0 to #Sal_Act_No_324
  move 0 to #SS_Wages
  move 0 to #SS_Tax
  move 0 to #Med_Wages
  move 0 to #Med_Tax
  move 0 to #SS_Tips
  move 0 to #Tips
  move 0 to #Commissions
  move 0 to #Allowance
  move 0 to #Total_Comm_Allow_Tips
  move 0 to #TotalAbove
  move 0 to #Uncoll_SS_Tax_On_Tips
  move 0 to #Uncoll_Med_Tax_On_Tips
  move 0 to #Sal_Act_324
  move 0 to #HIRE_Act_Wages_Tips_PR
  move 0 to #ER_Health_Cost
  move 0 to #Charitable_Contrib
  move 0 to #Save_Money_Pgm

  move 0 to #Prv_Cost_Pension_Annuity
  move 0 to #Prv_Wages
  move 0 to #Prv_Reimbursed_Expense
  move 0 to #Prv_Tax_Withheld
  move 0 to #Prv_Retire_Fund
  move 0 to #Prv_CODA_Plans
  move 0 to #Prv_Sal_Act_No_324
  move 0 to #Prv_SS_Wages
  move 0 to #Prv_SS_Tax
  move 0 to #Prv_Med_Wages
  move 0 to #Prv_Med_Tax
  move 0 to #Prv_SS_Tips
  move 0 to #Prv_Tips
  move 0 to #Prv_Commissions
  move 0 to #Prv_Allowance
  move 0 to #Prv_Total_Comm_Allow_Tips
  move 0 to #Prv_TotalAbove
  move 0 to #Prv_Uncoll_SS_Tax_On_Tips
  move 0 to #Prv_Uncoll_Med_Tax_On_Tips
  move 0 to #Prv_Sal_Act_324
  move 0 to #Prv_HIRE_Wages_Tips
  move 0 to #Prv_ER_Health_Cost
  move 0 to #Prv_Charitable_Contrib
  move 0 to #Prv_Save_Money_Pgm

  let $Found_Wages       = 'N'
  let $Found_Commissions = 'N'
  let $Found_Allowance   = 'N'
  let $Found_Tips        = 'N'

end-procedure

begin-procedure Load-Amounts
begin-SELECT
D.STATE
D.LOCALITY
D.BOX
D.CURRENT_AMOUNT
D.PRV_AMOUNT

  move &D.CURRENT_AMOUNT to #Amount
  move &D.PRV_AMOUNT to #Prv_Amount
  if #Amount <> #Prv_Amount

    let $D.Box = RTRIM(&D.BOX,' ')
    do Evaluate-PR-Boxes
  end-if

FROM  PS_YE_W2CP_AMOUNTS D
WHERE D.W2C_BATCH_NBR   = &E.W2C_BATCH_NBR
AND   D.W2C_TAXFORM_ID  =  'P'
AND   D.COMPANY         = &E.COMPANY
AND   D.W2C_ADD_EMPLID  = &E.W2C_ADD_EMPLID
AND   D.CALENDAR_YEAR   = &E.CALENDAR_YEAR
ORDER BY D.STATE, D.LOCALITY, D.BOX
end-SELECT

end-procedure

begin-procedure Add-To-Totals

  add  #Cost_Pension_Annuity to #CPA_T
  add  #Prv_Cost_Pension_Annuity to #Prv_CPA_T
  add  #Wages to #Wages_T
  add  #Prv_Wages to #Prv_Wages_T
  add  #Wages to #Total_Comm_Allow_Tips_T               ! box 12 = 8 + 9 + 10 + 11
  add  #Prv_Wages to #Prv_Total_Comm_Allow_Tips_T       ! box 12 = 8 + 9 + 10 + 11
  add  #Commissions to #Commissions_T
  add  #Prv_Commissions to #Prv_Commissions_T
  add  #Commissions to #Total_Comm_Allow_Tips_T         ! box 12 = 8 + 9 + 10 + 11
  add  #Prv_Commissions to #Prv_Total_Comm_Allow_Tips_T ! box 12 = 8 + 9 + 10 + 11
  add  #Allowance to #Allowance_T
  add  #Prv_Allowance to #Prv_Allowance_T
  add  #Allowance to #Total_Comm_Allow_Tips_T         ! box 12 = 8 + 9 + 10 + 11
  add  #Prv_Allowance to #Prv_Total_Comm_Allow_Tips_T ! box 12 = 8 + 9 + 10 + 11
  add  #Tips to #Tips_T
  add  #Prv_Tips to #Prv_Tips_T
  add  #Tips to #Total_Comm_Allow_Tips_T         ! box 12 = 8 + 9 + 10 + 11
  add  #Prv_Tips to #Prv_Total_Comm_Allow_Tips_T ! box 12 = 8 + 9 + 10 + 11
  add  #Reimbursed_Expense to #Reimbursed_Expense_T
  add  #Prv_Reimbursed_Expense to #Prv_Reimbursed_Expense_T
  add  #Tax_Withheld to #Tax_Withheld_T
  add  #Prv_Tax_Withheld to #Prv_Tax_Withheld_T
  add  #Retire_Fund to #Retire_Fund_T
  add  #Prv_Retire_Fund to #Prv_Retire_Fund_T
  add  #CODA_Plans to #CODA_Plans_T
  add  #Prv_CODA_Plans to #Prv_CODA_Plans_T
  add  #Sal_Act_No_324 to #Sal_Act_No_324_T
  add  #Prv_Sal_Act_No_324 to #Prv_Sal_Act_No_324_T
  add  #HIRE_Act_Wages_Tips_PR to #HIRE_Act_Wages_Tips_PR_T
  add  #Prv_HIRE_Wages_Tips  to #Prv_Hire_Act_Wtips_T
  add  #ER_Health_Cost to #ER_Health_Cost_T
  add  #Prv_ER_Health_Cost  to #Prv_ER_Health_Cost_T
  add  #Charitable_Contrib to #Charitable_Contrib_T
  add  #Prv_Charitable_Contrib  to #Prv_Charitable_Contrib_T
  add  #Save_Money_Pgm to #Save_Money_Pgm_T
  add  #Prv_Save_Money_Pgm  to #Prv_Save_Money_Pgm_T
  add  #SS_Wages to #SS_Wages_T
  add  #Prv_SS_Wages to #Prv_SS_Wages_T
  add  #SS_Tax to #SS_Tax_T
  add  #Prv_SS_Tax to #Prv_SS_Tax_T
  add  #Med_Wages to #Med_Wages_T
  add  #Prv_Med_Wages to #Prv_Med_Wages_T
  add  #Med_Tax to #Med_Tax_T
  add  #Prv_Med_Tax to #Prv_Med_Tax_T
  add  #SS_Tips to #SS_Tips_T
  add  #Prv_SS_Tips to #Prv_SS_Tips_T
  add  #Uncoll_SS_Tax_On_Tips to #Uncoll_SS_Tax_On_Tips_T
  add  #Prv_Uncoll_SS_Tax_On_Tips to #Prv_Uncoll_SS_Tax_On_Tips_T
  add  #Uncoll_Med_Tax_On_Tips to #Uncoll_Med_Tax_On_Tips_T
  add  #Prv_Uncoll_Med_Tax_On_Tips to #Prv_Uncoll_Med_Tax_On_Tips_T

end-procedure

begin-procedure Print-Amounts

  let $F_W2c = 'B99999999.99'
  if  #Cost_Pension_Annuity  <>  #Prv_Cost_Pension_Annuity
    let #CPA_Diff =   #Cost_Pension_Annuity - #Prv_Cost_Pension_Annuity
    let $PrintBox = 'Box ' ||  $YE_Cost_Pension_Annuity
    print $PrintBox (+2,40)

    do Format-W2c-Number(#Prv_Cost_Pension_Annuity , $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#Cost_Pension_Annuity, $out, $F_W2c)
    print $out (,116)

    do Format-W2c-Number(#CPA_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps
  end-if

  if #Wages <> #Prv_Wages
    let $Found_Wages = 'Y'
    let #Wages_Diff = #Wages - #Prv_Wages
    let $PrintBox = 'Box ' || $YE_Wages
    print $PrintBox (+2,40)

    do Format-W2c-Number(#Prv_Wages, $out, $F_W2c)         !Wages
    print $out (,83)

    do Format-W2c-Number(#Wages, $out, $F_W2c)
    print $out (,116)

    do Format-W2c-Number(#Wages_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps
  end-if

  if #Commissions <> #Prv_Commissions
    let $Found_Commissions = 'Y'
    let #Commissions_Diff = #Commissions - #Prv_Commissions
    let $PrintBox = 'Box ' || $YE_Commissions
    print $PrintBox (+2,40)

    do Format-W2c-Number(#Prv_Commissions, $out, $F_W2c)        !Commissions
    print $out (,83)

    do Format-W2c-Number(#Commissions, $out, $F_W2c)
    print $out (,116)

    do Format-W2c-Number(#Commissions_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps
  end-if

  if #Allowance <> #Prv_Allowance
    let $Found_Allowance = 'Y'
    let #Allowance_Diff = #Allowance - #Prv_Allowance
    let $PrintBox = 'Box ' || $YE_Allowance
    print $PrintBox (+2,40)

    do Format-W2c-Number(#Prv_Allowance, $out, $F_W2c)        !Allowance
    print $out (,83)

    do Format-W2c-Number(#Allowance, $out, $F_W2c)
    print $out (,116)

    do Format-W2c-Number(#Allowance_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps
  end-if

  if #Tips <> #Prv_Tips
    let $Found_Tips = 'Y'
    let #Tips_Diff = #Tips - #Prv_Tips
    let $PrintBox = 'Box ' || $YE_Tips
    print $PrintBox (+2,40)

    do Format-W2c-Number(#Prv_Tips, $out, $F_W2c)        !Tips
    print $out (,83)

    do Format-W2c-Number(#Tips, $out, $F_W2c)
    print $out (,116)

    do Format-W2c-Number(#Tips_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps
  end-if

  if $Found_Wages       = 'Y'
  or $Found_Commissions = 'Y'
  or $Found_Allowance   = 'Y'
  or $Found_Tips        = 'Y'

     let #Total_Comm_Allow_Tips_Diff = #Total_Comm_Allow_Tips - #Prv_Total_Comm_Allow_Tips

     let $PrintBox = 'Box ' || $Comm_Allow_Tips_Total
     print $PrintBox (+2,40)

     do Format-W2c-Number(#Prv_Total_Comm_Allow_Tips, $out, $F_W2c)  !Totals
     print $out (,83)

     do Format-W2c-Number(#Total_Comm_Allow_Tips, $out, $F_W2c)
     print $out (,116)

     do Format-W2c-Number(#Total_Comm_Allow_Tips_Diff, $out, $F_W2c)
     print $out (,147) edit 99999999.99ps

  end-if

  if #Reimbursed_Expense <> #Prv_Reimbursed_Expense
    let #Reimbursed_Expense_Diff = #Reimbursed_Expense - #Prv_Reimbursed_Expense
    let $PrintBox = 'Box ' || $YE_Reimbursed_Expense
    print $PrintBox (+2,40)

    do Format-W2c-Number(#Prv_Reimbursed_Expense, $out, $F_W2c)        !Reimbursed_Expense
    print $out (,83)

    do Format-W2c-Number(#Reimbursed_Expense, $out, $F_W2c)
    print $out (,116)

    do Format-W2c-Number(#Reimbursed_Expense_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps
  end-if

  if #Tax_Withheld <> #Prv_Tax_Withheld
    let #Tax_Withheld_Diff = #Tax_Withheld - #Prv_Tax_Withheld
    let $PrintBox = 'Box ' || $YE_Tax_Withheld
    print $PrintBox (+2,40)

    do Format-W2c-Number(#Prv_Tax_Withheld, $out, $F_W2c)        !Tax withheld
    print $out (,83)

    do Format-W2c-Number(#Tax_Withheld, $out, $F_W2c)
    print $out (,116)

    do Format-W2c-Number(#Tax_Withheld_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #Retire_Fund <> #Prv_Retire_Fund
    let #Retire_Fund_Diff = #Retire_Fund - #Prv_Retire_Fund
    let $PrintBox = 'Box ' || $YE_Retire_Fund
    print $PrintBox (+2,40)

    do Format-W2c-Number(#Prv_Retire_Fund, $out, $F_W2c)        !Retire fund
    print $out (,83)

    do Format-W2c-Number(#Retire_Fund, $out, $F_W2c)
    print $out (,116)

    do Format-W2c-Number(#Retire_Fund_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #CODA_Plans <> #Prv_CODA_Plans
    let #CODA_Plans_Diff = #CODA_Plans - #Prv_CODA_Plans
    let $PrintBox = 'Box ' || $YE_CODA_Plans
    print $PrintBox (+2,40)

    do Format-W2c-Number(#Prv_CODA_Plans, $out, $F_W2c)        !CODA Plans
    print $out (,83)

    do Format-W2c-Number(#CODA_Plans, $out, $F_W2c)
    print $out (,116)

    do Format-W2c-Number(#CODA_Plans_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #Sal_Act_No_324 <> #Prv_Sal_Act_No_324
    let #Sal_Act_324_Diff = #Sal_Act_No_324 - #Prv_Sal_Act_No_324
    let $PrintBox = 'Box ' || $YE_Sal_Act_No_324
    print $PrintBox (+2,40)

    do Format-W2c-Number(#Prv_Sal_Act_No_324, $out, $F_W2c)        !CODA Plans
    print $out (,83)

    do Format-W2c-Number(#Sal_Act_No_324, $out, $F_W2c)
    print $out (,116)

    do Format-W2c-Number(#Sal_Act_324_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #SS_Wages <> #Prv_SS_Wages
    let #SS_Wages_Diff = #SS_Wages - #Prv_SS_Wages
    let $PrintBox = 'Box ' || $YE_SS_Wages
    print $PrintBox (+2,40)

    do Format-W2c-Number(#Prv_SS_Wages, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#SS_Wages, $out, $F_W2c)              !SS wages
    print $out (,116)

    do Format-W2c-Number(#SS_Wages_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #SS_Tax <> #Prv_SS_Tax
    let #SS_Tax_Diff = #SS_Tax - #Prv_SS_Tax
    let $PrintBox = 'Box ' || $YE_SS_Tax
    print $PrintBox (+2,40)

    do Format-W2c-Number(#Prv_SS_Tax, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#SS_Tax, $out, $F_W2c)              !SS Tax
    print $out (,116)

    do Format-W2c-Number(#SS_Tax_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #Med_Wages <> #Prv_Med_Wages
    let #Med_Wages_Diff = #Med_Wages - #Prv_Med_Wages
    let $PrintBox = 'Box ' || $YE_Med_Wages
    print $PrintBox (+2,40)

    do Format-W2c-Number(#Prv_Med_Wages, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#Med_Wages, $out, $F_W2c)              !Medicare wages
    print $out (,116)

    do Format-W2c-Number(#Med_Wages_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if


  if #Med_Tax <> #Prv_Med_Tax
    let #Med_Tax_Diff = #Med_Tax - #Prv_Med_Tax
    let $PrintBox = 'Box ' || $YE_Med_Tax
    print $PrintBox (+2,40)

    do Format-W2c-Number(#Prv_Med_Tax, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#Med_Tax, $out, $F_W2c)              !Medicare tax
    print $out (,116)

    do Format-W2c-Number(#Med_Tax_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #SS_Tips <> #Prv_SS_Tips
    let #SS_Tips_Diff = #SS_Tips - #Prv_SS_Tips
    let $PrintBox = 'Box ' || $YE_SS_Tips
    print $PrintBox (+2,40)

    do Format-W2c-Number(#Prv_SS_Tips, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#SS_Tips, $out, $F_W2c)           !SS tips
    print $out (,116)

    do Format-W2c-Number(#SS_Tips_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #Uncoll_SS_Tax_On_Tips <> #Prv_Uncoll_SS_Tax_On_Tips      !Uncoll SS tax on tips
    let #Uncoll_SS_Tax_On_Tips_Diff = #Uncoll_SS_Tax_On_Tips - #Prv_Uncoll_SS_Tax_On_Tips
    let $PrintBox = 'Box ' || $YE_SS_Tax_Tips
    print $PrintBox (+2,40)

    do Format-W2c-Number(#Prv_Uncoll_SS_Tax_On_Tips, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#Uncoll_SS_Tax_On_Tips, $out, $F_W2c)
    print $out (,116)

    do Format-W2c-Number(#Uncoll_SS_Tax_On_Tips_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #Uncoll_Med_Tax_On_Tips <> #Prv_Uncoll_Med_Tax_On_Tips
    let #Uncoll_Med_Tax_On_Tips_Diff = #Uncoll_Med_Tax_On_Tips - #Prv_Uncoll_Med_Tax_On_Tips
    let $PrintBox = 'Box ' || $YE_Med_Tax_Tips
    print $PrintBox (+2,40)

    do Format-W2c-Number(#Prv_Uncoll_Med_Tax_On_Tips, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#Uncoll_Med_Tax_On_Tips, $out, $F_W2c)             !Uncoll Medi tax on tips
    print $out (,116)

    do Format-W2c-Number(#Uncoll_Med_Tax_On_Tips_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #HIRE_Act_Wages_Tips_PR <> #Prv_HIRE_Wages_Tips
    let #Hire_Act_Wtips_Diff = #HIRE_Act_Wages_Tips_PR - #Prv_HIRE_Wages_Tips
    let $PrintBox = 'Box ' || $YE_HIRE_Act_Wages
    print $PrintBox (+2,40)

    do Format-W2c-Number(#Prv_HIRE_Wages_Tips, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#HIRE_Act_Wages_Tips_PR, $out, $F_W2c)
    print $out (,116)

    do Format-W2c-Number(#Hire_Act_Wtips_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #ER_Health_Cost <> #Prv_ER_Health_Cost
    let #ER_Health_Cost_Diff = #ER_Health_Cost - #Prv_ER_Health_Cost
    let $PrintBox = 'Box ' || $YE_ER_Health_Cost
    print $PrintBox (+2,40)

    do Format-W2c-Number(#Prv_ER_Health_Cost, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#ER_Health_Cost, $out, $F_W2c)
    print $out (,116)

    do Format-W2c-Number(#ER_Health_Cost_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #Charitable_Contrib <> #Prv_Charitable_Contrib
    let #Charitable_Contrib_Diff = #Charitable_Contrib - #Prv_Charitable_Contrib
    let $PrintBox = 'Box ' || $YE_Charitable_Contrib
    print $PrintBox (+2,40)

    do Format-W2c-Number(#Prv_Charitable_Contrib, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#Charitable_Contrib, $out, $F_W2c)
    print $out (,116)

    do Format-W2c-Number(#Charitable_Contrib_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

  if #Save_Money_Pgm <> #Prv_Save_Money_Pgm
    let #Save_Money_Pgm_Diff = #Save_Money_Pgm - #Prv_Save_Money_Pgm
    let $PrintBox = 'Box ' || $YE_Save_Money_Pgm
    print $PrintBox (+2,40)

    do Format-W2c-Number(#Prv_Save_Money_Pgm, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#Save_Money_Pgm, $out, $F_W2c)
    print $out (,116)

    do Format-W2c-Number(#Save_Money_Pgm_Diff, $out, $F_W2c)
    print $out (,147) edit 99999999.99ps

  end-if

end-procedure


begin-procedure Print-EE-Data

  print  $E.EmplID  (+3,1)
  print  $E.W2_Name (+1,1)

  if ($E.W2C_FNAME <> $E.PRV_YE_FNAME)
  or ($E.W2C_MIDDLE_NAME <> $E.PRV_YE_MIDDLE_NAME)
  or ($E.W2C_LNAME <> $E.PRV_YE_LNAME)
  or ($E.W2C_SUFFIX <> $E.PRV_YE_SUFFIX)
    print  $E.Prv_W2_Name (,79)
    print  $E.W2_Name (,113)
  end-if


  print  $E.SSN (+1,1)
  if ($E.SSN <> $E.Prv_SSN)
    print  $E.Prv_SSN (,85)
    print  $E.SSN (,119
  end-if

end-procedure

begin-procedure Get-W2C-Run-Controls

begin-SELECT

W2C.W2C_RECENT_BATCH
W2C.W2C_BATCH_NBR

FROM  PS_RC_TAX921PR   W2C
WHERE W2C.OPRID            = $Prcs_OprID
AND   W2C.RUN_CNTL_ID      = $Prcs_Run_Cntl_ID

end-SELECT


  do Get-W2C-Parameters
  if &W2C.W2C_RECENT_BATCH  = 'Y'
    do Get-Most-Recent-Batch
  else
    move &W2C.W2C_BATCH_NBR to #W2c_Batch_Nbr
  end-if

  do Get-Tax-Year

end-procedure


begin-procedure Get-Most-Recent-Batch
begin-SELECT

COUNT(*)   &W2cCount

FROM PS_YE_W2CP_DATA CT
WHERE CT.W2C_BATCH_NBR = &W2C_INSTALL.W2C_BATCH_NBR

end-SELECT

if &W2cCount > 0
    let #W2c_Batch_Nbr = &W2C_INSTALL.W2C_BATCH_NBR
else
    let #W2c_Batch_Nbr = &W2C_INSTALL.W2C_BATCH_NBR  - 1
end-if
end-procedure

begin-procedure Get-W2C-Parameters

begin-SELECT
W2C_INSTALL.W2C_BATCH_NBR
W2C_INSTALL.W2C_BATCH_YR


FROM  PS_YE_W2C_INSTALL W2C_INSTALL
WHERE W2C_TAXFORM_ID =  'P'

end-SELECT


move &W2C_INSTALL.W2C_BATCH_NBR to #W2c_Batch_Nbr

end-procedure

begin-procedure Get-Tax-Year
begin-SELECT DISTINCT
CALENDAR_YEAR

FROM  PS_YE_W2CP_DATA
WHERE  W2C_BATCH_NBR = #W2c_Batch_Nbr
  AND  W2C_TAXFORM_ID = $Taxform_ID

end-SELECT

move &CALENDAR_YEAR to $CalYear
move &CALENDAR_YEAR to #W2C_Batch_Yr
end-procedure

begin-procedure Print-W3c-Totals
  new-page
  print 'W-3cPR Totals ' (+4,1)
  print $W3c_Descr (+2,1)
  print $W3c_Address1 (+1,1)
  if RTRIM($W3c_Address2 , ' ') <> ''
    print $W3c_Address2 (+1,1)
  end-if
   print $W3c_Address3 (+1,1)


  print 'Number of Forms W-2cPR ' (+2,1)
  print #W3c_Count (,+5)  edit B9999

  print 'Employer Federal EIN  ' (+2,1)
  print $W3c_EIN (,+5)


  let $F_T = 'B99999999.99'

  if #CPA_T <> #Prv_CPA_T
    let $PrintBox = 'Box ' || $YE_Cost_Pension_Annuity
    print $PrintBox (+2,40)
    let #CPA_Diff_T = #CPA_T - #Prv_CPA_T

    do Format-W2c-Number(#Prv_CPA_T  , $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#CPA_T , $out, $F_T)
    print $out (,116)

    do Format-W2c-Number(#CPA_Diff_T , $out, $F_T)
    print $out (,147) edit 9999999999.99ps
  end-if

  if #Wages_T <> #Prv_Wages_T
    let $PrintBox = 'Box ' || $YE_Wages
    print $PrintBox (+2,40)
    let #Wages_Diff_T = #Wages_T - #Prv_Wages_T

    do Format-W2c-Number(#Prv_Wages_T , $out, $F_T)         !Wages
    print $out (,83)

    do Format-W2c-Number(#Wages_T , $out, $F_T)
    print $out (,116)

    do Format-W2c-Number(#Wages_Diff_T , $out, $F_T)
    print $out (,147) edit 9999999999.99ps
  end-if

  if #Commissions_T <> #Prv_Commissions_T
    let $PrintBox = 'Box ' || $YE_Commissions
    print $PrintBox (+2,40)
    let #Commissions_Diff_T = #Commissions_T - #Prv_Commissions_T

    do Format-W2c-Number(#Prv_Commissions_T , $out, $F_T)         !Commissions
    print $out (,83)

    do Format-W2c-Number(#Commissions_T , $out, $F_T)
    print $out (,116)

    do Format-W2c-Number(#Commissions_Diff_T , $out, $F_T)
    print $out (,147) edit 9999999999.99ps
  end-if

  if #Allowance_T <> #Prv_Allowance_T
    let $PrintBox = 'Box ' || $YE_Allowance
    print $PrintBox (+2,40)
    let #Allowance_Diff_T = #Allowance_T - #Prv_Allowance_T

    do Format-W2c-Number(#Prv_Allowance_T , $out, $F_T)         !Allowance
    print $out (,83)

    do Format-W2c-Number(#Allowance_T , $out, $F_T)
    print $out (,116)

    do Format-W2c-Number(#Allowance_Diff_T , $out, $F_T)
    print $out (,147) edit 9999999999.99ps
  end-if

  if #Tips_T <> #Prv_Tips_T
    let $PrintBox = 'Box ' || $YE_Tips
    print $PrintBox (+2,40)
    let #Tips_Diff_T = #Tips_T - #Prv_Tips_T

    do Format-W2c-Number(#Prv_Tips_T , $out, $F_T)         !Tips
    print $out (,83)

    do Format-W2c-Number(#Tips_T , $out, $F_T)
    print $out (,116)

    do Format-W2c-Number(#Tips_Diff_T , $out, $F_T)
    print $out (,147) edit 9999999999.99ps
  end-if

  if #Wages_T <> #Prv_Wages_T
  or #Commissions_T <> #Prv_Commissions_T
  or #Allowance_T <> #Prv_Allowance_T
  or #Tips_T <> #Prv_Tips_T

    let $PrintBox = 'Box ' || $Comm_Allow_Tips_Total
    print $PrintBox (+2,40)
    let #Total_Comm_Allow_Tips_Diff_T = #Total_Comm_Allow_Tips_T - #Prv_Total_Comm_Allow_Tips_T

    do Format-W2c-Number(#Prv_Total_Comm_Allow_Tips_T, $out, $F_T)         !Totals
    print $out (,83)

    do Format-W2c-Number(#Total_Comm_Allow_Tips_T, $out, $F_T)
    print $out (,116)

    do Format-W2c-Number(#Total_Comm_Allow_Tips_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps
  end-if

  if #Reimbursed_Expense_T <> #Prv_Reimbursed_Expense_T
    let $PrintBox = 'Box ' || $YE_Reimbursed_Expense
    print $PrintBox (+2,40)
    let #Reimbursed_Expense_Diff_T = #Reimbursed_Expense_T - #Prv_Reimbursed_Expense_T

    do Format-W2c-Number(#Prv_Reimbursed_Expense_T , $out, $F_T)         !Reimbursed_Expense
    print $out (,83)

    do Format-W2c-Number(#Reimbursed_Expense_T , $out, $F_T)
    print $out (,116)

    do Format-W2c-Number(#Reimbursed_Expense_Diff_T , $out, $F_T)
    print $out (,147) edit 9999999999.99ps
  end-if

  if #Tax_Withheld_T  <> #Prv_Tax_Withheld_T
    let $PrintBox = 'Box ' || $YE_Tax_Withheld
    print $PrintBox (+2,40)
    let #Tax_Withheld_Diff_T  = #Tax_Withheld_T  - #Prv_Tax_Withheld_T

    do Format-W2c-Number(#Prv_Tax_Withheld_T , $out, $F_T)        !Federal tax
    print $out (,83)

    do Format-W2c-Number(#Tax_Withheld_T , $out, $F_T)
    print $out (,116)

    do Format-W2c-Number(#Tax_Withheld_Diff_T , $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #Retire_Fund_T  <> #Prv_Retire_Fund_T
    let $PrintBox = 'Box ' || $YE_Retire_Fund
    print $PrintBox (+2,40)
    let #Retire_Fund_Diff_T  = #Retire_Fund_T  - #Prv_Retire_Fund_T

    do Format-W2c-Number(#Prv_Retire_Fund_T , $out, $F_T)        !Retire fund
    print $out (,83)

    do Format-W2c-Number(#Retire_Fund_T , $out, $F_T)
    print $out (,116)

    do Format-W2c-Number(#Retire_Fund_Diff_T , $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #CODA_Plans_T  <> #Prv_CODA_Plans_T
    let $PrintBox = 'Box ' || $YE_CODA_Plans
    print $PrintBox (+2,40)
    let #CODA_Plans_Diff_T  = #CODA_Plans_T  - #Prv_CODA_Plans_T

    do Format-W2c-Number(#Prv_CODA_Plans_T , $out, $F_T)        !CODA Plans
    print $out (,83)

    do Format-W2c-Number(#CODA_Plans_T , $out, $F_T)
    print $out (,116)

    do Format-W2c-Number(#CODA_Plans_Diff_T , $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #Sal_Act_No_324_T  <> #Prv_Sal_Act_No_324_T
    let $PrintBox = 'Box ' || $YE_Sal_Act_No_324
    print $PrintBox (+2,40)
    let #Sal_Act_No_324_Diff_T  = #Sal_Act_No_324_T  - #Prv_Sal_Act_No_324_T

    do Format-W2c-Number(#Prv_Sal_Act_No_324_T , $out, $F_T)        !Salaries paid under Act No. 324
    print $out (,83)

    do Format-W2c-Number(#Sal_Act_No_324_T , $out, $F_T)
    print $out (,116)

    do Format-W2c-Number(#Sal_Act_No_324_Diff_T , $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #SS_Wages_T  <> #Prv_SS_Wages_T
    let $PrintBox = 'Box ' || $YE_SS_Wages
    print $PrintBox (+2,40)
    let #SS_Wages_Diff_T  = #SS_Wages_T  - #Prv_SS_Wages_T

    do Format-W2c-Number(#Prv_SS_Wages_T , $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#SS_Wages_T , $out, $F_T)              !SS wages
    print $out (,116)

    do Format-W2c-Number(#SS_Wages_Diff_T , $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #SS_Tax_T <> #Prv_SS_Tax_T
    let $PrintBox = 'Box ' || $YE_SS_Tax
    print $PrintBox (+2,40)
    let #SS_Tax_Diff_T  = #SS_Tax_T  - #Prv_SS_Tax_T

    do Format-W2c-Number(#Prv_SS_Tax_T , $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#SS_Tax_T , $out, $F_T)              !SS Tax
    print $out (,116)

    do Format-W2c-Number(#SS_Tax_Diff_T , $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #Med_Wages_T <> #Prv_Med_Wages_T
    let $PrintBox = 'Box ' || $YE_Med_Wages
    print $PrintBox (+2,40)
    let #Med_Wages_Diff_T = #Med_Wages_T - #Prv_Med_Wages_T

    do Format-W2c-Number(#Prv_Med_Wages_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#Med_Wages_T, $out, $F_T)              !Medicare wages
    print $out (,116)

    do Format-W2c-Number(#Med_Wages_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if


  if #Med_Tax_T <> #Prv_Med_Tax_T
    let $PrintBox = 'Box ' || $YE_Med_Tax
    print $PrintBox (+2,40)
    let #Med_Tax_Diff_T = #Med_Tax_T - #Prv_Med_Tax_T

    do Format-W2c-Number(#Prv_Med_Tax_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#Med_Tax_T, $out, $F_T)              !Medicare tax
    print $out (,116)

    do Format-W2c-Number(#Med_Tax_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #SS_Tips_T <> #Prv_SS_Tips_T
    let $PrintBox = 'Box ' || $YE_SS_Tips
    print $PrintBox (+2,40)
    let #SS_Tips_Diff_T = #SS_Tips_T - #Prv_SS_Tips_T


    do Format-W2c-Number(#Prv_SS_Tips_T, $out, $F_T)
    print $out (,83)


    do Format-W2c-Number(#SS_Tips_T, $out, $F_T)           !SS tips
    print $out (,116)

    do Format-W2c-Number(#SS_Tips_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #Uncoll_SS_Tax_On_Tips_T <> #Prv_Uncoll_SS_Tax_On_Tips_T
    let $PrintBox = 'Box ' || $YE_SS_Tax_Tips
    print $PrintBox (+2,40)
    let #Uncoll_SS_Tax_On_Tips_Diff_T = #Uncoll_SS_Tax_On_Tips_T
                                      - #Prv_Uncoll_SS_Tax_On_Tips_T

    do Format-W2c-Number(#Prv_Uncoll_SS_Tax_On_Tips_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#Uncoll_SS_Tax_On_Tips_T, $out, $F_T)
    print $out (,116)

    do Format-W2c-Number(#Uncoll_SS_Tax_On_Tips_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #Uncoll_Med_Tax_On_Tips_T <> #Prv_Uncoll_Med_Tax_On_Tips_T
    let $PrintBox = 'Box ' || $YE_Med_Tax_Tips
    print $PrintBox (+2,40)
    let #Uncoll_Med_Tax_On_Tips_Diff_T = #Uncoll_Med_Tax_On_Tips_T - #Prv_Uncoll_Med_Tax_On_Tips_T

    do Format-W2c-Number(#Prv_Uncoll_Med_Tax_On_Tips_T, $out, $F_T)
    print $out (,83)

    do Format-W2c-Number(#Uncoll_Med_Tax_On_Tips_T, $out, $F_T)              !
    print $out (,116)

    do Format-W2c-Number(#Uncoll_Med_Tax_On_Tips_Diff_T, $out, $F_T)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #HIRE_Act_Wages_Tips_PR_T <> #Prv_Hire_Act_Wtips_T
    let #Hire_Act_Wtips_Diff_T = #HIRE_Act_Wages_Tips_PR_T - #Prv_Hire_Act_Wtips_T
    let $PrintBox = 'Box ' || $YE_HIRE_Act_Wages
    print $PrintBox (+2,40)

    do Format-W2c-Number(#Prv_Hire_Act_Wtips_T, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#HIRE_Act_Wages_Tips_PR_T, $out, $F_W2c)
    print $out (,116)

    do Format-W2c-Number(#Hire_Act_Wtips_Diff_T, $out, $F_W2c)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #ER_Health_Cost_T <> #Prv_ER_Health_Cost_T
    let #ER_Health_Cost_Diff_T = #ER_Health_Cost_T - #Prv_ER_Health_Cost_T
    let $PrintBox = 'Box ' || $YE_ER_Health_Cost
    print $PrintBox (+2,40)

    do Format-W2c-Number(#Prv_ER_Health_Cost_T, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#ER_Health_Cost_T, $out, $F_W2c)
    print $out (,116)

    do Format-W2c-Number(#ER_Health_Cost_Diff_T, $out, $F_W2c)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #Charitable_Contrib_T <> #Prv_Charitable_Contrib_T
    let #Charitable_Contrib_Diff_T = #Charitable_Contrib_T - #Prv_Charitable_Contrib_T
    let $PrintBox = 'Box ' || $YE_Charitable_Contrib
    print $PrintBox (+2,40)

    do Format-W2c-Number(#Prv_Charitable_Contrib_T, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#Charitable_Contrib_T, $out, $F_W2c)
    print $out (,116)

    do Format-W2c-Number(#Charitable_Contrib_Diff_T, $out, $F_W2c)
    print $out (,147) edit 9999999999.99ps

  end-if

  if #Save_Money_Pgm_T <> #Prv_Save_Money_Pgm_T
    let #Save_Money_Pgm_Diff_T = #Save_Money_Pgm_T - #Prv_Save_Money_Pgm_T
    let $PrintBox = 'Box ' || $YE_Save_Money_Pgm
    print $PrintBox (+2,40)

    do Format-W2c-Number(#Prv_Save_Money_Pgm_T, $out, $F_W2c)
    print $out (,83)

    do Format-W2c-Number(#Save_Money_Pgm_T, $out, $F_W2c)
    print $out (,116)

    do Format-W2c-Number(#Save_Money_Pgm_Diff_T, $out, $F_W2c)
    print $out (,147) edit 9999999999.99ps

  end-if

   new-page

end-procedure

begin-procedure Init-W3c-Totals

  let #CPA_T = 0
  let #Prv_CPA_T = 0
  let #Wages_T =0
  let #Prv_Wages_T = 0
  let #Commissions_T =0
  let #Prv_Commissions_T = 0
  let #Allowance_T =0
  let #Prv_Allowance_T = 0
  let #Tips_T =0
  let #Prv_Tips_T = 0
  let #Total_Comm_Allow_Tips_T =0
  let #Prv_Total_Comm_Allow_Tips_T = 0
  let #Reimbursed_Expense_T =0
  let #Prv_Reimbursed_Expense_T = 0
  let #Tax_Withheld_T =0
  let #Prv_Tax_Withheld_T = 0
  let #Retire_Fund_T =0
  let #Prv_Retire_Fund_T = 0
  let #CODA_Plans_T =0
  let #Prv_CODA_Plans_T = 0
  let #Sal_Act_No_324_T = 0
  let #Prv_Sal_Act_No_324_T = 0
  let #SS_Wages_T =0
  let #Prv_SS_Wages_T = 0
  let #SS_Tax_T =0
  let #Prv_SS_Tax_T = 0
  let #Med_Wages_T =0
  let #Prv_Med_Wages_T = 0
  let #Med_Tax_T =0
  let #Prv_Med_Tax_T = 0
  let #SS_Tips_T =0
  let #Prv_SS_Tips_T = 0
  let #Uncoll_SS_Tax_On_Tips_T =0
  let #Prv_Uncoll_SS_Tax_On_Tips_T = 0
  let #Uncoll_Med_Tax_On_Tips_T =0
  let #Prv_Uncoll_Med_Tax_On_Tips_T = 0
  let #HIRE_Act_Wages_Tips_PR_T = 0
  let #Prv_Hire_Act_Wtips_T = 0
  let #ER_Health_Cost_T = 0
  let #Prv_ER_Health_Cost_T = 0
  let #Charitable_Contrib_T = 0
  let #Prv_Charitable_Contrib_T = 0
  let #Save_Money_Pgm_T = 0
  let #Prv_Save_Money_Pgm_T = 0

end-procedure

begin-procedure Format-W2c-Number(#in, :$out, $mask)

  if #in <> 0
    move #in to $out :$mask
    let $out = translate($out,',.',$_Delimiters)
  else
      let $out = '          0'
  end-if

end-procedure


#Include 'curdttim.sqc'  !Get-Current-DateTime procedure
#Include 'datetime.sqc'    !Routines for date and time formatting
#Include 'number.sqc'      !Routines to format numbers
#Include 'w2c.sqc'         !Common Box Descriptions
#Include 'stdapi.sqc'      !Update Process API
#Include 'w2prbox.sqc'     !Evaluate-PR-Boxes
