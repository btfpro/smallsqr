!***********************************************************************
!  GEXPY067:  Overtime Report                                          *
!***********************************************************************
!                                                                      *
!               Confidentiality Information:                           *
!                                                                      *
! This module is the confidential and proprietary information of       *
! Giant Eagle, Inc.; it is not to be copied, reproduced, or transmitted*
! in any form, by any means, in whole or in part, nor is it to be used *
! for any purpose other than that for which it is expressly provided   *
! without the written permission of Giant Eagle.                       * 
!                                                                      *
!***********************************************************************
!                                                                      *
! GEXPY067:  		Overtime Report                                *
!                                                                      *
! Narrative:    		Produce a detail report of current pay period  *
!                       and ytd overtime, Sunday hours and overtime    *
!                       earnings                                       *
!                                                                      *
! #Debugx Used: 		#debug9 paragraph trace                        *
!                       #debug8 key variable values                    *
!                       #debug7 data returned from sql calls           *
!                                                                      *
! SQL Tables:   		PS_JOB                                         *
!               		PS_EMPLOYMENT                                  *
!               		PS_PAY_CHECK                                   *
!               		PS_GEX_DEPT_TBL                                *
!                       PS_PAY_EARNINGS                                *
!                       PS_PAY_OTH_EARNS                               *
!                       PS_EARNINGS_BAL                                *
!                                                                      *
! Written by:   		Gene Davis   08/12/1998                        *
!                                                                      *
! Control Parms:        FOR WHERE CLAUSE:                              *
!				  Company Division Code                        *
!				  Company  	                                   *
!				  Paygroup  	                             *
!				  Deptid	                                   *
!				  Employee Status	                             *
!				  Account Code                                 *
!                         AsOfDate                                     *
!                                                                      *
!***********************************************************************
!                         MODIFICATION HISTORY                         *
!***********************************************************************
! ID#        INITIALS   DATE        DESCRIPTION OF THE CHANGE          *
!***********************************************************************
! GEXPY067   GXD        08/12/98    Initial Creation                   *
!            SXK        09/22/98    Added New Mobius ReportID          *
!            SXK        01/26/99    modified to adjust page breaks     *
!			            and grouping by hire date ranges   *
!            SXK        10/28/1999  Modified to have union from        *
!					job labor                      *
!            PSR        08/06/2002  Modified to get UNION_CD FROM JOB  *
!                                   - Upgrade 8.3                      * 
!            PSR        08/27/2002  EMPL_RCD is now part of the key for*
!                                   PS_EARNINGS_BAL - Upgrade 8.3      *
!                                                                      *
!GEX_PY253   SXD        08/23/2007  no changes made to sqr.            *
! GEX ISDVNPK 03/25/2008 for rehire dt issue in 9.0
! GEX-TLL               07/08/2008  Added Erncd= 173	               *
!GEX_SEC_REENG 09/16/2016 Vahini Katta Begins
!PT852         10/24/2016       Ujwal Dyasani                          *
!***********************************************************************

!selection criteria
#define #x000_col_selection_criteria_a  02
#define #x000_col_selection_criteria_b  05

!line 1
#define #x000_col_acctcd        01      
#define #x000_col_acct_descr    08
#define #x000_col_jobcode       16
#define #x000_col_ssn           24
#define #x000_col_name          36
#define #x000_col_hire_date     56
#define #x000_col_type          65
#define #x000_col_overtime      80
#define #x000_col_173	        92   !GEX-TLL 07/08/2008
#define #x000_col_sun_straight  103	!92      
#define #x000_col_sun_overtime 	115	!103
#define #x000_col_sun_premium  	127	!115


#Include 'setenv.sqc'
!#Include 'setup02.sqc'

!***********************************************************************
begin-setup

!#Include 'setup32a.sqc'         !landscape PSR 08/08/02 8 Upgrade
#Include 'ptpsl177.sqc'

declare-report OT-Report
Printer-Type=HPLASERJET
   layout=DEFAULT
end-declare

declare-report OT-Summary
Printer-Type=HPLASERJET
   layout=DEFAULT
end-declare

end-setup

!***********************************************************************
begin-heading 8 for-reports=(OT-Report)
!***********************************************************************
#debug9 show 'begin-heading'

 let $ReportTitle = 'OverTime Report - Detail'
LET $REPORTID = 'PY067OTD'
 #Include 'stdhdg01.sqc'

 print 'Deptid:     '                     (,1)
 print $prev_Deptid                              ()
 move $deptid to $hold_deptid
 move $prev_deptid to $deptid
 let $DeptID   = rtrim($Deptid,' ')
 do Get-Department-Name
 move $hold_deptid to $deptid
 print $DeptName                        (0,18)

 let $x000_temp_out =  'As of ' || $X000_REPORT_HEADING_ASOFDATE 
 print $x000_temp_out                       () center 
 
 print 'Union Cd:   '                   (+1,1)
 print $prev_UnionCd                             ()
 move $unioncd to $hold_union
 move $prev_unioncd to $unioncd
 let $UnionCd = rtrim($UnionCd,' ')
 do Get-Union-Name
 move $hold_union to $unioncd
 print $UnionName                       (0,18)

 let $x000_temp_out =  'Sorted by ' || $X000_ORDER_BY  
! print $x000_temp_out                   (0,) center 

 print 'ACCT'                   (+2,{#x000_col_acctcd})
 !Print '173   '		      (0,{#x000_col_173})	!GEX-TLL 07/08/2008 Added
 !PT852 - Added - Ujwal - Begin 
 print 'EMPLOYEE'                         (0,{#x000_col_ssn})
 !PT852 - Added - Ujwal - End
 print 'SUNDAY'            (0,{#x000_col_sun_straight})
 print 'SUNDAY'             (0,{#x000_col_sun_overtime})
 print 'SUNDAY'              (0,{#x000_col_sun_premium})
 

 print 'CODE'                   (+1,{#x000_col_acctcd})
 print 'DESC'                 (0,{#x000_col_acct_descr})
 print 'JOBCODE'                 (0,{#x000_col_jobcode})
 !PT852 - Commented - Ujwal - Begin
 !print 'SSN'                         (0,{#x000_col_ssn})
 !PT852 - Commented - Ujwal - End
 !PT852 - Added - Ujwal - Begin
 print 'ID'                         (0,{#x000_col_ssn})
 !PT852 - Added - Ujwal - End
 print 'NAME'                       (0,{#x000_col_name})
 print 'HIRE DT'               (0,{#x000_col_hire_date})
 print 'OVERTIME'               (0,{#x000_col_overtime})
 print 'UOT Earns'                (0,{#x000_col_173})	 !GEX-TLL 07/08/2008 Added
 print 'STRAIGHT'           (0,{#x000_col_sun_straight})
 print 'OVERTIME'           (0,{#x000_col_sun_overtime})
 print 'PREMIUM'             (0,{#x000_col_sun_premium})
 

end-heading

!***********************************************************************
begin-heading 8 for-reports=(OT-Summary)

 let $ReportTitle = 'OverTime Report - Summary'
LET $REPORTID = 'PY067OTS'
 #Include 'stdhdg01.sqc'

 print 'Deptid:     '                     (,1)
 print $prev_Deptid                              ()
 move $deptid to $hold_deptid
 move $prev_deptid to $deptid
 do get-department-name
 move $hold_deptid to $deptid
 print $DeptName                        (0,18)

 let $x000_temp_out =  'As of ' || $X000_REPORT_HEADING_ASOFDATE 
 print $x000_temp_out                       () center 
 
 print 'Union Cd:   '                   (+1,1)
 print $Prev_UnionCd                             ()
 move $unioncd to $hold_union
 move $prev_unioncd to $unioncd
 do get-union-name
 move $hold_union to $unioncd
 print $UnionName                       (0,18)

 let $x000_temp_out =  'Sorted by ' || $X000_ORDER_BY  
! print $x000_temp_out                   (0,) center 

 print 'ACCT'                   (+2,{#x000_col_acctcd})
 !print '173'              (0,{#x000_col_173})  	!GEX-TLL 07/08/2008 
 print 'SUNDAY'            (0,{#x000_col_sun_straight})
 print 'SUNDAY'             (0,{#x000_col_sun_overtime})
 print 'SUNDAY'              (0,{#x000_col_sun_premium})
 

 print 'CODE'                   (+1,{#x000_col_acctcd})
 print 'DESC'                 (0,{#x000_col_acct_descr})
 print 'OVERTIME'               (0,{#x000_col_overtime})
 print 'UOT Earns'             (0,{#x000_col_173})	!GEX-TLL 07/08/2008 
 print 'STRAIGHT'           (0,{#x000_col_sun_straight})
 print 'OVERTIME'           (0,{#x000_col_sun_overtime})
 print 'PREMIUM'             (0,{#x000_col_sun_premium})
 
 
end-heading

!***********************************************************************
begin-report
!***********************************************************************
#debug9 show 'begin-report'
  !do Alter-Session    !SXD  08/21/2007 
  do Init-DateTime
  do Init-Number
  do Get-Current-DateTime
  show '$asoftoday=' $asoftoday 

  do Get-Calendar-Year-Id
  show '$Calendar_Year_Id=' $Calendar_Year_Id
  do StdAPI-Init
  do P010-Init-Variables
  do P200-Get-Job-Data
  do StdAPI-Term
  do Reset
  show 'Successful End of Report'

end-report

!***********************************************************************
begin-procedure P010-Init-Variables
!***********************************************************************
display 'P010-Init-Variables'

  let $x000_new_page_flag = 'N'

  let $ReportID    = 'GEXPY067'

  let $Country     = 'USA'
  let $ReportTitle = 'Overtime Report'

  show '$ReportID=' $ReportID 
  show '$ReportTitle=' $ReportTitle
  show '$ReportDate=' $ReportDate
  show '$ReportTime=' $ReportTime

  Let $GEXXX901_Company_Alias  = 'JB.COMPANY'
  Let $GEXXX901_Paygroup_Alias = 'JB.PAYGROUP'
  Let $GEXXX902_Deptid_Alias   = 'JB.DEPTID'
  Let $GEXXX913_Union_CD_Alias = 'JB.UNION_CD'  !SXK 10/28/99 Changed from EM.union_cd
  Let $GEXXX909_Acct_CD_Alias  = 'JB.ACCT_CD'
  Let $GEXXX907_Div_CD_Alias   = 'GEX_COMPANY_DIV_CD'

  if $Prcs_Process_Instance = ''
    Do GEXXX950-Input-Parameters
  else
	Do GEXXX922-Select-Parameters
	let $X000_WHERE_SELECT_ASOFDATE = $GEX_RC_PAY.ASOFDATE
	if rtrim($GEX_RC_PAY.ASOFDATE,' ') = ''
	  let $X000_WHERE_SELECT_ASOFDATE = $asoftoday
	end-if

	Do GEXXX901-Select-Company-Paygroup-Parameters
	Do GEXXX902-Select-Deptid-Parameters
	Do GEXXX913-Select-Union-CD-Parameters
	Do GEXXX909-Select-Acct-CD-Parameters
	Do GEXXX907-Select-Div-CD-Parameters
  end-if

  move $X000_WHERE_SELECT_ASOFDATE to $program_date
  let $X000_ORDER_BY = 'JB.DEPTID, JB.UNION_CD, JB.ACCT_CD'  !, nvl(nvl(greatest(EM.HIRE_DT,EM.REHIRE_DT), EM.HIRE_DT), EM.REHIRE_DT) &THE_HIRE_DT'
  do Format-DateTime($X000_WHERE_SELECT_ASOFDATE, $X000_REPORT_HEADING_ASOFDATE ,{DEFDATE}, '', '')

  Do Convert-to-dtu-date($program_date,$prog_date)
  let $date_yy = substr($prog_date,1,4)
  let $date_mm = substr($prog_date,6,2)
  let $date_dd = substr($prog_date,9,2)
  
  let #balance_year = to_number($date_yy)
  let #balance_period = to_number($date_mm)
  evaluate #balance_period
     when <= 3
	let #balance_qtr = 1
	break
     when <= 6
	let #balance_qtr = 2
	break
     when <= 9
	let #balance_qtr = 3
	break
     when <=12
	let #balance_qtr = 4
	break
  end-evaluate

!default the selection date to today, if not entered by user
    if rtrim($X000_WHERE_SELECT_ASOFDATE, ' ' ) = ''
       let $X000_WHERE_SELECT_ASOFDATE = $asoftoday
    end-if
    
    do Format-DateTime($X000_WHERE_SELECT_ASOFDATE, $X000_REPORT_HEADING_ASOFDATE ,{DEFDATE}, '', '')

	show '$X000_ORDER_BY                                   =' $X000_ORDER_BY
	show '$X000_WHERE_SELECT_ASOFDATE                      =' $X000_WHERE_SELECT_ASOFDATE 

	print 'RUN CONTROL INFORMATION FOR THIS REPORT RUN:'        (+5,{#x000_col_selection_criteria_a})
	print '$Prcs_OPRID          ='                              (+1,{#x000_col_selection_criteria_b})
	print $Prcs_OPRID                                           (0,+2)
	print '$PRCS_RUN_CNTL_ID    ='                              (+1,{#x000_col_selection_criteria_b})
	print $PRCS_RUN_CNTL_ID                                     (0,+2)

	print 'SELECTION CRITERIA FOR THIS REPORT RUN:'             (+5,{#x000_col_selection_criteria_a})

	print '$GEXXX901_INCLUDE_COMPANY_PAYGROUP_DISPLAY_CRITERIA = ' (+1,{#x000_col_selection_criteria_a})
	print $GEXXX901_INCLUDE_COMPANY_PAYGROUP_DISPLAY_CRITERIA      (0,+2)
	print '$GEXXX902_INCLUDE_DEPTID_DISPLAY_CRITERIA =           ' (+1,{#x000_col_selection_criteria_a})
	print $GEXXX902_INCLUDE_DEPTID_DISPLAY_CRITERIA                (0,+2)
	print '$GEXXX913_INCLUDE_UNION_CD_DISPLAY_CRITERIA =         ' (+1,{#x000_col_selection_criteria_a}) 
	print $GEXXX913_INCLUDE_UNION_CD_DISPLAY_CRITERIA              (0,+2)
	print '$GEXXX907_INCLUDE_DIV_CD_DISPLAY_CRITERIA =           ' (+1,{#x000_col_selection_criteria_a})
	print $GEXXX907_INCLUDE_DIV_CD_DISPLAY_CRITERIA                (0,+2)
	print '$GEXXX909_INCLUDE_ACCT_CD_DISPLAY_CRITERIA =          ' (+1,{#x000_col_selection_criteria_a})
	print $GEXXX909_INCLUDE_ACCT_CD_DISPLAY_CRITERIA               (0,+2)

	print '$X000_WHERE_SELECT_ASOFDATE                         ='  (+1,{#x000_col_selection_criteria_b})
	print $X000_WHERE_SELECT_ASOFDATE                              (0,+2)
	 
	print 'SORT ORDER FOR THIS REPORT RUN:'                        (+5,{#x000_col_selection_criteria_a})
	print '$X000_ORDER_BY                                      ='  (+1,{#x000_col_selection_criteria_b})
	print $X000_ORDER_BY    (0,+2)


   LET #PAGE-COUNT = 0
   NEW-PAGE
   LET #PAGE-COUNT = 1
end-procedure


Begin-Procedure GEXXX950-Input-Parameters

  Let $GEXXX900_INCLUDE_COMPANY_CRITERIA = '1=1'
  Let $GEXXX900_INCLUDE_COMPANY_DISPLAY_CRITERIA = 'ALL'


  Display 'Enter Company/Paygroup or leave blank to exit.'
  While 1=1
    Input $In-Company Maxlen=3 'Company'
    Uppercase $In-Company
    If Rtrim($In-Company, ' ') = ''
      Break
    Else
      Input $In-Paygroup Maxlen=3 'Paygroup'
      Uppercase $In-Paygroup
      If Rtrim($In-Paygroup, ' ') = ''
        Let $Include_Condition = '(' || $GEXXX901_Company_Alias || ' = '''  || $In-Company || ''')'
      Else
        Let $Include_Condition = '(' || $GEXXX901_Company_Alias || ' = '''  || $In-Company || ''' And ' || $GEXXX901_Paygroup_Alias || ' = '''  || $In-Paygroup || ''')'
      End-If
      Add 1 To #GEX_RC_PAYGROUP_ROWS
      If #GEX_RC_PAYGROUP_ROWS = 1
        Let $GEXXX901_INCLUDE_COMPANY_PAYGROUP_CRITERIA = '(' || $Include_Condition
      Else
        Let $GEXXX901_INCLUDE_COMPANY_PAYGROUP_CRITERIA = $GEXXX901_INCLUDE_COMPANY_PAYGROUP_CRITERIA || ' Or '  || $Include_Condition
      End-If
    End-If
  End-While

  If #GEX_RC_PAYGROUP_ROWS = 0
    Let $GEXXX901_INCLUDE_COMPANY_PAYGROUP_CRITERIA = '1=1'
    Let $GEXXX901_INCLUDE_COMPANY_PAYGROUP_DISPLAY_CRITERIA = 'ALL'
  Else
    Let $GEXXX901_INCLUDE_COMPANY_PAYGROUP_CRITERIA = $GEXXX901_INCLUDE_COMPANY_PAYGROUP_CRITERIA || ')'
    Let $GEXXX901_INCLUDE_COMPANY_PAYGROUP_DISPLAY_CRITERIA = $GEXXX901_INCLUDE_COMPANY_PAYGROUP_CRITERIA
  End-If


  Let $DeptIDString = ''''
  Display 'Enter DeptID or leave blank to exit.'
  While 1=1
    Input $In-DeptID Maxlen=10 'DeptID'
    Uppercase $In-DeptID
    If Rtrim($In-DeptID, ' ') = ''
      Concat '''' With $DeptIDString
      Break
    End-If
    If $DeptIDString <> ''''
      Concat ''',''' With $DeptIDString
    End-If
    Concat $In-DeptID With $DeptIDString
  End-While

  If $DeptIDString = ''''''
    Let $GEXXX902_INCLUDE_DEPTID_CRITERIA = '1=1'
    Let $GEXXX902_INCLUDE_DEPTID_DISPLAY_CRITERIA = 'ALL'
  Else
    Let $GEXXX902_INCLUDE_DEPTID_CRITERIA = $GEXXX902_Deptid_Alias || ' In (' || $DeptIDString || ')'
    Let $GEXXX902_INCLUDE_DEPTID_DISPLAY_CRITERIA = $GEXXX902_INCLUDE_DEPTID_CRITERIA
  End-If


  Let $DivCdString = ''''
  Display 'Enter Company Division Code or leave blank to exit.'
  While 1=1
    Input $In-DivCd Maxlen=3 'Company Division Code'
    Uppercase $In-DivCd
    If Rtrim($In-DivCd, ' ') = ''
      Concat '''' With $DivCdString
      Break
    End-If
    If $DivCdString <> ''''
      Concat ''',''' With $DivCdString
    End-If
    Concat $In-DivCd With $DivCdString
  End-While

  If $DivCdString = ''''''
    Let $GEXXX907_INCLUDE_DIV_CD_CRITERIA = '1=1'
    Let $GEXXX907_INCLUDE_DIV_CD_DISPLAY_CRITERIA = 'ALL'
  Else
    Let $GEXXX907_INCLUDE_DIV_CD_CRITERIA = $GEXXX907_Div_CD_Alias || ' In (' || $DivCdString || ')'
    Let $GEXXX907_INCLUDE_DIV_CD_DISPLAY_CRITERIA = $GEXXX907_INCLUDE_DIV_CD_CRITERIA
  End-If


  Let $AcctCdString = ''''
  Display 'Enter Account Code or leave blank to exit.'
  While 1=1
    Input $In-AcctCd Maxlen=25 'Account Code'
    Uppercase $In-AcctCd
    If Rtrim($In-AcctCd, ' ') = ''
      Concat '''' With $AcctCdString
      Break
    End-If
    If $AcctCdString <> ''''
      Concat ''',''' With $AcctCdString
    End-If
    Concat $In-AcctCd With $AcctCdString
  End-While

  If $AcctCdString = ''''''
    Let $GEXXX909_INCLUDE_ACCT_CD_CRITERIA = '1=1'
    Let $GEXXX909_INCLUDE_ACCT_CD_DISPLAY_CRITERIA = 'ALL'
  Else
    Let $GEXXX909_INCLUDE_ACCT_CD_CRITERIA = $GEXXX909_Acct_CD_Alias || ' In (' || $AcctCdString || ')'
    Let $GEXXX909_INCLUDE_ACCT_CD_DISPLAY_CRITERIA = $GEXXX909_INCLUDE_ACCT_CD_CRITERIA
  End-If


  Let $UnionCdString = ''''
  Display 'Enter Union Code or leave blank to exit.'
  While 1=1
    Input $In-UnionCd Maxlen=3 'Union Code'
    Uppercase $In-UnionCd
    If Rtrim($In-UnionCd, ' ') = ''
      Concat '''' With $UnionCdString
      Break
    End-If
    If $UnionCdString <> ''''
      Concat ''',''' With $UnionCdString
    End-If
    Concat $In-UnionCd With $UnionCdString
  End-While

  If $UnionCdString = ''''''
    Let $GEXXX913_INCLUDE_UNION_CD_CRITERIA = '1=1'
    Let $GEXXX913_INCLUDE_UNION_CD_DISPLAY_CRITERIA = 'ALL'
  Else
    Let $GEXXX913_INCLUDE_UNION_CD_CRITERIA = $GEXXX913_Union_CD_Alias || ' In (' || $UnionCdString || ')'
    Let $GEXXX913_INCLUDE_UNION_CD_DISPLAY_CRITERIA = $GEXXX913_INCLUDE_UNION_CD_CRITERIA
  End-If


  Do Ask-As-Of-Date
  Let $X000_WHERE_SELECT_ASOFDATE = $AsOfDate
End-Procedure


!***********************************************************************
begin-procedure P200-Get-Job-Data
!***********************************************************************
!display 'P200-Get-Job-Data'

 let $x200_Get_Job_Data_Flag = 'N'
 let $first_pass = 'Y'
 let $second_pass = 'Y'
 let $acctcd_pass = 'Y'
 let #x000_detail_print_line_count = 0
 let $totals_printed = 'N'
begin-SELECT 

JB.DEPTID               () on-break 
			      print=never 
			      after=Deptid-Change
			      save=$prev_deptid
!			      before=Deptid-Before-Change                                                            
			      level=01        

   move &JB.DEPTID           to $DeptID
   let $DeptID   = rtrim($Deptid,' ')
   do Get-Department-Name
!SXK 10/28/99 Changed from em.union_cd

JB.UNION_CD             () on-break
			      print=never
			      after=Unioncd-Change
			      save=$prev_unioncd
!			      before=Unioncd-Before-Change                              
			      level=02

   move &JB.UNION_CD         to $union_cd  !SXK 10/28/99
   move &JB.UNION_CD         to $UnionCd   !SXK 10/28/99
   let $UnionCd = rtrim($UnionCd,' ')
   do Get-Union-Name


JB.ACCT_CD              () on-break
			      print=never
			      after=Acctcd-Change                              
			      save=$prev_acctcd
!			      before=Acctcd-Before-Change
			      level=03

   move &JB.ACCT_CD          to $acct_cd
   move &JB.ACCT_CD          to $GEXACTCD_ACCT_CD
   do Gexactcd-Get-Acct-Cd-Info
   move $GEXACTCD_DESCRSHORT to $acctcd_descr
 
! GEX ISDVNPK 03/25/2008 for rehire dt issue in 9.0
!nvl(nvl(greatest(EM.HIRE_DT,EM.REHIRE_DT), EM.HIRE_DT), EM.REHIRE_DT) &THE_HIRE_DT
nvl(nvl(greatest(EM.HIRE_DT,(SELECT JREH.EFFDT FROM PS_JOB JREH WHERE JREH.EMPLID = JB.EMPLID AND JREH.EMPL_RCD = JB.EMPL_RCD  AND JREH.EFFDT =
        (SELECT MAX(JREH1.EFFDT) FROM PS_JOB JREH1 WHERE JREH.EMPLID = JREH1.EMPLID AND JREH.EMPL_RCD  = JREH1.EMPL_RCD
          AND JREH1.EFFDT <= $X000_WHERE_SELECT_ASOFDATE AND JREH1.ACTION = 'REH') 
    AND JREH.EFFSEQ = (SELECT MAX(JREH2.EFFSEQ) FROM PS_JOB JREH2 WHERE JREH.EMPLID = JREH2.EMPLID AND JREH.EMPL_RCD = JREH2.EMPL_RCD
          AND JREH.EFFDT     = JREH2.EFFDT AND JREH2.ACTION      = 'REH')
    AND JREH.EFFDT >=	NVL((SELECT JREHA.EFFDT FROM PS_JOB JREHA WHERE JREHA.EMPLID = JREH.EMPLID AND JREHA.EMPL_RCD  = JREH.EMPL_RCD
    	  AND JREHA.EFFDT = (SELECT MAX(JREHA1.EFFDT) FROM PS_JOB JREHA1 WHERE JREHA.EMPLID = JREHA1.EMPLID
          AND JREHA.EMPL_RCD  = JREHA1.EMPL_RCD AND JREHA1.EFFDT <= $X000_WHERE_SELECT_ASOFDATE AND JREHA1.ACTION = 'HIR') 
    	  AND JREHA.EFFSEQ = (SELECT MAX(JREHA2.EFFSEQ) FROM PS_JOB JREHA2 WHERE JREHA.EMPLID = JREHA2.EMPLID
          AND JREHA.EMPL_RCD  = JREHA2.EMPL_RCD AND JREHA.EFFDT = JREHA2.EFFDT AND JREHA2.ACTION = 'HIR')), '01-jan-1900'))), EM.HIRE_DT), (SELECT JREHX.EFFDT FROM PS_JOB JREHX WHERE JREHX.EMPLID = JB.EMPLID AND JREHX.EMPL_RCD = JB.EMPL_RCD  AND JREHX.EFFDT =
        (SELECT MAX(JREHX1.EFFDT) FROM PS_JOB JREHX1 WHERE JREHX.EMPLID = JREHX1.EMPLID AND JREHX.EMPL_RCD  = JREHX1.EMPL_RCD
          AND JREHX1.EFFDT <= $X000_WHERE_SELECT_ASOFDATE AND JREHX1.ACTION = 'REH') 
    AND JREHX.EFFSEQ = (SELECT MAX(JREHX2.EFFSEQ) FROM PS_JOB JREHX2 WHERE JREHX.EMPLID = JREHX2.EMPLID AND JREHX.EMPL_RCD = JREHX2.EMPL_RCD
          AND JREHX.EFFDT     = JREHX2.EFFDT AND JREHX2.ACTION      = 'REH')
    AND JREHX.EFFDT >=	NVL((SELECT JREHXA.EFFDT FROM PS_JOB JREHXA WHERE JREHXA.EMPLID = JREHX.EMPLID AND JREHXA.EMPL_RCD  = JREHX.EMPL_RCD
    	  AND JREHXA.EFFDT = (SELECT MAX(JREHXA1.EFFDT) FROM PS_JOB JREHXA1 WHERE JREHXA.EMPLID = JREHXA1.EMPLID
          AND JREHXA.EMPL_RCD  = JREHXA1.EMPL_RCD AND JREHXA1.EFFDT <= $X000_WHERE_SELECT_ASOFDATE AND JREHXA1.ACTION = 'HIR') 
    	  AND JREHXA.EFFSEQ = (SELECT MAX(JREHXA2.EFFSEQ) FROM PS_JOB JREHXA2 WHERE JREHXA.EMPLID = JREHXA2.EMPLID
          AND JREHXA.EMPL_RCD  = JREHXA2.EMPL_RCD AND JREHXA.EFFDT = JREHXA2.EFFDT AND JREHXA2.ACTION = 'HIR')), '01-jan-1900'))) &THE_HIRE_DT
! GEX ISDVNPK 03/25/2008 for rehire dt issue in 9.0     

   move &THE_HIRE_DT          to $hire_dt                          

   Do Convert-to-dtu-date($hire_dt,$hire_Date)
   let $hire_yy = substr($hire_date,1,4)
   let $hire_mm = substr($hire_date,6,2)
   let $hire_dd = substr($hire_date,9,2)
   let $hire_all = $hire_yy||$hire_mm||$hire_dd

JB.COMPANY
   move &JB.COMPANY           to $company
					       
!JB.PAYGROUP																		!VENDKXY
 !  move &JB.PAYGROUP        to   $payGroup		!VENDKXY

JB.EMPLID
   move &JB.EMPLID           to $emplid
   
JB.EMPL_RCD
   move &JB.EMPL_RCD        to #empl_rcd

JB.EFFDT
   move &JB.EFFDT            to $effdt

JB.JOBCODE
   move &JB.JOBCODE          to $jobcode

!PC.PAY_END_DT


  Do Get-Employee-Name
  let #lname = length($Name)
  if #lname > 30
     let $Name = substr($Name,1,30)
  end-if

  Do Get-Selection-Criteria
  
  if $first_pass = 'Y' and rtrim($subsection,' ') <> ''
     move $subsection to $hold_subsection
     move $hire_heading2 to $hold_heading
     let $first_pass = 'N'
  else
     if rtrim($subsection,' ') = ''
        goto skip-processing
     end-if
  end-if

  display $subsection
  display $hold_subsection
  display $totals_printed
  if $subsection <> $hold_subsection and $totals_printed = 'N'
     use-report OT-Summary
     do Print-Total-Subsection
     use-report OT-Report
     do Print-Total-Subsection
     do Init-Hire-Date-Subtotals
     move $subsection to $hold_subsection
     move $hire_heading2 to $hold_heading
  else
     if $totals_printed = 'Y'
        let $totals_printed = 'N'
        do init-hire-date-subtotals
     end-if
     move $subsection to $hold_subsection
     move $hire_heading2 to $hold_heading
  end-if

  Display $emplid
  !show '#empl_rcd::' #empl_rcd !VENDKXY for testing 
  Display $deptid
  Display $union_cd
  Display $acct_cd
  Display $effdt
  Display $hire_dt

  let $x000_Get_Earnings_Detail = 'N'
  let $x000_Get_Earnings_Bal_Flag = 'N'

  let $x000_SELECT_ERNCD = 'OTP'
  do P250-Get-Earnings_Detail
  do P300-Get-Earnings-Balance
!  do P800-Print-Detail-Line

 !GEX-TLL 07/08/2008 Added Erncd=173 Begin
  let $x000_SELECT_ERNCD = '173'
  do P250-Get-Earnings_Detail
  do P300-Get-Earnings-Balance
 !GEX-TLL 07/08/2008 Added Erncd=173 End

  let $x000_SELECT_ERNCD = '008'
  do P250-Get-Earnings_Detail
  do P300-Get-Earnings-Balance
!  do P800-Print-Detail-Line

  let $x000_SELECT_ERNCD = '171'        
  do P250-Get-Earnings_Detail
  do P300-Get-Earnings-Balance
!  do P800-Print-Detail-Line

  let $x000_SELECT_ERNCD = '165'
  do P250-Get-Earnings_Detail
  do P300-Get-Earnings-Balance

  do P800-Print-Detail-Line
    
    


!conditionally print a blank line between employees
  if #x000_detail_print_line_count > 0
	print ' '                       (+1,1)
  end-if 

 let $x200_Get_Job_Data_Flag = 'Y'

skip-processing:


FROM  ps_gex_dept_tbl   gdt,
      PS_EMPLOYMENT     EM, 
      PS_JOB            JB
!SXK 01/26/99 Begin commented out
!      PS_PAY_CHECK      PC
!SXK 01/26/99 End

WHERE 
!PC.COMPANY         = JB.COMPANY
!AND   PC.PAYGROUP        = JB.PAYGROUP
!AND   PC.EMPLID          = JB.EMPLID
!AND   PC.EMPL_RCD       = JB.EMPL_RCD
!AND
   JB.EMPLID          = EM.EMPLID
!AND jb.emplid='273768399'   !VENDKXY Testing
AND   JB.EMPL_RCD       = EM.EMPL_RCD
AND   JB.EFFDT           =
     (SELECT MAX(EFFDT)
	FROM   PS_JOB
	WHERE  EMPLID      = JB.EMPLID
	AND    EMPL_RCD   = JB.EMPL_RCD
	AND    EFFDT      <= $X000_WHERE_SELECT_ASOFDATE)

AND   JB.EFFSEQ          =
     (SELECT MAX(EFFSEQ)
	FROM   PS_JOB
	WHERE  EMPLID      = JB.EMPLID
	AND    EMPL_RCD   = JB.EMPL_RCD
	AND    EFFDT       = JB.EFFDT)

!AND   PC.PAY_END_DT      =
!     (SELECT MAX(PAY_END_DT)
!	FROM   PS_PAY_CHECK
!	WHERE  COMPANY     = PC.COMPANY
!	AND    PAYGROUP    = PC.PAYGROUP
!	AND    PAY_END_DT <= $X000_WHERE_SELECT_ASOFDATE
!	AND    OFF_CYCLE   = PC.OFF_CYCLE
!	AND    PAGE_NUM       = PC.PAGE_NUM
!	AND    LINE_NUM       = PC.LINE_NUM
!	AND    SEPCHK      = PC.SEPCHK)

And    gdt.deptid          = jb.deptid

And    gdt.effdt           =
      (Select Max(effdt)
       From   ps_gex_dept_tbl
       Where  deptid       = gdt.deptid
       And    effdt       <= $X000_WHERE_SELECT_ASOFDATE)

And    gdt.sequence_number =
      (Select Max(sequence_number)
       From   ps_gex_dept_tbl
       Where  deptid       = gdt.deptid
       And    effdt        = gdt.effdt)

AND   [$GEXXX907_INCLUDE_DIV_CD_CRITERIA]
AND   [$GEXXX901_INCLUDE_COMPANY_PAYGROUP_CRITERIA]
AND   [$GEXXX902_INCLUDE_DEPTID_CRITERIA]
AND   [$GEXXX909_INCLUDE_ACCT_CD_CRITERIA]
AND   [$GEXXX913_INCLUDE_UNION_CD_CRITERIA]

ORDER BY 1,2,3,4

end-SELECT

 if $x200_Get_Job_Data_Flag = 'N'
	print 'NO DATA SELECTED FOR THIS REPORT RUN'    (25,) CENTER
 else

!print grand totals

  use-report OT-Summary

  Do Print-Grand-Totals

  use-report OT-Report

  Do Print-Grand-Totals


end-if

end-procedure


!***********************************************************************
begin-procedure P250-Get-Earnings_Detail
!***********************************************************************
!display 'P250-Get-Earnings_Detail'

! let $x000_Get_Earnings_Detail = 'N'

 !show ' $x000_SELECT_ERNCD  P250-Get-Earnings_Detail::'  $x000_SELECT_ERNCD !VENDKXY for testing
 #debug8 show '$x000_SELECT_ERNCD=' $x000_SELECT_ERNCD
 !show '$company ==  '$company   !VENDKXY for testing
 !show '$emplid==	'  $emplid		  !VENDKXY for testing
 !show '$payGroup=='  $payGroup  !VENDKXY for testing
 !show '#empl_rcd=='  #empl_rcd !VENDKXY for testing
begin-SELECT
!E.Emplid
E.COMPANY
E.PAYGROUP
E.PAY_END_DT
E.OFF_CYCLE
E.PAGE_NUM
E.LINE_NUM
E.ADDL_NBR
OE.ERNCD
   move &OE.ERNCD to $oe_erncd
  !show ' P250-Get-Earnings_Detail+++++++++++++++++++++++++++++++++++' !VENDKXY for testing
 let $x000_Get_Earnings_Detail = 'Y'
			
SUM(OE.OTH_HRS) &OE_OTH_HRS
SUM(OE.OTH_PAY) &OE_OTH_PAY

  Display 'Pay Oth Earns:'
  Display &OE.ERNCD
  Display &OE_OTH_HRS
  Display &OE_OTH_PAY

  evaluate $x000_SELECT_ERNCD
!  evaluate $oe_erncd
     when = 'OTP'
	add &OE_OTH_HRS to #OTP_OTH_HRS
	add &OE_OTH_PAY to #OTP_OTH_PAY
	break
    !GEX-TLL 07/08/2008 Added Erncd=173 Begin
     when = '173'
     ! show '$x000_SELECT_ERNCD:::'  $x000_SELECT_ERNCD  !VENDKXY for testing
     !show '#173_OTH_HRS:::' #173_OTH_HRS  !VENDKXY for testing
	add &OE_OTH_HRS to #173_OTH_HRS
	add &OE_OTH_PAY to #173_OTH_PAY
	break
    !GEX-TLL 07/08/2008 Added Erncd=173 End
     when = '008'
	add &OE_OTH_HRS to #008_OTH_HRS
	add &OE_OTH_PAY to #008_OTH_PAY
	break
     when = '171'
	add &OE_OTH_HRS to #171_OTH_HRS
	add &OE_OTH_PAY to #171_OTH_PAY
	break
     when = '165'
	add &OE_OTH_HRS to #165_OTH_HRS
	add &OE_OTH_PAY to #165_OTH_PAY
	break
     when-other
	Display 'Invalid Erncd.'
	break
  end-evaluate


FROM  PS_PAY_EARNINGS E,
      PS_PAY_OTH_EARNS OE

WHERE E.COMPANY     = $company
!and E.emplid        = $emplid	!Vendkxy for testing
AND   E.PAYGROUP    = $payGroup
AND   E.PAY_END_DT  = (select max(pay_end_Dt)
                         from ps_pay_earnings
                        where company = $company
                          and paygroup = $paygroup
                          and PAY_END_DT <= $X000_WHERE_SELECT_ASOFDATE)
AND   E.EMPL_RCD   = #empl_rcd
AND   E.COMPANY     = OE.Company
AND   E.PAYGROUP    = OE.PayGroup
AND   E.PAY_END_DT  = OE.Pay_End_Dt
AND   E.OFF_CYCLE   = OE.Off_Cycle
AND   E.PAGE_NUM       = OE.Page_NUM
AND   E.LINE_NUM       = OE.Line_NUM
AND   E.ADDL_NBR      = OE.ADDL_NBR
!AND   OE.ERNCD     IN ('OTP','008','171','165')
AND   OE.ERNCD      = $x000_SELECT_ERNCD
!AND   E.SINGLE_CHECK_USE IN ('C', 'N')

GROUP BY   E.COMPANY, E.PAYGROUP, E.PAY_END_DT, E.OFF_CYCLE,
		E.PAGE_NUM, E.LINE_NUM, E.ADDL_NBR, OE.ERNCD

end-SELECT

end-procedure


!***********************************************************************
begin-procedure P300-Get-Earnings-Balance
!***********************************************************************
!display 'P300-Get-Earnings-Balance'

!  let $x000_Get_Earnings_Bal_Flag = 'N'

begin-SELECT
EB.ERNCD
EB.GRS_YTD &EB_GRS_YTD

  Display 'Earnings Balance: ' noline
  Display &EB_GRS_YTD

  evaluate $x000_SELECT_ERNCD
!  evaluate $oe_erncd
     when = 'OTP'
	add &EB_GRS_YTD to #OTP_GRS_YTD
	break
    !GEX-TLL 07/08/2008 Added Erncd=173	Begin
     when = '173'
      !show '$x000_SELECT_ERNCD:::'  $x000_SELECT_ERNCD  !VENDKXY for testing
     !show '#173_GRS_YTD:::'  #173_GRS_YTD !VENDKXY for testing 
	add &EB_GRS_YTD to #173_GRS_YTD
	break
    !GEX-TLL 07/08/2008 Added Erncd=173 End
     when = '008'
  add &EB_GRS_YTD to #008_GRS_YTD
	break
     when = '171'
	add &EB_GRS_YTD to #171_GRS_YTD
	break
     when = '165'
	add &EB_GRS_YTD to #165_GRS_YTD
	break
     when-other
	Display 'Invalid Erncd.'
	break
  end-evaluate

  Display 'Earnings Bal'
  Display $x000_select_erncd

 #DEBUG8 show '&EB.ERNCD=' &EB.ERNCD

 let $x000_Get_Earnings_Bal_Flag = 'Y'

FROM   PS_EARNINGS_BAL EB

WHERE  EB.EMPLID              = $emplid
AND    EB.COMPANY             = $company
AND    EB.BALANCE_ID          = 'CY'
AND    EB.BALANCE_YEAR        = #balance_year
AND    EB.EMPL_RCD            = #empl_rcd
AND    EB.BALANCE_PERIOD      =
      (SELECT MAX(BALANCE_PERIOD)
       FROM   PS_EARNINGS_BAL
       WHERE  EMPLID          = EB.EMPLID
       AND    COMPANY         = EB.COMPANY
       AND    BALANCE_ID      = EB.BALANCE_ID
       AND    BALANCE_YEAR    = EB.BALANCE_YEAR
       AND    BALANCE_PERIOD <= #balance_period
       AND    SPCL_BALANCE    = EB.SPCL_BALANCE
       AND    EMPL_RCD        = EB.EMPL_RCD
       AND    ERNCD           = EB.ERNCD)

AND    EB.SPCL_BALANCE        = 'N'
AND    EB.ERNCD               = $x000_SELECT_ERNCD
end-SELECT
end-procedure


!***********************************************************************
begin-procedure P800-Print-Detail-Line
!***********************************************************************
!display 'P800-Print-Detail-Line'

  Display $x000_Get_Earnings_Detail
  Display $x000_Get_Earnings_Bal_Flag

  if    ($x000_Get_Earnings_Detail = 'Y') or ($x000_Get_Earnings_Bal_Flag = 'Y')

	let #x000_detail_print_line_count = #x000_detail_print_line_count + 1

	use-report OT-Report
 !GEX_SEC_REENG Vahini Katta Begins
	!let $empl1 = substr($emplid,1,3)
	!let $empl2 = substr($emplid,4,2)
	!let $empl3 = substr($emplid,6,4)
	!let $ssn = $empl1||'-'||$empl2||'-'||$empl3
 !GEX_SEC_REENG Vahini Katta Ends 

	let $hire_y = substr($hire_yy,3,2)
	let $print_hire = $hire_mm||'/'||$hire_dd||'/'||$hire_y

	if #current-line > 50
	   new-page
	end-if

      
!line 1

	if $acctcd_pass = 'Y'
	   move 'N' to $acctcd_pass
	   move $acct_cd to $hold_acctcd
           use-report OT-summary
	   print $acct_cd              (+2,{#x000_col_acctcd})
	   print $acctcd_descr      (0,{#x000_col_acct_descr})
           use-report OT-Report
	   print $acct_cd              (+2,{#x000_col_acctcd})
	   print $acctcd_descr      (0,{#x000_col_acct_descr})
        
	end-if
	
	if $acct_cd <> $hold_acctcd   
           use-report OT-summary
	   print $acct_cd              (+2,{#x000_col_acctcd})
	   print $acctcd_descr      (0,{#x000_col_acct_descr})
           use-report OT-report
	   print $acct_cd              (+2,{#x000_col_acctcd})
	   print $acctcd_descr      (0,{#x000_col_acct_descr})

	   move $acct_cd to $hold_acctcd
           move ' ' to $hold_subsection2
	end-if

	if $second_pass = 'Y'
	   move $subsection to $hold_subsection2
	   move 'N'         to $second_pass
	   print 'HIRE DATE '   (+2,{#x000_col_acct_descr})
	   print $hire_heading2                          ()
	end-if

	if $subsection <> $hold_subsection2
	   print 'HIRE DATE '   (+2,{#x000_col_acct_descr})
	   print $hire_heading2                          ()
           move $subsection to $hold_subsection2
	end-if

	print $jobcode             (+2,{#x000_col_jobcode})
  !GEX_SEC_REENG Vahini Katta Begins
	!print $ssn                      (0,{#x000_col_ssn})
  PRINT $emplid                  (0,{#x000_col_ssn})
  !GEX_SEC_REENG Vahini Katta Ends
	print $name                    (0,{#x000_col_name})
	print $print_hire         (0,{#x000_col_hire_date})
	print 'Cur Hrs'                (0,{#x000_col_type})
	print #OTP_OTH_HRS         (0,{#x000_col_overtime})  EDIT 999,999.99
	print #173_OTH_HRS      (0,{#x000_col_173})	     EDIT 999,999.99 !GEX-TLL 07/08/2008
	print #008_OTH_HRS     (0,{#x000_col_sun_straight})  EDIT 999,999.99
	print #171_OTH_HRS     (0,{#x000_col_sun_overtime})  EDIT 999,999.99
	print #165_OTH_HRS      (0,{#x000_col_sun_premium})  EDIT 999,999.99
	

!line 2
	print 'Cur $'                 (+1,{#x000_col_type})
	print #OTP_OTH_PAY         (0,{#x000_col_overtime})  EDIT 999,999.99
	print #173_OTH_PAY      (0,{#x000_col_173})	     EDIT 999,999.99  !GEX-TLL 07/08/2008
	print #008_OTH_PAY     (0,{#x000_col_sun_straight})  EDIT 999,999.99 
	print #171_OTH_PAY     (0,{#x000_col_sun_overtime})  EDIT 999,999.99 
	print #165_OTH_PAY      (0,{#x000_col_sun_premium})  EDIT 999,999.99

!line 3
	print 'Ytd $'                 (+1,{#x000_col_type})
	print #OTP_GRS_YTD         (0,{#x000_col_overtime})  EDIT 999,999.99 
	print #173_GRS_YTD         (0,{#x000_col_173})       EDIT 999,999.99 !GEX-TLL 07/08/2008
	print #008_GRS_YTD     (0,{#x000_col_sun_straight})  EDIT 999,999.99 
	print #171_GRS_YTD     (0,{#x000_col_sun_overtime})  EDIT 999,999.99
	print #165_GRS_YTD      (0,{#x000_col_sun_premium})  EDIT 999,999.99

  end-if  
  
  
!add to subtotals

  add #OTP_OTH_HRS to #subtotal_OTP_OTH_HRS
  add #173_OTH_HRS to #subtotal_173_OTH_HRS  !GEX-TLL 07/08/2008
  add #008_OTH_HRS to #subtotal_008_OTH_HRS
  add #171_OTH_HRS to #subtotal_171_OTH_HRS
  add #165_OTH_HRS to #subtotal_165_OTH_HRS
  add #OTP_OTH_PAY to #subtotal_OTP_OTH_PAY
  add #173_OTH_PAY to #subtotal_173_OTH_PAY  !GEX-TLL 07/08/2008
  add #008_OTH_PAY to #subtotal_008_OTH_PAY
  add #171_OTH_PAY to #subtotal_171_OTH_PAY
  add #165_OTH_PAY to #subtotal_165_OTH_PAY
  add #OTP_GRS_YTD to #subtotal_OTP_GRS_YTD
  add #173_GRS_YTD to #subtotal_173_GRS_YTD  !GEX-TLL 07/08/2008
  add #008_GRS_YTD to #subtotal_008_GRS_YTD
  add #171_GRS_YTD to #subtotal_171_GRS_YTD
  add #165_GRS_YTD to #subtotal_165_GRS_YTD

  add #OTP_OTH_HRS to #accttotal_OTP_OTH_HRS
  add #173_OTH_HRS to #accttotal_173_OTH_HRS  !GEX-TLL 07/08/2008  
  add #008_OTH_HRS to #accttotal_008_OTH_HRS
  add #171_OTH_HRS to #accttotal_171_OTH_HRS
  add #165_OTH_HRS to #accttotal_165_OTH_HRS
  add #OTP_OTH_PAY to #accttotal_OTP_OTH_PAY
  add #173_OTH_PAY to #accttotal_173_OTH_PAY  !GEX-TLL 07/08/2008
  add #008_OTH_PAY to #accttotal_008_OTH_PAY
  add #171_OTH_PAY to #accttotal_171_OTH_PAY
  add #165_OTH_PAY to #accttotal_165_OTH_PAY
  add #OTP_GRS_YTD to #accttotal_OTP_GRS_YTD
  add #173_GRS_YTD to #accttotal_173_GRS_YTD  !GEX-TLL 07/08/2008
  add #008_GRS_YTD to #accttotal_008_GRS_YTD
  add #171_GRS_YTD to #accttotal_171_GRS_YTD
  add #165_GRS_YTD to #accttotal_165_GRS_YTD

  add #OTP_OTH_HRS to #uniontotal_OTP_OTH_HRS
  add #173_OTH_HRS to #uniontotal_173_OTH_HRS   !GEX-TLL 07/08/2008
  add #008_OTH_HRS to #uniontotal_008_OTH_HRS
  add #171_OTH_HRS to #uniontotal_171_OTH_HRS
  add #165_OTH_HRS to #uniontotal_165_OTH_HRS
  add #OTP_OTH_PAY to #uniontotal_OTP_OTH_PAY
  add #173_OTH_PAY to #uniontotal_173_OTH_PAY   !GEX-TLL 07/08/2008
  add #008_OTH_PAY to #uniontotal_008_OTH_PAY
  add #171_OTH_PAY to #uniontotal_171_OTH_PAY
  add #165_OTH_PAY to #uniontotal_165_OTH_PAY
  add #OTP_GRS_YTD to #uniontotal_OTP_GRS_YTD
  add #173_GRS_YTD to #uniontotal_173_GRS_YTD   !GEX-TLL 07/08/2008
  add #008_GRS_YTD to #uniontotal_008_GRS_YTD
  add #171_GRS_YTD to #uniontotal_171_GRS_YTD
  add #165_GRS_YTD to #uniontotal_165_GRS_YTD

  add #OTP_OTH_HRS to #depttotal_OTP_OTH_HRS
  add #173_OTH_HRS to #depttotal_173_OTH_HRS   !GEX-TLL 07/08/2008
  add #008_OTH_HRS to #depttotal_008_OTH_HRS
  add #171_OTH_HRS to #depttotal_171_OTH_HRS
  add #165_OTH_HRS to #depttotal_165_OTH_HRS
  add #OTP_OTH_PAY to #depttotal_OTP_OTH_PAY
  add #173_OTH_PAY to #depttotal_173_OTH_PAY   !GEX-TLL 07/08/2008
  add #008_OTH_PAY to #depttotal_008_OTH_PAY
  add #171_OTH_PAY to #depttotal_171_OTH_PAY
  add #165_OTH_PAY to #depttotal_165_OTH_PAY
  add #OTP_GRS_YTD to #depttotal_OTP_GRS_YTD
  add #173_GRS_YTD to #depttotal_173_GRS_YTD   !GEX-TLL 07/08/2008
  add #008_GRS_YTD to #depttotal_008_GRS_YTD
  add #171_GRS_YTD to #depttotal_171_GRS_YTD
  add #165_GRS_YTD to #depttotal_165_GRS_YTD
			   
! add to grand totals

  add #OTP_OTH_HRS to #grandtotal_OTP_OTH_HRS
  add #173_OTH_HRS to #grandtotal_173_OTH_HRS   !GEX-TLL 07/08/2008
  add #008_OTH_HRS to #grandtotal_008_OTH_HRS
  add #171_OTH_HRS to #grandtotal_171_OTH_HRS
  add #165_OTH_HRS to #grandtotal_165_OTH_HRS
  add #OTP_OTH_PAY to #grandtotal_OTP_OTH_PAY
  add #173_OTH_PAY to #grandtotal_173_OTH_PAY   !GEX-TLL 07/08/2008
  add #008_OTH_PAY to #grandtotal_008_OTH_PAY
  add #171_OTH_PAY to #grandtotal_171_OTH_PAY
  add #165_OTH_PAY to #grandtotal_165_OTH_PAY
  add #OTP_GRS_YTD to #grandtotal_OTP_GRS_YTD
  add #173_GRS_YTD to #grandtotal_173_GRS_YTD   !GEX-TLL 07/08/2008
  add #008_GRS_YTD to #grandtotal_008_GRS_YTD
  add #171_GRS_YTD to #grandtotal_171_GRS_YTD
  add #165_GRS_YTD to #grandtotal_165_GRS_YTD

! reinitialize totals

  move 0 to #OTP_OTH_HRS
  move 0 to #173_OTH_HRS   !GEX-TLL 07/08/2008
  move 0 to #008_OTH_HRS
  move 0 to #171_OTH_HRS
  move 0 to #165_OTH_HRS
  move 0 to #OTP_OTH_PAY
  move 0 to #173_OTH_PAY   !GEX-TLL 07/08/2008
  move 0 to #008_OTH_PAY
  move 0 to #171_OTH_PAY
  move 0 to #165_OTH_PAY
  move 0 to #OTP_GRS_YTD
  move 0 to #173_GRS_YTD   !GEX-TLL 07/08/2008
  move 0 to #008_GRS_YTD
  move 0 to #171_GRS_YTD
  move 0 to #165_GRS_YTD

end-procedure

!*****************************************
begin-procedure Deptid-Before-Change
!*****************************************
#debug9 show 'Deptid-Before-Change'                     
	
   move &JB.DEPTID to $Deptid

 if  $x000_new_page_flag = 'Y'
	new-page
	let $x000_new_page_flag = 'N'
 end-if

end-procedure

!*****************************************
begin-procedure UnionCd-Before-Change
!*****************************************
#debug9 show 'UnionCd-Before-Change'                    
	
   move &JB.UNION_CD to $UnionCd  !SXK 10/28/99

 if  $x000_new_page_flag = 'Y'
	new-page
	let $x000_new_page_flag = 'N'
 end-if         

end-procedure

!*****************************************
begin-procedure AcctCd-Before-Change
!*****************************************
#debug9 show 'AcctCd-Before-Change'

   move &JB.ACCT_CD to $Acct_Cd

  if $x000_new_page_flag = 'Y'
	new-page
	let $x000_new_page_flag = 'N'
  end-if

end-procedure

!*****************************************
begin-procedure Deptid-Change
!*****************************************
#debug9 show 'Deptid-Change'
#debug8 show '$Deptid=' $Deptid

!print acctcd subtotals
  
  use-report OT-Summary

  Do Print-Deptid-Change

  use-report OT-Report

  Do Print-Deptid-Change


!reinitialize the sub totals

  move 0 to #depttotal_OTP_OTH_HRS
  move 0 to #depttotal_173_OTH_HRS  !GEX-TLL 07/08/2008
  move 0 to #depttotal_008_OTH_HRS
  move 0 to #depttotal_171_OTH_HRS
  move 0 to #depttotal_165_OTH_HRS
  move 0 to #depttotal_OTP_OTH_PAY
  move 0 to #depttotal_173_OTH_PAY  !GEX-TLL 07/08/2008
  move 0 to #depttotal_008_OTH_PAY
  move 0 to #depttotal_171_OTH_PAY
  move 0 to #depttotal_165_OTH_PAY           
  move 0 to #depttotal_OTP_GRS_YTD
  move 0 to #depttotal_173_GRS_YTD  !GEX-TLL 07/08/2008
  move 0 to #depttotal_008_GRS_YTD
  move 0 to #depttotal_171_GRS_YTD
  move 0 to #depttotal_165_GRS_YTD

 let $x000_new_page_flag = 'Y'

! move 'Y' to $changed_deptid

end-procedure

!**********************************
begin-procedure Print-Deptid-Change
!**********************************

  if #current-line > 50
     new-page
  end-if

  if ((#depttotal_OTP_OTH_HRS = 0) and (#depttotal_173_OTH_HRS = 0) and (#depttotal_008_OTH_HRS = 0) and (#depttotal_171_OTH_HRS = 0) and (#depttotal_165_OTH_HRS = 0) and  !GEX-TLL 07/08/2008 Added Erncd=173
      (#depttotal_OTP_OTH_PAY = 0) and (#depttotal_173_OTH_PAY = 0) and (#depttotal_008_OTH_PAY = 0) and (#depttotal_171_OTH_PAY = 0) and (#depttotal_165_OTH_PAY = 0) and  !GEX-TLL 07/08/2008 Added Erncd=173
      (#depttotal_OTP_GRS_YTD = 0) and (#depttotal_173_GRS_YTD = 0) and (#depttotal_008_GRS_YTD = 0) and (#depttotal_171_GRS_YTD = 0) and (#depttotal_165_GRS_YTD = 0))     !GEX-TLL 07/08/2008 Added Erncd=173
     ! Skip print - no totals
  else

!print deptid subtotals

    if #current-line > 50
       new-page
    end-if
  
    print 'Total'                        (+2,{#x000_col_acctcd})
    print $Deptid                     (0,{#x000_col_acct_descr})
    print $DeptName                                       (0,+1)
  
    print 'Cur Hrs'                         (0,{#x000_col_type})
    print #depttotal_OTP_OTH_HRS        (0,{#x000_col_overtime}) EDIT 999,999.99
    print #depttotal_173_OTH_HRS        (0,{#x000_col_173}) 	 EDIT 999,999.99  !GEX-TLL 07/08/2008
    print #depttotal_008_OTH_HRS    (0,{#x000_col_sun_straight}) EDIT 999,999.99
    print #depttotal_171_OTH_HRS    (0,{#x000_col_sun_overtime}) EDIT 999,999.99
    print #depttotal_165_OTH_HRS     (0,{#x000_col_sun_premium}) EDIT 999,999.99
    print 'Cur $'                          (+1,{#x000_col_type})
    print #depttotal_OTP_OTH_PAY        (0,{#x000_col_overtime}) EDIT 999,999.99
    print #depttotal_173_OTH_PAY        (0,{#x000_col_173}) 	 EDIT 999,999.99  !GEX-TLL 07/08/2008
    print #depttotal_008_OTH_PAY    (0,{#x000_col_sun_straight}) EDIT 999,999.99
    print #depttotal_171_OTH_PAY    (0,{#x000_col_sun_overtime}) EDIT 999,999.99
    print #depttotal_165_OTH_PAY     (0,{#x000_col_sun_premium}) EDIT 999,999.99
    print 'Ytd $'                          (+1,{#x000_col_type})
    print #depttotal_OTP_GRS_YTD        (0,{#x000_col_overtime}) EDIT 999,999.99
    print #depttotal_173_GRS_YTD        (0,{#x000_col_173}) 	 EDIT 999,999.99  !GEX-TLL 07/08/2008
    print #depttotal_008_GRS_YTD    (0,{#x000_col_sun_straight}) EDIT 999,999.99
    print #depttotal_171_GRS_YTD    (0,{#x000_col_sun_overtime}) EDIT 999,999.99
    print #depttotal_165_GRS_YTD     (0,{#x000_col_sun_premium}) EDIT 999,999.99

  end-if

  if &jb.deptid <> $prev_deptid
     new-page
  end-if
end-procedure


!*****************************************
begin-procedure UnionCd-Change
!*****************************************
#debug9 show 'UnionCd-Change'
#debug8 show 'UnionCd=' UnionCd

!  if $changed_deptid = 'Y'
!     !Skip Print
!     move 'N' to $changed_deptid
!  else
  
! print acctcd subtotals

    use-report OT-Summary
  
    Do Print-UnionCd-Change

    use-report OT-Report
 
    Do Print-UnionCd-Change
  

!reinitialize the sub totals
   
    move 0 to #uniontotal_OTP_OTH_HRS
    move 0 to #uniontotal_173_OTH_HRS  !GEX-TLL 07/08/2008
    move 0 to #uniontotal_008_OTH_HRS
    move 0 to #uniontotal_171_OTH_HRS
    move 0 to #uniontotal_165_OTH_HRS
    move 0 to #uniontotal_OTP_OTH_PAY
    move 0 to #uniontotal_173_OTH_PAY  !GEX-TLL 07/08/2008
    move 0 to #uniontotal_008_OTH_PAY
    move 0 to #uniontotal_171_OTH_PAY
    move 0 to #uniontotal_165_OTH_PAY
    move 0 to #uniontotal_OTP_GRS_YTD
    move 0 to #uniontotal_173_GRS_YTD  !GEX-TLL 07/08/2008
    move 0 to #uniontotal_008_GRS_YTD
    move 0 to #uniontotal_171_GRS_YTD
    move 0 to #uniontotal_165_GRS_YTD

   let $x000_new_page_flag = 'Y'

!   move 'Y' to $changed_unioncd

!  end-if

end-procedure

!***********************************
begin-procedure Print-UnionCd-Change
!***********************************

  if #current-line > 50
     new-page
  end-if
  
  if ((#uniontotal_OTP_OTH_HRS = 0) and (#uniontotal_173_OTH_HRS = 0) and (#uniontotal_008_OTH_HRS = 0) and (#uniontotal_171_OTH_HRS = 0) and (#uniontotal_165_OTH_HRS = 0) and  !GEX-TLL 07/08/2008 Added Erncd=173
      (#uniontotal_OTP_OTH_PAY = 0) and (#uniontotal_173_OTH_PAY = 0) and (#uniontotal_008_OTH_PAY = 0) and (#uniontotal_171_OTH_PAY = 0) and (#uniontotal_165_OTH_PAY = 0) and  !GEX-TLL 07/08/2008 Added Erncd=173
      (#uniontotal_OTP_GRS_YTD = 0) and (#uniontotal_173_GRS_YTD = 0) and (#uniontotal_008_GRS_YTD = 0) and (#uniontotal_171_GRS_YTD = 0) and (#uniontotal_165_GRS_YTD = 0))     !GEX-TLL 07/08/2008 Added Erncd=173
     ! Skip print - no totals
  else

! print unioncd subtotals

    if #current-line > 50
       new-page
    end-if
  
    print 'Total'                        (+2,{#x000_col_acctcd})
    print $Unioncd                    (0,{#x000_col_acct_descr})
    print $UnionName                                      (0,+1)
  
    print 'Cur Hrs'                         (0,{#x000_col_type})
    print #uniontotal_OTP_OTH_HRS       (0,{#x000_col_overtime}) EDIT 999,999.99
    print #uniontotal_173_OTH_HRS       (0,{#x000_col_173})      EDIT 999,999.99   !GEX-TLL 07/08/2008
    print #uniontotal_008_OTH_HRS   (0,{#x000_col_sun_straight}) EDIT 999,999.99
    print #uniontotal_171_OTH_HRS   (0,{#x000_col_sun_overtime}) EDIT 999,999.99
    print #uniontotal_165_OTH_HRS    (0,{#x000_col_sun_premium}) EDIT 999,999.99
    print 'Cur $'                          (+1,{#x000_col_type})
    print #uniontotal_OTP_OTH_PAY       (0,{#x000_col_overtime}) EDIT 999,999.99
    print #uniontotal_173_OTH_PAY       (0,{#x000_col_173})      EDIT 999,999.99  !GEX-TLL 07/08/2008
    print #uniontotal_008_OTH_PAY   (0,{#x000_col_sun_straight}) EDIT 999,999.99
    print #uniontotal_171_OTH_PAY   (0,{#x000_col_sun_overtime}) EDIT 999,999.99
    print #uniontotal_165_OTH_PAY    (0,{#x000_col_sun_premium}) EDIT 999,999.99
    print 'Ytd $'                          (+1,{#x000_col_type})
    print #uniontotal_OTP_GRS_YTD       (0,{#x000_col_overtime}) EDIT 999,999.99
    print #uniontotal_173_GRS_YTD       (0,{#x000_col_173})      EDIT 999,999.99  !GEX-TLL 07/08/2008
    print #uniontotal_008_GRS_YTD   (0,{#x000_col_sun_straight}) EDIT 999,999.99
    print #uniontotal_171_GRS_YTD   (0,{#x000_col_sun_overtime}) EDIT 999,999.99
    print #uniontotal_165_GRS_YTD    (0,{#x000_col_sun_premium}) EDIT 999,999.99

  end-if

  if &jb.deptid <> $prev_deptid
     new-page
  else
!SXK 10/28/99 Changed from em.union_cd
     if &JB.UNION_CD <> $prev_unioncd and #x000_detail_print_line_count > 0
        new-page
     end-if
  end-if

end-procedure


!*****************************************
begin-procedure AcctCd-Change
!*****************************************
#debug9 show 'AcctCd-Change'
#debug8 show 'AcctCd=' Acct_Cd

!  if $changed_unioncd = 'Y'
!     !Skip Print
!     move 'N' to $changed_unioncd
!  else
  
! print acctcd subtotals

!SXK 01/26/99 Begin
    use-report OT-Summary
    do Print-Total-Subsection
    use-report OT-Report
    do Print-Total-Subsection
    do Init-Hire-Date-Subtotals
    let $totals_printed = 'Y'
!SXK 01/26/99 End

    use-report OT-Summary

    Do Print-AcctCd-Change

    use-report OT-Report
 
    Do Print-AcctCd-Change
!SXK 10/28/99 Changed from em.union_cd
    if &JB.UNION_CD <> $prev_unioncd or &jb.deptid <> $prev_deptid
    else
      if &jb.acct_cd <> $preV_acctcd and #x000_detail_print_line_count > 0
         new-page
      end-if
    end-if       


!reinitialize the sub totals
   
    move 0 to #accttotal_OTP_OTH_HRS
    move 0 to #accttotal_173_OTH_HRS  !GEX-TLL 07/08/2008
    move 0 to #accttotal_008_OTH_HRS
    move 0 to #accttotal_171_OTH_HRS
    move 0 to #accttotal_165_OTH_HRS
    move 0 to #accttotal_OTP_OTH_PAY
    move 0 to #accttotal_173_OTH_PAY  !GEX-TLL 07/08/2008
    move 0 to #accttotal_008_OTH_PAY
    move 0 to #accttotal_171_OTH_PAY
    move 0 to #accttotal_165_OTH_PAY
    move 0 to #accttotal_OTP_GRS_YTD
    move 0 to #accttotal_173_GRS_YTD  !GEX-TLL 07/08/2008
    move 0 to #accttotal_008_GRS_YTD
    move 0 to #accttotal_171_GRS_YTD
    move 0 to #accttotal_165_GRS_YTD


!   let $x000_new_page_flag = 'Y'

!  end-if

end-procedure

!**********************************
begin-procedure Print-AcctCd-Change
!**********************************

  if #current-line > 50
     new-page
  end-if

  if ((#accttotal_OTP_OTH_HRS = 0) and (#accttotal_173_OTH_HRS = 0) and (#accttotal_008_OTH_HRS = 0) and (#accttotal_171_OTH_HRS = 0) and (#accttotal_165_OTH_HRS = 0) and  !GEX-TLL 07/08/2008 Added Erncd=173
      (#accttotal_OTP_OTH_PAY = 0) and (#accttotal_173_OTH_PAY = 0) and (#accttotal_008_OTH_PAY = 0) and (#accttotal_171_OTH_PAY = 0) and (#accttotal_165_OTH_PAY = 0) and  !GEX-TLL 07/08/2008 Added Erncd=173
      (#accttotal_OTP_GRS_YTD = 0) and (#accttotal_173_GRS_YTD = 0) and (#accttotal_008_GRS_YTD = 0) and (#accttotal_171_GRS_YTD = 0) and (#accttotal_165_GRS_YTD = 0))     !GEX-TLL 07/08/2008 Added Erncd=173
     ! Skip print - no totals
  else
  
    print 'Total'                        (+2,{#x000_col_acctcd})
    print $Acct_cd                    (0,{#x000_col_acct_descr})
    print $$acctcd_descr                                  (0,+1)

    print 'Cur Hrs'                         (0,{#x000_col_type})
    print #accttotal_OTP_OTH_HRS        (0,{#x000_col_overtime}) EDIT 999,999.99
    print #accttotal_173_OTH_HRS        (0,{#x000_col_173})      EDIT 999,999.99  !GEX-TLL 07/08/2008
    print #accttotal_008_OTH_HRS    (0,{#x000_col_sun_straight}) EDIT 999,999.99
    print #accttotal_171_OTH_HRS    (0,{#x000_col_sun_overtime}) EDIT 999,999.99
    print #accttotal_165_OTH_HRS     (0,{#x000_col_sun_premium}) EDIT 999,999.99
    print 'Cur $'                          (+1,{#x000_col_type})
    print #accttotal_OTP_OTH_PAY        (0,{#x000_col_overtime}) EDIT 999,999.99
    print #accttotal_173_OTH_PAY        (0,{#x000_col_173})      EDIT 999,999.99  !GEX-TLL 07/08/2008
    print #accttotal_008_OTH_PAY    (0,{#x000_col_sun_straight}) EDIT 999,999.99
    print #accttotal_171_OTH_PAY    (0,{#x000_col_sun_overtime}) EDIT 999,999.99
    print #accttotal_165_OTH_PAY     (0,{#x000_col_sun_premium}) EDIT 999,999.99
    print 'Ytd $'                          (+1,{#x000_col_type})
    print #accttotal_OTP_GRS_YTD        (0,{#x000_col_overtime}) EDIT 999,999.99
    print #accttotal_173_GRS_YTD        (0,{#x000_col_173})      EDIT 999,999.99  !GEX-TLL 07/08/2008
    print #accttotal_008_GRS_YTD    (0,{#x000_col_sun_straight}) EDIT 999,999.99
    print #accttotal_171_GRS_YTD    (0,{#x000_col_sun_overtime}) EDIT 999,999.99
    print #accttotal_165_GRS_YTD     (0,{#x000_col_sun_premium}) EDIT 999,999.99
 
  end-if

end-procedure


!*************************************
begin-procedure Get-Selection-Criteria
!*************************************

let $subsection = ' '
!1 union_cd - 427
   if ((($union_cd = 'F05') or ($union_cd = 'R05') or ($union_cd = 'R07') or ($union_cd = 'R09') or
	($union_cd = 'R10') or ($union_cd = 'R13') or ($union_cd = 'R22') or ($union_cd = 'R23') or
	($union_cd = 'R26')) and
	(($deptid = '0049') or ($deptid = '4017') or ($deptid = '4018') or         
	 ($deptid = '4051') or ($deptid = '4056') or ($deptid = '4075') or
	 ($deptid = '4077') or ($deptid = '4078')))
      if $hire_all < '19870503'                                         !1a
	 let $hire_heading2 = '< 05/03/87'
	 let $subsection = '1A'
      end-if
      if (($hire_all > '19870503') and ($hire_all < '19900810'))        !1b
	 let $hire_heading2 = '> 05/03/87 and < 08/10/90'
	 let $subsection = '1B'
      end-if
      if (($hire_all > '19900810') and ($hire_all < '19930806'))        !1c
	 let $hire_heading2 = '> 08/10/90 and < 08/06/93'
	 let $subsection = '1C'
      end-if
      if (($hire_all > '19930806') and ($hire_all < '19960609'))        !1d
	 let $hire_heading2 = '> 08/06/93 and < 06/09/96'
	 let $subsection = '1D'
      end-if
      if ($hire_all > '19960609')                                       !1e
	 let $hire_heading2 = '> 06/09/96'
	 let $subsection = '1E'
      end-if
   end-if

!2 union_cd - 698
   if ((($union_cd = 'F06') or ($union_cd = 'R04') or ($union_cd = 'R08') or ($union_cd = 'R12') or 
	($union_cd = 'R14') or ($union_cd = 'R15') or ($union_cd = 'R16') or ($union_cd = 'R17') or
	($union_cd = 'R18') or ($union_cd = 'R19') or ($union_cd = 'R20') or ($union_cd = 'R21') or
	($union_cd = 'R25') or ($union_cd = 'R31') or ($union_cd = 'R32') or ($union_cd = 'R33') or
	($union_cd = 'R34') or ($union_cd = 'R35') or ($union_cd = 'R36')) and
	(($deptid = '0049') or ($deptid = '4017') or ($deptid = '4018') or
	 ($deptid = '4051') or ($deptid = '4056') or ($deptid = '4078')))
      if $hire_all < '19870503'                                         !2a
	 let $hire_heading2 = '< 05/03/87'
	 let $subsection = '2A'
      end-if
      if (($hire_all > '19980503') and ($hire_all < '19900810'))        !2b
	 let $hire_heading2 = '> 05/03/87 and < 08/10/90'
	 let $subsection = '2B'
      end-if
      if (($hire_all > '19900810') and ($hire_all < '19930806'))        !2c
	 let $hire_heading2 = '> 08/10/90 and < 08/06/93'
	 let $subsection = '2C'
      end-if
      if (($hire_all > '19930806') and ($hire_all < '19960609'))        !2d
	 let $hire_heading2 = '> 08/06/93 and < 06/09/96'
	 let $subsection = '2D'
      end-if
      if ($hire_all > '19960609')                                       !2e
	 let $hire_heading2 = '> 06/09/96'
	 let $subsection = '2E'
      end-if
   end-if

!3 union_cd - 698
   if ((($union_cd = 'F06') or ($union_cd = 'R04') or ($union_cd = 'R08') or ($union_cd = 'R12') or 
	($union_cd = 'R14') or ($union_cd = 'R15') or ($union_cd = 'R16') or ($union_cd = 'R17') or
	($union_cd = 'R18') or ($union_cd = 'R19') or ($union_cd = 'R20') or ($union_cd = 'R21') or
	($union_cd = 'R25') or ($union_cd = 'R31') or ($union_cd = 'R32') or ($union_cd = 'R33') or
	($union_cd = 'R34') or ($union_cd = 'R35') or ($union_cd = 'R36')) and
	($deptid = '4077'))
      if $hire_all < '19860620'                                         !3a
	 let $hire_heading2 = '< 06/20/86'
	 let $subsection = '3A'
      end-if
      if (($hire_all > '19860620') and ($hire_all < '19910318'))        !3b
	 let $hire_heading2 = '> 06/20/86 and < 03/18/91'
	 let $subsection = '3B'
      end-if
      if (($hire_all > '19910318') and ($hire_all < '19930806'))        !3c
	 let $hire_heading2 = '> 03/18/91 and < 08/06/93'
	 let $subsection = '3C'
      end-if
      if (($hire_all > '19930806') and ($hire_all < '19960310'))        !3d
	 let $hire_heading2 = '> 08/06/93 and < 03/10/96'
	 let $subsection = '3D'
      end-if
      if $hire_all > '19960310'                                         !3e
	 let $hire_heading2 = '> 03/10/96'
	 let $subsection = '3E'
      end-if
   end-if

!4 union-cd - 427 or 698
   if ((($union_cd = 'F05') or ($union_cd = 'R05') or ($union_cd = 'R07') or ($union_cd = 'R09') or
	($union_cd = 'R10') or ($union_cd = 'R13') or ($union_cd = 'R22') or ($union_cd = 'R23') or
	($union_cd = 'R26') or 
	($union_cd = 'F06') or ($union_cd = 'R04') or ($union_cd = 'R08') or ($union_cd = 'R12') or 
	($union_cd = 'R14') or ($union_cd = 'R15') or ($union_cd = 'R16') or ($union_cd = 'R17') or
	($union_cd = 'R18') or ($union_cd = 'R19') or ($union_cd = 'R20') or ($union_cd = 'R21') or
	($union_cd = 'R25') or ($union_cd = 'R31') or ($union_cd = 'R32') or ($union_cd = 'R33') or
	($union_cd = 'R34') or ($union_cd = 'R35') or ($union_cd = 'R36')) and
	(($deptid = '4022') or ($deptid = '4124') or ($deptid = '4057') or
	 ($deptid = '4091') or ($deptid = '4095') or ($deptid = '4025') or
	 ($deptid = '4096')))
      if $hire_all < '19840911'                                         !4a
	 let $hire_heading2 = '< 09/11/84'
	 let $subsection = '4A'
      end-if
      if $hire_all > '19840911'                                         !4b
	 let $hire_heading2 = '> 09/11/84'
	 let $subsection = '4B'
      end-if
   end-if

!5 union_cd - 427 or 698
!   if ((($union_cd = 'F05') or ($union_cd = 'R05') or ($union_cd = 'R07') or ($union_cd = 'R09') or
!        ($union_cd = 'R10') or ($union_cd = 'R13') or ($union_cd = 'R22') or ($union_cd = 'R23') or
!        ($union_cd = 'R26') or 
!        ($union_cd = 'F06') or ($union_cd = 'R04') or ($union_cd = 'R08') or ($union_cd = 'R12') or 
!        ($union_cd = 'R14') or ($union_cd = 'R15') or ($union_cd = 'R16') or ($union_cd = 'R17') or
!        ($union_cd = 'R18') or ($union_cd = 'R19') or ($union_cd = 'R20') or ($union_cd = 'R21') or
!        ($union_cd = 'R25') or ($union_cd = 'R31') or ($union_cd = 'R32') or ($union_cd = 'R33') or
!        ($union_cd = 'R34') or ($union_cd = 'R35') or ($union_cd = 'R36')) and
!        ($deptid = '4060'))
!
!   end-if

!6 union_cd - 698
!   if (($union_cd = 'F06') or ($union_cd = 'R04') or ($union_cd = 'R08') or ($union_cd = 'R12') or 
!       ($union_cd = 'R14') or ($union_cd = 'R15') or ($union_cd = 'R16') or ($union_cd = 'R17') or
!       ($union_cd = 'R18') or ($union_cd = 'R19') or ($union_cd = 'R20') or ($union_cd = 'R21') or
!       ($union_cd = 'R25') or ($union_cd = 'R31') or ($union_cd = 'R32') or ($union_cd = 'R33') or
!       ($union_cd = 'R34') or ($union_cd = 'R35') or ($union_cd = 'R36')) and
!       ($deptid = '4075'))
!
!   end-if

!7 union_cd - 427
!   if ((($union_cd = 'F05') or ($union_cd = 'R05') or ($union_cd = 'R07') or ($union_cd = 'R09') or
!        ($union_cd = 'R10') or ($union_cd = 'R13') or ($union_cd = 'R22') or ($union_cd = 'R23') or
!        ($union_cd = 'R26')) and 
!        ($deptid = '4060')))
!
!    end-if

end-procedure

!**********************************************************************
begin-procedure Print-Total-Subsection
!**********************************************************************

  if #current-line > 50
     new-page
  end-if

  if ((#subtotal_OTP_OTH_HRS = 0) and (#subtotal_173_OTH_HRS = 0) and (#subtotal_008_OTH_HRS = 0) and (#subtotal_171_OTH_HRS = 0) and (#subtotal_165_OTH_HRS = 0) and  !GEX-TLL 07/08/2008 Added Erncd=173
      (#subtotal_OTP_OTH_PAY = 0) and (#subtotal_173_OTH_PAY = 0) and (#subtotal_008_OTH_PAY = 0) and (#subtotal_171_OTH_PAY = 0) and (#subtotal_165_OTH_PAY = 0) and  !GEX-TLL 07/08/2008 Added Erncd=173
      (#subtotal_OTP_GRS_YTD = 0) and (#subtotal_173_GRS_YTD = 0) and (#subtotal_008_GRS_YTD = 0) and (#subtotal_171_GRS_YTD = 0) and (#subtotal_165_GRS_YTD = 0))     !GEX-TLL 07/08/2008 Added Erncd=173
     ! Skip print - no totals
  else

     print 'Total'                    (+2,{#x000_col_acct_descr})
     print $hold_heading                 (0,{#x000_col_jobcode})

     print 'Cur Hrs'                         (0,{#x000_col_type})
     print #subtotal_OTP_OTH_HRS         (0,{#x000_col_overtime}) EDIT 999,999.99
     print #subtotal_173_OTH_HRS         (0,{#x000_col_173})      EDIT 999,999.99  !GEX-TLL 07/08/2008
     print #subtotal_008_OTH_HRS     (0,{#x000_col_sun_straight}) EDIT 999,999.99
     print #subtotal_171_OTH_HRS     (0,{#x000_col_sun_overtime}) EDIT 999,999.99
     print #subtotal_165_OTH_HRS      (0,{#x000_col_sun_premium}) EDIT 999,999.99
     print 'Cur $'                          (+1,{#x000_col_type})
     print #subtotal_OTP_OTH_PAY         (0,{#x000_col_overtime}) EDIT 999,999.99
     print #subtotal_173_OTH_PAY         (0,{#x000_col_173})      EDIT 999,999.99  !GEX-TLL 07/08/2008
     print #subtotal_008_OTH_PAY     (0,{#x000_col_sun_straight}) EDIT 999,999.99
     print #subtotal_171_OTH_PAY     (0,{#x000_col_sun_overtime}) EDIT 999,999.99
     print #subtotal_165_OTH_PAY      (0,{#x000_col_sun_premium}) EDIT 999,999.99
     print 'Ytd $'                          (+1,{#x000_col_type})
     print #subtotal_OTP_GRS_YTD         (0,{#x000_col_overtime}) EDIT 999,999.99
     print #subtotal_173_GRS_YTD         (0,{#x000_col_173})      EDIT 999,999.99  !GEX-TLL 07/08/2008
     print #subtotal_008_GRS_YTD     (0,{#x000_col_sun_straight}) EDIT 999,999.99
     print #subtotal_171_GRS_YTD     (0,{#x000_col_sun_overtime}) EDIT 999,999.99
     print #subtotal_165_GRS_YTD      (0,{#x000_col_sun_premium}) EDIT 999,999.99
  end-if

end-procedure

!***************************************
begin-procedure Init-Hire-Date-Subtotals
!***************************************

  move 0 to #subtotal_OTP_OTH_HRS
  move 0 to #subtotal_173_OTH_HRS   !GEX-TLL 07/08/2008
  move 0 to #subtotal_008_OTH_HRS
  move 0 to #subtotal_171_OTH_HRS
  move 0 to #subtotal_165_OTH_HRS
  move 0 to #subtotal_OTP_OTH_PAY
  move 0 to #subtotal_173_OTH_PAY   !GEX-TLL 07/08/2008
  move 0 to #subtotal_008_OTH_PAY
  move 0 to #subtotal_171_OTH_PAY
  move 0 to #subtotal_165_OTH_PAY
  move 0 to #subtotal_OTP_GRS_YTD
  move 0 to #subtotal_173_GRS_YTD   !GEX-TLL 07/08/2008
  move 0 to #subtotal_008_GRS_YTD
  move 0 to #subtotal_171_GRS_YTD
  move 0 to #subtotal_165_GRS_YTD

end-procedure

!*********************************
begin-procedure Print-Grand-Totals  
!*********************************

  if #current-line > 50
     new-page
  end-if

  if ((#grandtotal_OTP_OTH_HRS = 0) and (#grandtotal_173_OTH_HRS = 0) and (#grandtotal_008_OTH_HRS = 0) and (#grandtotal_171_OTH_HRS = 0) and (#grandtotal_165_OTH_HRS = 0) and  !GEX-TLL 07/08/2008 Added Erncd=173
      (#grandtotal_OTP_OTH_PAY = 0) and (#grandtotal_173_OTH_PAY = 0) and (#grandtotal_008_OTH_PAY = 0) and (#grandtotal_171_OTH_PAY = 0) and (#grandtotal_165_OTH_PAY = 0) and  !GEX-TLL 07/08/2008 Added Erncd=173
      (#grandtotal_OTP_GRS_YTD = 0) and (#grandtotal_173_GRS_YTD = 0) and (#grandtotal_008_GRS_YTD = 0) and (#grandtotal_171_GRS_YTD = 0) and (#grandtotal_165_GRS_YTD = 0))     !GEX-TLL 07/08/2008 Added Erncd=173
     ! Skip print - no totals
     print 'NO DATA SELECTED FOR THIS REPORT RUN'    (25,) CENTER 
  else
  
    print 'Grand Totals'                                 (+3,1)
    print 'Cur Hrs'                        (0,{#x000_col_type})
    print #grandtotal_OTP_OTH_HRS      (0,{#x000_col_overtime}) EDIT 999,999.99
    print #grandtotal_173_OTH_HRS      (0,{#x000_col_173}) 	EDIT 999,999.99  !GEX-TLL 07/08/2008
    print #grandtotal_008_OTH_HRS  (0,{#x000_col_sun_straight}) EDIT 999,999.99
    print #grandtotal_171_OTH_HRS  (0,{#x000_col_sun_overtime}) EDIT 999,999.99
    print #grandtotal_165_OTH_HRS   (0,{#x000_col_sun_premium}) EDIT 999,999.99
    print 'Cur $'                         (+1,{#x000_col_type})
    print #grandtotal_OTP_OTH_PAY      (0,{#x000_col_overtime}) EDIT 999,999.99
    print #grandtotal_173_OTH_PAY      (0,{#x000_col_173}) 	EDIT 999,999.99  !GEX-TLL 07/08/2008
    print #grandtotal_008_OTH_PAY  (0,{#x000_col_sun_straight}) EDIT 999,999.99
    print #grandtotal_171_OTH_PAY  (0,{#x000_col_sun_overtime}) EDIT 999,999.99
    print #grandtotal_165_OTH_PAY   (0,{#x000_col_sun_premium}) EDIT 999,999.99
    print 'Ytd $'                         (+1,{#x000_col_type})
    print #grandtotal_OTP_GRS_YTD      (0,{#x000_col_overtime}) EDIT 999,999.99
    print #grandtotal_173_GRS_YTD      (0,{#x000_col_173}) 	EDIT 999,999.99  !GEX-TLL 07/08/2008
    print #grandtotal_008_GRS_YTD  (0,{#x000_col_sun_straight}) EDIT 999,999.99
    print #grandtotal_171_GRS_YTD  (0,{#x000_col_sun_overtime}) EDIT 999,999.99
    print #grandtotal_165_GRS_YTD   (0,{#x000_col_sun_premium}) EDIT 999,999.99

  end-if

  print ' '                                            (+2,1)
  print 'End of Report'                                    () Center
  
end-procedure


!**********************************************************************
#include 'gexaltse.sqc'  ! ALTER ORACLE SESSION
#include 'setenv.sqc'    !set database environment
!#include 'setup02.sqc'   !Printer and page-size initialization
#include 'getcodta.sqc'  !Get-Company_Data procedure
#include 'curdttim.sqc'  !Get-Current-DateTime procedure
#include 'getdptnm.sqc'  !Get-Department-Name procedure
#include 'getunion.sqc'  !Get-Union-Name procedure
#include 'readxlat.sqc'  !Read-Translate-Table procedure
#include 'datetime.sqc'  !general date and time formatting procedures
#include 'datemath.sqc'
#include 'number.sqc'    !general number formatting procedures
#include 'stdapi.sqc'    !StdAPI-Init procedure
#include 'reset.sqc'     !Reset printer procedure
#include 'getbalid.sqc'  !Get-Calendar-Year-Id
#include 'gexactcd.sqc'  !Gexactcd-Get-Acct-Cd-Info procedure
#Include 'getempnm.sqc'  !Get Employee Name
#Include 'gexxx901.sqc'
#Include 'gexxx902.sqc'
#Include 'gexxx907.sqc'
#Include 'gexxx909.sqc'
#Include 'gexxx913.sqc'
#Include 'gexxx922.sqc'
#Include 'askaod.sqc'

