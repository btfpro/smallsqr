!***********************************************************************
!               Confidentiality Information:                           *
!                                                                      *
! This module is the confidential and proprietary information of       *
! Giant Eagle, Inc.; it is not to be copied, reproduced, or transmitted*
! in any form, by any means, in whole or in part, nor is it to be used *
! for any purpose other than that for which it is expressly provided   *
! without the written permission of Giant Eagle.                       *
!                                                                      *
!                                                                      *
!***********************************************************************
!                         MODIFICATION HISTORY                         *
!***********************************************************************
!  ID#     INITIALS    DATE           DESCRIPTION OF THE CHANGE        *  
!***********************************************************************
!  GBNC016   sxk       06/11/1998     INITIAL CREATION                 *
!                                                                      *
!            sxk       11/09/1999     Modified to have bas_activity    *
!                                     insert                           *
!                                                                      *
!            AXL       12/28/1999     Added debug89 display stmts      *
!                                                                      *
!  HR70133   AXL       05/14/2001     Add new job field                *
!                                     GEX_SEASONAL_EMP.                *
!                                                                      *
!  HR10306   GBD       08/01/2002     8.3 Upgrade:                     *
!                                     1. Added new fields to the insert*
!                                     into the PS_JOB table.           *
!                                     2. Added new insert for the      *
!                                     PS_JOB_JR table.                 *
!                                     3. Added insert for the          *
!                                     Compensation Table.              *
!                                                                      *
!  HR10306   GBD       01/03/2003     Added BAS_SUPPRESS_FORMS field to*
!                                     Bas_Activity table insert.       *
!                                                                      *
!  HR10302   AXL       03/4/2003      Added a select for               *
!                                     PS_COMPENSATION and modified     *
!                                     existing inserts.                *
!                                                                      *
!  HR10302   AXL       03/10/2003     Disable joins in PS_COMPENSATION *
!                                     sub-select logic.                *
! ISDVNPK  08/28/2007 Modified for 9.0 upgrade with JOB and JOB_JR changes
!GEX_SEC_REENG 2016-06-02 Vahini Katta                                 *
!Changes related to gex_emplid_mapp/7 digit emplid
!***********************************************************************

!*********************************************************************
!This procedure checks if any current dated job row exists. If so, 
!increments the sequence number and inserts a new job row with the
!calculated eligibility config2 value, otherwise, inserts a new job
!row with current date as the effdt and with new eligibility config1
!value.  After inserting into job table, updates the personal table 
!*********************************************************************
begin-procedure insert-procedure

  #debug9 display 'Insert-procedure'  ! AXL 12/99

  #debug8 display 'emplid: ' noline
  #debug8 display $emplid
  #debug8 display 'empl_rcd: ' noline
  #debug8 display #empl_rcd
  #debug8 display 'effdt_dbf: ' noline
  #debug8 display $effdt_dbf
  #debug8 display 'reportdate_ccyy: ' noline
  #debug8 display $reportdate_ccyy

	    let $update-is-done = 'N'
	    do select-job-row
            do select-comp-row	!AXL 3/4/2003 New
	    if $errorfound = 'N'
!SXK 11/09/1999 Begin
!	       if $bas_action_retrieved <> 'Y'
		  do get-bas-action
!	       end-if
!SXK 11/09/1999 End

             show ' $$$$$$$$$$$$$$$$$$$$$$   effdt_row_exists ============= ' $effdt_row_exists
	       if $effdt_row_exists = 'Y'
		  if &I.ACTION = 'ATO'
		     do error-found
		     move 'N' to $errorfound
		     print 'ATO row exists for this employee' (,34)
		  end-if
!SXK 11/09/1999 Begin
		  let $bac_emplid = &I.EMPLID
		  let #bac_empl_rcd = &I.EMPL_RCD
		  let $bac_bas_action_source = 'TJ'
		  let $bac_event_dt = &I.EFFDT
		  let #bac_event_effseq = #effseq
		  let $bac_cobra_action = &I.COBRA_ACTION
!SXK 11/09/1999 End
		  do insert-job-row-effdt-exists
                  do insert-job-jr-row-effdt-exists         !GBD 08/26/2002
                  do insert-compensation-row-effdt-exists   !GBD 08/26/2002
	       else
!SXK 11/09/1999 Begin
		  let $bac_emplid = &J.EMPLID
		  let #bac_empl_rcd = &J.EMPL_RCD
		  let $bac_bas_action_source = 'TJ'
		  let $bac_event_dt = $effdt_dbf
		  let #bac_event_effseq = 0
		  let $bac_cobra_action = &J.COBRA_ACTION
!SXK 11/09/1999 End
           show ' calling insert-job-row  insert-job-jr-row insert-compensation-row ************************** '
		  do insert-job-row
                  do insert-job-jr-row                      !GBD 08/26/2002
                  do insert-compensation-row                !GBD 08/26/2002
	       end-if
	       
 !SXK 11/09/1999 Begin
!               if $errorfound = 'N' and $update-is-done = 'N'
!                  do update-personal-data
!               end-if
               do select-all-future-job-rows
	       let $bas_activity_exists = 'N'
	       do select-bas-activity-row
	       if $bas_activity_exists = 'N'
		  do insert-bas-activity-row
	       end-if
!SXK 11/09/1999 End
	    
	    end-if

end-procedure

!*********************************************************************
!Selects the job table row with runcontrol effdt. If it does not exist
!calls the select to get the maximum effdt row for the employee
!*********************************************************************

begin-procedure select-job-row

#debug9 display 'select-job-row'

move 'N' to $found
move 'N' to $effdt_row_exists
move 'N' to $errorfound

begin-select on-error=sql-error-found('select-job-row')
I.EMPLID
I.EMPL_RCD
I.EFFDT
I.EFFSEQ
I.PER_ORG           ! GEX ISDVNPK 08/27/2007                     
I.DEPTID
I.JOBCODE
I.POSITION_NBR
I.SUPERVISOR_ID                 ! GEX ISDVNPK 08/27/2007                    
I.POSITION_OVERRIDE
I.POSN_CHANGE_RECORD
I.EMPL_STATUS
I.ACTION
I.ACTION_dT
I.ACTION_REASON
I.LOCATION
I.TAX_LOCATION_CD           !ISDVMXR FIXED COLUMN NAME
I.JOB_ENTRY_DT
I.DEPT_ENTRY_DT
I.POSITION_ENTRY_DT
I.SHIFT
I.REG_TEMP
I.FULL_PART_TIME
I.COMPANY
I.PAYGROUP
!SXK 11/09/1999 Begin
!I.PIN_NUM
!I.PAY_BASIS_NUM
!SXK 11/09/1999 End
I.BAS_GROUP_ID
I.ELIG_CONFIG1
I.ELIG_CONFIG2
I.ELIG_CONFIG3
I.ELIG_CONFIG4
I.ELIG_CONFIG5
I.ELIG_CONFIG6
I.ELIG_CONFIG7
I.ELIG_CONFIG8
I.ELIG_CONFIG9
I.BEN_STATUS
!SXK 11/09/1999 Begin
I.BAS_ACTION
!SXK 11/09/1999 End
I.COBRA_aCTION
I.EMPL_TYPE
I.HOLIDAY_SCHEDULE
I.STD_HOURS
I.STD_HRS_FREQUENCY                                  !GBD 09/20/2002
I.OFFICER_CD
I.EMPL_CLASS
I.SAL_ADMIN_PLAN
I.GRADE
I.GRADE_ENTRY_dT
I.STEP
I.STEP_ENTRY_DT
I.GL_PAY_TYPE
I.ACCT_CD                                  !ISDVMXR FIXED COLUMN NAME
I.EARNS_DIST_TYPE
! GEX ISDVNPK 08/27/2007          
!I.SALARY_MATRIX_CD
!I.RATING_SCALE
!I.REVIEW_RATING
!I.REVIEW_DT
! GEX ISDVNPK 08/27/2007          
I.COMP_FREQUENCY
I.COMPRATE
I.CHANGE_AMT
I.CHANGE_PCT
I.ANNUAL_RT
I.MONTHLY_RT
I.DAILY_RT
I.HOURLY_RT
I.ANNL_BENEF_BASE_RT
I.SHIFT_RT
I.SHIFT_FACTOR
I.CURRENCY_CD
!sxk 11/09/1999 Begin
I.BUSINESS_UNIT
I.SETID_DEPT
I.SETID_JOBCODE
I.SETID_LOCATION                                     !GBD 09/20/2002
I.SETID_SALARY                                       !GBD 09/20/2002
I.REG_REGION
I.DIRECTLY_TIPPED
!SXK 11/09/1999 End
I.FLSA_STATUS
I.EEO_CLASS
I.FUNCTION_CD
I.TARIFF_GER                                         !GBD 09/20/2002 Begin
I.TARIFF_AREA_GER        
I.PERFORM_GROUP_GER
I.LABOR_TYPE_GER         
I.SPK_COMM_ID_GER        
!I.WRKS_CNCL_MEM_GER     ! GEX ISDVNPK 08/27/2007                                       !GBD 09/20/2002 End
I.HOURLY_RT_FRA
I.ACCDNT_CD_FRA
I.VALUE_1_FRA                                        !GBD 09/20/2002 Begin
I.VALUE_2_FRA            
I.VALUE_3_FRA            
I.VALUE_4_FRA            
I.VALUE_5_FRA            
I.CTG_RATE               
I.PAID_HOURS             
I.PAID_FTE               
I.PAID_HRS_FREQUENCY
! GEX ISDVNPK 08/27/2007               
!I.GVT_EFFDT              
!I.GVT_EFFDT_PROPOSED     
!I.GVT_TRANS_NBR          
!I.GVT_TRANS_NBR_SEQ      
!I.GVT_WIP_STATUS         
!I.GVT_STATUS_TYPE        
!I.GVT_NOA_CODE           
!I.GVT_LEG_AUTH_1         
!I.GVT_PAR_AUTH_D1        
!I.GVT_PAR_AUTH_D1_2      
!I.GVT_LEG_AUTH_2         
!I.GVT_PAR_AUTH_D2        
!I.GVT_PAR_AUTH_D2_2      
!I.GVT_PAR_NTE_DATE       
!I.GVT_WORK_SCHED         
!I.GVT_SUB_AGENCY         
!I.GVT_ELIG_FEHB          
!I.GVT_FEHB_DT            
!I.GVT_PAY_RATE_DETER     
!I.GVT_STEP               
!I.GVT_RTND_PAY_PLAN      
!I.GVT_RTND_SAL_PLAN      
!I.GVT_RTND_GRADE         
!I.GVT_RTND_STEP          
!I.GVT_RTND_GVT_STEP      
!I.GVT_PAY_BASIS          
!I.GVT_COMPRATE           
!I.GVT_LOCALITY_ADJ       
!I.GVT_BIWEEKLY_RT        
!I.GVT_DAILY_RT           
!I.GVT_HRLY_RT_NO_LOC     
!I.GVT_DLY_RT_NO_LOC      
!I.GVT_BW_RT_NO_LOC       
!I.GVT_MNLY_RT_NO_LOC     
!I.GVT_ANNL_RT_NO_LOC     
!I.GVT_XFER_FROM_AGCY     
!I.GVT_XFER_TO_AGCY       
!I.GVT_RETIRE_PLAN        
!I.GVT_ANN_IND            
!I.GVT_FEGLI              
!I.GVT_FEGLI_LIVING       
!I.GVT_LIVING_AMT         
!I.GVT_ANNUITY_OFFSET     
!I.GVT_CSRS_FROZN_SVC     
!I.GVT_PREV_RET_COVRG     
!I.GVT_FERS_COVERAGE      
!I.GVT_TYPE_OF_APPT       
!I.GVT_POI                
!I.GVT_POSN_OCCUPIED      
!I.GVT_CONT_EMPLID        
!I.GVT_ROUTE_NEXT         
!I.GVT_CHANGE_FLAG        
!I.GVT_TSP_UPD_IND        
!I.GVT_PI_UPD_IND         
!I.GVT_SF52_NBR           
!I.GVT_S113G_CEILING      
!I.GVT_LEO_POSITION       
!I.GVT_ANNUIT_COM_DT      
!I.GVT_BASIC_LIFE_RED     
!I.GVT_DED_PRORT_DT       
!I.GVT_FEGLI_BASC_PCT     
!I.GVT_FEGLI_OPT_PCT      
!I.GVT_FEHB_PCT           
!I.GVT_RETRO_FLAG         
!I.GVT_RETRO_DED_FLAG     
!I.GVT_RETRO_JOB_FLAG     
!I.GVT_RETRO_BSE_FLAG     
!I.GVT_OTH_PAY_CHG        
!I.GVT_DETL_POSN_NBR      
!I.ANNL_BEN_BASE_OVRD     
!I.BENEFIT_PROGRAM        
!I.UPDATE_PAYROLL         
!I.GVT_PAY_PLAN           
!I.GVT_PAY_FLAG           
!I.GVT_NID_CHANGE
! GEX ISDVNPK 08/27/2007                  
I.UNION_FULL_PART        
I.UNION_POS              
I.MATRICULA_NBR          
I.SOC_SEC_RISK_CODE      
I.UNION_FEE_AMOUNT       
I.UNION_FEE_START_DT     
I.UNION_FEE_END_DT       
I.EXEMPT_JOB_LBR         
I.EXEMPT_HOURS_MONTH     
I.WRKS_CNCL_FUNCTION     
I.INTERCTR_WRKS_CNCL     
I.CURRENCY_CD1           
I.PAY_UNION_FEE          
I.UNION_CD               
I.BARG_UNIT              
I.UNION_SENIORITY_DT     
I.ENTRY_DATE             
I.LABOR_AGREEMENT        
I.EMPL_CTG               
I.EMPL_CTG_L1            
I.EMPL_CTG_L2            
I.SETID_LBR_AGRMNT  
! GEX ISDVNPK 08/27/2007
I.WPP_STOP_FLAG                          
I.LABOR_FACILITY_ID                      
I.LBR_FAC_ENTRY_DT                       
I.LAYOFF_EXEMPT_FLAG                     
I.LAYOFF_EXEMPT_RSN                      
! GEX ISDVNPK 08/27/2007    
I.GP_PAYGROUP            
I.GP_DFLT_ELIG_GRP       
I.GP_ELIG_GRP            
I.GP_DFLT_CURRTTYP       
I.CUR_RT_TYPE            
I.GP_DFLT_EXRTDT         
I.GP_ASOF_DT_EXG_RT      
I.ADDS_TO_FTE_ACTUAL     
I.CLASS_INDC             
I.ENCUMB_OVERRIDE        
I.FICA_STATUS_EE         
I.FTE                    
I.PRORATE_CNT_AMT        
I.PAY_SYSTEM_FLG         
I.BORDER_WALKER          
I.LUMP_SUM_PAY           
I.CONTRACT_NUM           
I.JOB_INDICATOR          
I.WRKS_CNCL_ROLE_CHE     
!I.WRKS_CNCL_ID_LCL     ! GEX ISDVNPK 08/27/2007   
I.BENEFIT_SYSTEM         
I.WORK_DAY_HOURS         
!I.SUPERVISOR_ID    ! GEX ISDVNPK 08/27/2007     
! GEX ISDVNPK 08/27/2007     
I.HR_STATUS                              
I.APPT_TYPE                              
I.MAIN_APPT_NUM_JPN  
! GEX ISDVNPK 08/27/2007                         
I.REPORTS_TO             
I.FORCE_PUBLISH          
I.JOB_DATA_SRC_CD                                    !GBD 09/20/2002 End
I.ESTABID
! GEX ISDVNPK 08/27/2007     
I.SUPV_LVL_ID                            
I.SETID_SUPV_LVL                         
I.ABSENCE_SYSTEM_CD                      
I.POI_TYPE                               
I.HIRE_DT                                
I.LAST_HIRE_DT                           
I.TERMINATION_DT                         
I.ASGN_START_DT                          
I.LST_ASGN_START_DT                      
I.ASGN_END_DT                            
I.LDW_OVR                                
I.LAST_DATE_WORKED                       
I.EXPECTED_RETURN_DT                     
I.EXPECTED_END_DATE                      
I.AUTO_END_FLG                           
I.LASTUPDDTTM                            
I.LASTUPDOPRID   
! GEX ISDVNPK 08/27/2007                             
I.GEX_LIGHT_DUTY
I.GEX_CHANGE_RECORD
I.GEX_VOLUN_LOW_HRS
I.GEX_STUDENT_IND
I.GEX_MOON_IND
I.GEX_DEPTID_OVR
I.GEX_ACCT_CD_OVR
I.GEX_GL_EXP_OVR
I.GEX_STEWARD
I.GEX_DUES_EXEMPT
I.GEX_FINAN_CORE
I.GEX_INFLATED_HRS
i.GEX_FP_CODE
I.GEX_SEASONAL_EMP	!AXL 5/14/2001 New job field	!AXL 5/14/2001 New job field
    move 'Y' to $found
    move 'Y' to $effdt_row_exists
    let #effseq = &I.EFFSEQ + 1
!    move &I.EMPL_RCD to #empl_rcd

!GBD 08/26/2002 Begin
    Do select-job-jr-row
!GBD 08/26/2002 End

FROM PS_JOB I

WHERE I.EMPLID = $emplid
  AND I.EMPL_RCD = #empl_rcd
  AND I.EFFDT = $effdt_Dbf
  AND I.EFFSEQ = 
      (SELECT MAX(EFFSEQ)
	 FROM PS_JOB
	WHERE EMPLID = $emplid
	  AND EMPL_RCD = #EMPL_RCD
	  AND EFFDT = $effdt_dbf)

end-SELECT

if $found = 'N'
  do select-current-job-row
end-if

end-procedure

!GBD 08/01/2002 Begin
!*********************************************************************
!Selects the job_jr table row with runcontrol effdt. If it does not
!exist calls the select to get the maximum effdt row for the employee
!*********************************************************************
begin-procedure select-job-jr-row
#debug9 show 'select-job-jr-row'

begin-select on-error=sql-error-found('select-job-jr-row')
I2.EMPLID                 
I2.EMPL_RCD               
I2.EFFDT                  
I2.EFFSEQ                 
I2.LASTUPDDTTM            
I2.LASTUPDOPRID           
I2.TAXCODE_UK             
I2.TAX_BASIS_UK           
I2.WORKER_TYPE_MEX        
I2.REDUCED_WEEK_MEX       
I2.LOCATED_CD_MEX         
I2.SALARY_TYPE_MEX        
I2.IMS_TERM_DT_MEX 
!GEX ISDVNPK 08/27/2007       
!I2.CASUAL_IND             
!I2.SALARY_PACKAGED        
!I2.PAYROLL_STATE_AUS      
!I2.CLASSN_CURRENT_AUS     
!I2.WORK_SECTOR_AUS        
!I2.FUNCTION_AUS           
!I2.ANN_CNTACT_HRS_AUS     
!I2.TEACH_WEEKS_AUS        
!I2.CASUAL_TYPE_AUS        
!I2.TERM_TYPE_AUS          
!I2.TERM_LTD_AUS   
!GEX ISDVNPK 08/27/2007               
I2.BALANCE_GRP_NUM        
I2.FP_ACTION_2            
I2.CTG_RATE               
I2.FP_LEGALSTAT_CD        
I2.FP_SCNDMT_CD           
I2.FP_SCND_TYP            
I2.FP_CIVIL_PENSION       
I2.FP_SOURCE_ORG          
I2.FP_RECEP_ORG           
I2.FP_RETURN_CD           
I2.FP_PR_LEGSTA           
I2.FP_FOREND_DT           
I2.FP_END_DT              
I2.FP_CAREFRZPCT          
I2.FP_HIR_DOS_SIT         
I2.FP_PT_PCT_DET          
I2.FP_TITLE_NUM           
I2.FP_DURATION_PCT        
I2.FP_RATING_PRS_FLG      
I2.FP_BUDGET_NBR          
I2.FP_HDCNT_NBR           
I2.FP_POTENT_NBR          
I2.FP_RANK_CD             
I2.FP_STEP_CD             
I2.FP_RK_ENT_DT           
I2.FP_CORPS_CD            
I2.FP_CHG_COR_DT          
I2.FP_CATG_FP             
I2.FP_CATG_LEVEL          
I2.FP_RK_TRIALPD          
I2.FP_STEP_END_DT         
I2.FP_FOR_PROM_DT         
I2.FP_NOMINATION_DT       
I2.FP_TRAINEE             
I2.FP_TRNE_POSN           
I2.FP_RK_PD_END_DT        
I2.FP_SANCTION            
I2.FP_DOWN_GRA            
I2.FP_APPL_SAL_DT         
I2.FP_CHG_IND             
I2.FP_CLD_INST            
I2.FP_SETID_RANK          
I2.FP_INSTALL_DT          
I2.FP_EQUIV_STEP          
I2.FP_STEP_CD2            
I2.FP_BUSINESS_CD         
I2.FP_APPL_DT             
I2.FP_CHG_SAL             
I2.FP_POINTYP_CD          
I2.FP_GROSS_IND           
I2.FP_INCS_IND            
I2.FP_INCS_IND2           
I2.FP_PT_PCT              
I2.FP_PT_END_DT           
I2.FP_PT_FOREND_DT        
I2.FP_COMPRATE            
I2.FP_INST_STAT           
I2.FP_RETROSPECT          
I2.FP_ROW_END_DT          
I2.LAST_UPDATE_DATE       
I2.OTHER_ID_JPN           
I2.INTCP_XFR_FLG          
I2.INTCP_XFR_START_DT     
I2.INTCP_XFR_END_DT       
I2.INTCP_BUS_UNIT         
I2.INTCP_DEPTID           
I2.INTCP_DEPTID2          
I2.INTCP_SETID_DEPT       
I2.INTCP_COMPANY          
I2.INTCP_COMPANY2         
I2.INTCP_SUPV_LVL_ID      
I2.INTCP_SUPV_LVL_ID2
!GEX ISDVNPK 08/27/2007  
I2.START_DATE_JPN                          
I2.EXP_END_DATE_JPN                        
I2.END_DATE_JPN                            
!I2.SUPV_LVL_ID            
!I2.EXPECTED_END_DATE      
!I2.AUTO_END_FLG  
!GEX ISDVNPK 08/27/2007           
I2.DUTIES_TYPE            
I2.ASSIGNMENT_ID          
I2.TARGET_COMPRATE        
I2.CMP_DONT_ABSORB        
I2.SSN_EMPLOYER           
I2.UNITA_PROD_CD          
I2.ACTION_ITA             
I2.ACTION_REASON_ITA      
I2.SPECIAL_HIRCTG_ITA     
I2.PART_TIME_TYPE_ITA     
I2.PART_TIME_PERC_ITA     
I2.PARTTIME_ENDDT_ITA   
!GEX ISDVNPK 08/27/2007   
I2.WORKDAYS_NLD                            
I2.CONT_SAL_TYPE_BRA                       
I2.CBO_CD_BRA                              
I2.SEFIP_CATEGORY_BRA                      
I2.UNION_CD_ALT_BRA   
!GEX ISDVNPK 08/27/2007  

FROM PS_JOB_JR I2

WHERE I2.EMPLID = $emplid
  AND I2.EMPL_RCD = #empl_rcd
  AND I2.EFFDT = $effdt_Dbf
  AND I2.EFFSEQ = 
      (SELECT MAX(EFFSEQ)
	 FROM PS_JOB_JR
	WHERE EMPLID = $emplid
	  AND EMPL_RCD = #EMPL_RCD
	  AND EFFDT = $effdt_dbf)
end-select

end-procedure
!GBD 08/26/2002 End

!AXL 3/4/2003 Begin
!*********************************************************************
!Select the corresponding Compensation Row
!*********************************************************************
begin-procedure select-comp-row
#debug9 show 'select-comp-row'

  move 'N' to $found_comp
 
begin-select on-error=sql-error-found('select-comp-row')

I3.EMPLID                 
I3.EMPL_RCD               
I3.EFFDT                  
I3.EFFSEQ                 
I3.COMP_EFFSEQ            
I3.COMP_RATECD            
I3.COMP_RATE_POINTS       
I3.COMPRATE               
I3.COMP_PCT               
I3.COMP_FREQUENCY         
I3.CURRENCY_CD            
I3.MANUAL_SW              
I3.CONVERT_COMPRT         
I3.RATE_CODE_GROUP        
I3.CHANGE_AMT             
I3.CHANGE_PCT             
I3.CHANGE_PTS             
I3.FTE_INDICATOR          
I3.CMP_SRC_IND       

  move 'Y' to $found_comp
  let #effseq_comp = &I3.EFFSEQ + 1
  
FROM PS_COMPENSATION I3

  WHERE I3.EMPLID   = $emplid
  AND   I3.EMPL_RCD = #empl_rcd

  AND I3.EFFDT = $effdt_Dbf
  AND I3.EFFSEQ = 
      (SELECT MAX(EFFSEQ) FROM PS_COMPENSATION
       WHERE I3.EMPLID      = EMPLID
        AND I3.EMPL_RCD     = EMPL_RCD
        AND I3.COMP_EFFSEQ  = COMP_EFFSEQ
        AND I3.COMP_RATECD  = COMP_RATECD
        AND I3.EFFDT        = EFFDT)  

end-select

if $found_comp = 'N'
  do select-current-comp-row
end-if

end-procedure
!AXL 3/4/2003 End

!*********************************************************************
!Selects maximum effdt row for the employee
!*********************************************************************

begin-procedure select-current-job-row

#debug9 display 'select-current-job-row'

move 'N' to $found
move 'N' to $errorfound

begin-select on-error=sql-error-found('select-current-job-row')
J.EMPLID
J.EMPL_RCD 
J.EFFDT
J.EFFSEQ    &effseq
J.PER_ORG     ! GEX ISDVNPK 08/27/2007                               
J.DEPTID
J.JOBCODE
J.POSITION_NBR 
J.SUPERVISOR_ID                   ! GEX ISDVNPK 08/27/2007               
J.POSITION_OVERRIDE
J.POSN_CHANGE_RECORD
J.EMPL_STATUS
J.ACTION
J.ACTION_dT
J.ACTION_REASON
J.LOCATION
J.TAX_LOCATION_cD
J.JOB_ENTRY_DT
J.DEPT_ENTRY_DT
J.POSITION_ENTRY_DT
J.SHIFT
J.REG_TEMP
J.FULL_PART_TIME
J.COMPANY
J.PAYGROUP
!SXK 11/09/1999 Begin
!J.PIN_NUM                                           !GBD 09/20/2002
!J.PAY_BASIS_NUM                                     !GBD 09/20/2002
!SXK 11/09/1999 End
J.BAS_GROUP_ID
J.ELIG_CONFIG1
J.ELIG_CONFIG2
J.ELIG_CONFIG3
J.ELIG_CONFIG4
J.ELIG_CONFIG5
J.ELIG_CONFIG6
J.ELIG_CONFIG7
J.ELIG_CONFIG8
J.ELIG_CONFIG9
J.BEN_STATUS
!SXK 11/09/1999 Begin
J.BAS_ACTION
!SXK 11/09/1999 End
J.COBRA_aCTION
J.EMPL_TYPE
J.HOLIDAY_SCHEDULE
J.STD_HOURS
J.STD_HRS_FREQUENCY                                  !GBD 09/20/2002
J.OFFICER_CD
J.EMPL_CLASS
J.SAL_ADMIN_PLAN
J.GRADE
J.GRADE_ENTRY_dT
J.STEP
J.STEP_ENTRY_DT
J.GL_PAY_TYPE
J.ACCT_cD
J.EARNS_DIST_TYPE
! GEX ISDVNPK 08/27/2007      
!J.SALARY_MATRIX_CD
!J.RATING_SCALE
!J.REVIEW_RATING
!J.REVIEW_DT
! GEX ISDVNPK 08/27/2007      
J.COMP_FREQUENCY
J.COMPRATE
J.CHANGE_AMT
J.CHANGE_PCT
J.ANNUAL_RT
J.MONTHLY_RT
J.DAILY_RT                                           !GBD 09/20/2002
J.HOURLY_RT
J.ANNL_BENEF_BASE_RT
J.SHIFT_RT
J.SHIFT_FACTOR
J.CURRENCY_CD
!sxk 11/09/1999 Begin
J.BUSINESS_UNIT
J.SETID_DEPT
J.SETID_JOBCODE
J.SETID_LOCATION                                     !GBD 09/20/2002
J.SETID_SALARY                                       !GBD 09/20/2002
J.REG_REGION
J.DIRECTLY_TIPPED
!SXK 11/09/1999 End
J.FLSA_STATUS
J.EEO_CLASS
J.FUNCTION_CD
J.TARIFF_GER                                         !GBD 09/20/2002
J.TARIFF_AREA_GER
J.PERFORM_GROUP_GER
J.LABOR_TYPE_GER
J.SPK_COMM_ID_GER
!J.WRKS_CNCL_MEM_GER    ! GEX ISDVNPK 08/27/2007                                       !GBD 09/20/2002
J.HOURLY_RT_FRA
J.ACCDNT_CD_FRA
J.VALUE_1_FRA                                        !GBD 09/20/2002 Begin      
J.VALUE_2_FRA            
J.VALUE_3_FRA            
J.VALUE_4_FRA            
J.VALUE_5_FRA            
J.CTG_RATE               
J.PAID_HOURS             
J.PAID_FTE               
J.PAID_HRS_FREQUENCY   
! GEX ISDVNPK 08/27/2007        
!J.GVT_EFFDT              
!J.GVT_EFFDT_PROPOSED     
!J.GVT_TRANS_NBR          
!J.GVT_TRANS_NBR_SEQ      
!J.GVT_WIP_STATUS         
!J.GVT_STATUS_TYPE        
!J.GVT_NOA_CODE           
!J.GVT_LEG_AUTH_1         
!J.GVT_PAR_AUTH_D1        
!J.GVT_PAR_AUTH_D1_2      
!J.GVT_LEG_AUTH_2         
!J.GVT_PAR_AUTH_D2        
!J.GVT_PAR_AUTH_D2_2      
!J.GVT_PAR_NTE_DATE       
!J.GVT_WORK_SCHED         
!J.GVT_SUB_AGENCY         
!J.GVT_ELIG_FEHB          
!J.GVT_FEHB_DT            
!J.GVT_PAY_RATE_DETER     
!J.GVT_STEP               
!J.GVT_RTND_PAY_PLAN      
!J.GVT_RTND_SAL_PLAN      
!J.GVT_RTND_GRADE         
!J.GVT_RTND_STEP          
!J.GVT_RTND_GVT_STEP      
!J.GVT_PAY_BASIS          
!J.GVT_COMPRATE           
!J.GVT_LOCALITY_ADJ       
!J.GVT_BIWEEKLY_RT        
!J.GVT_DAILY_RT           
!J.GVT_HRLY_RT_NO_LOC     
!J.GVT_DLY_RT_NO_LOC      
!J.GVT_BW_RT_NO_LOC       
!J.GVT_MNLY_RT_NO_LOC     
!J.GVT_ANNL_RT_NO_LOC     
!J.GVT_XFER_FROM_AGCY     
!J.GVT_XFER_TO_AGCY       
!J.GVT_RETIRE_PLAN        
!J.GVT_ANN_IND            
!J.GVT_FEGLI              
!J.GVT_FEGLI_LIVING       
!J.GVT_LIVING_AMT         
!J.GVT_ANNUITY_OFFSET     
!J.GVT_CSRS_FROZN_SVC     
!J.GVT_PREV_RET_COVRG     
!J.GVT_FERS_COVERAGE      
!J.GVT_TYPE_OF_APPT       
!J.GVT_POI                
!J.GVT_POSN_OCCUPIED      
!J.GVT_CONT_EMPLID        
!J.GVT_ROUTE_NEXT         
!J.GVT_CHANGE_FLAG        
!J.GVT_TSP_UPD_IND        
!J.GVT_PI_UPD_IND         
!J.GVT_SF52_NBR           
!J.GVT_S113G_CEILING      
!J.GVT_LEO_POSITION       
!J.GVT_ANNUIT_COM_DT      
!J.GVT_BASIC_LIFE_RED     
!J.GVT_DED_PRORT_DT       
!J.GVT_FEGLI_BASC_PCT     
!J.GVT_FEGLI_OPT_PCT      
!J.GVT_FEHB_PCT           
!J.GVT_RETRO_FLAG         
!J.GVT_RETRO_DED_FLAG     
!J.GVT_RETRO_JOB_FLAG     
!J.GVT_RETRO_BSE_FLAG     
!J.GVT_OTH_PAY_CHG        
!J.GVT_DETL_POSN_NBR      
!J.ANNL_BEN_BASE_OVRD     
!J.BENEFIT_PROGRAM        
!J.UPDATE_PAYROLL         
!J.GVT_PAY_PLAN           
!J.GVT_PAY_FLAG           
!J.GVT_NID_CHANGE 
! GEX ISDVNPK 08/27/2007              
J.UNION_FULL_PART        
J.UNION_POS              
J.MATRICULA_NBR          
J.SOC_SEC_RISK_CODE      
J.UNION_FEE_AMOUNT       
J.UNION_FEE_START_DT     
J.UNION_FEE_END_DT       
J.EXEMPT_JOB_LBR         
J.EXEMPT_HOURS_MONTH     
J.WRKS_CNCL_FUNCTION     
J.INTERCTR_WRKS_CNCL     
J.CURRENCY_CD1           
J.PAY_UNION_FEE          
J.UNION_CD               
J.BARG_UNIT              
J.UNION_SENIORITY_DT     
J.ENTRY_DATE             
J.LABOR_AGREEMENT        
J.EMPL_CTG               
J.EMPL_CTG_L1            
J.EMPL_CTG_L2            
J.SETID_LBR_AGRMNT 
! GEX ISDVNPK 08/27/2007     
J.WPP_STOP_FLAG                          
J.LABOR_FACILITY_ID                      
J.LBR_FAC_ENTRY_DT                       
J.LAYOFF_EXEMPT_FLAG                     
J.LAYOFF_EXEMPT_RSN                      
! GEX ISDVNPK 08/27/2007     
J.GP_PAYGROUP            
J.GP_DFLT_ELIG_GRP       
J.GP_ELIG_GRP            
J.GP_DFLT_CURRTTYP       
J.CUR_RT_TYPE            
J.GP_DFLT_EXRTDT         
J.GP_ASOF_DT_EXG_RT      
J.ADDS_TO_FTE_ACTUAL     
J.CLASS_INDC             
J.ENCUMB_OVERRIDE        
J.FICA_STATUS_EE         
J.FTE                    
J.PRORATE_CNT_AMT        
J.PAY_SYSTEM_FLG         
J.BORDER_WALKER          
J.LUMP_SUM_PAY           
J.CONTRACT_NUM           
J.JOB_INDICATOR          
J.WRKS_CNCL_ROLE_CHE     
!J.WRKS_CNCL_ID_LCL       
J.BENEFIT_SYSTEM         
J.WORK_DAY_HOURS      
! GEX ISDVNPK 08/27/2007 
J.HR_STATUS                              
J.APPT_TYPE                              
J.MAIN_APPT_NUM_JPN                      
! GEX ISDVNPK 08/27/2007 
J.REPORTS_TO             
J.FORCE_PUBLISH          
J.JOB_DATA_SRC_CD                                    !GBD 09/20/2002 nd
J.ESTABID
! GEX ISDVNPK 08/27/2007 
J.SUPV_LVL_ID                            
J.SETID_SUPV_LVL                         
J.ABSENCE_SYSTEM_CD                      
J.POI_TYPE                               
J.HIRE_DT                                
J.LAST_HIRE_DT                           
J.TERMINATION_DT                         
J.ASGN_START_DT                          
J.LST_ASGN_START_DT                      
J.ASGN_END_DT                            
J.LDW_OVR                                
J.LAST_DATE_WORKED                       
J.EXPECTED_RETURN_DT                     
J.EXPECTED_END_DATE                      
J.AUTO_END_FLG                           
J.LASTUPDDTTM                            
J.LASTUPDOPRID                           
! GEX ISDVNPK 08/27/2007 
J.GEX_LIGHT_DUTY
J.GEX_CHANGE_RECORD
J.GEX_VOLUN_LOW_HRS
J.GEX_STUDENT_IND
J.GEX_MOON_IND
J.GEX_DEPTID_OVR
J.GEX_ACCT_CD_OVR
J.GEX_GL_EXP_OVR
J.GEX_STEWARD
J.GEX_DUES_EXEMPT
J.GEX_FINAN_CORE
J.GEX_INFLATED_HRS
J.GEX_FP_CODE
J.GEX_SEASONAL_EMP	!AXL 5/14/2001 New job field
   move 'Y' to $found
   move &effseq to #effseq
!   move &J.EMPL_RCD to #empl_rcd

!GBD 08/26/2002 Begin
   Do select-current-job-jr-row
!GBD 08/26/2002 End
   
FROM PS_JOB J
WHERE J.EMPLID = $emplid
  AND J.EMPL_RCD = #EMPL_RCD
  AND J.EFFDT = 
       (SELECT MAX(EFFDT)
	  FROM PS_JOB 
	 WHERE EMPLID = $emplid
	   AND EMPL_RCD = #EMPL_RCD
	   AND EFFDT <= $effdt_dbf)
  AND J.EFFSEQ = 
       (SELECT MAX(EFFSEQ)
	  FROM PS_JOB
	 WHERE EMPLID = $emplid
	   AND EMPL_RCD = #EMPL_RCD         
	   AND J.EFFDT = EFFDT)
end-SELECT

if $found = 'N'
   do error-found
   print 'No Job information exists for the employee' (,34)
end-if
	   
end-procedure

!GBD 08/26/2002 Begin
!*********************************************************************
!Selects maximum effdt row for the employee
!*********************************************************************
begin-procedure select-current-job-jr-row
#debug9 show 'select-current-job-jr-row'

begin-select on-error=sql-error-found('select-current-job-jr-row')
J2.EMPLID                 
J2.EMPL_RCD               
J2.EFFDT                  
J2.EFFSEQ                 
J2.LASTUPDDTTM            
J2.LASTUPDOPRID           
J2.TAXCODE_UK             
J2.TAX_BASIS_UK           
J2.WORKER_TYPE_MEX        
J2.REDUCED_WEEK_MEX       
J2.LOCATED_CD_MEX         
J2.SALARY_TYPE_MEX        
J2.IMS_TERM_DT_MEX 
!GEX ISDVNPK 08/27/2007       
!J2.CASUAL_IND             
!J2.SALARY_PACKAGED        
!J2.PAYROLL_STATE_AUS      
!J2.CLASSN_CURRENT_AUS     
!J2.WORK_SECTOR_AUS        
!J2.FUNCTION_AUS           
!J2.ANN_CNTACT_HRS_AUS     
!J2.TEACH_WEEKS_AUS        
!J2.CASUAL_TYPE_AUS        
!J2.TERM_TYPE_AUS          
!J2.TERM_LTD_AUS   
!GEX ISDVNPK 08/27/2007               
J2.BALANCE_GRP_NUM        
J2.FP_ACTION_2            
J2.CTG_RATE               
J2.FP_LEGALSTAT_CD        
J2.FP_SCNDMT_CD           
J2.FP_SCND_TYP            
J2.FP_CIVIL_PENSION       
J2.FP_SOURCE_ORG          
J2.FP_RECEP_ORG           
J2.FP_RETURN_CD           
J2.FP_PR_LEGSTA           
J2.FP_FOREND_DT           
J2.FP_END_DT              
J2.FP_CAREFRZPCT          
J2.FP_HIR_DOS_SIT         
J2.FP_PT_PCT_DET          
J2.FP_TITLE_NUM           
J2.FP_DURATION_PCT        
J2.FP_RATING_PRS_FLG      
J2.FP_BUDGET_NBR          
J2.FP_HDCNT_NBR           
J2.FP_POTENT_NBR          
J2.FP_RANK_CD             
J2.FP_STEP_CD             
J2.FP_RK_ENT_DT           
J2.FP_CORPS_CD            
J2.FP_CHG_COR_DT          
J2.FP_CATG_FP             
J2.FP_CATG_LEVEL          
J2.FP_RK_TRIALPD          
J2.FP_STEP_END_DT         
J2.FP_FOR_PROM_DT         
J2.FP_NOMINATION_DT       
J2.FP_TRAINEE             
J2.FP_TRNE_POSN           
J2.FP_RK_PD_END_DT        
J2.FP_SANCTION            
J2.FP_DOWN_GRA            
J2.FP_APPL_SAL_DT         
J2.FP_CHG_IND             
J2.FP_CLD_INST            
J2.FP_SETID_RANK          
J2.FP_INSTALL_DT          
J2.FP_EQUIV_STEP          
J2.FP_STEP_CD2            
J2.FP_BUSINESS_CD         
J2.FP_APPL_DT             
J2.FP_CHG_SAL             
J2.FP_POINTYP_CD          
J2.FP_GROSS_IND           
J2.FP_INCS_IND            
J2.FP_INCS_IND2           
J2.FP_PT_PCT              
J2.FP_PT_END_DT           
J2.FP_PT_FOREND_DT        
J2.FP_COMPRATE            
J2.FP_INST_STAT           
J2.FP_RETROSPECT          
J2.FP_ROW_END_DT          
J2.LAST_UPDATE_DATE       
J2.OTHER_ID_JPN           
J2.INTCP_XFR_FLG          
J2.INTCP_XFR_START_DT     
J2.INTCP_XFR_END_DT       
J2.INTCP_BUS_UNIT         
J2.INTCP_DEPTID           
J2.INTCP_DEPTID2          
J2.INTCP_SETID_DEPT       
J2.INTCP_COMPANY          
J2.INTCP_COMPANY2         
J2.INTCP_SUPV_LVL_ID      
J2.INTCP_SUPV_LVL_ID2
!GEX ISDVNPK 08/27/2007  
J2.START_DATE_JPN                          
J2.EXP_END_DATE_JPN                        
J2.END_DATE_JPN                            
!J2.SUPV_LVL_ID            
!J2.EXPECTED_END_DATE      
!J2.AUTO_END_FLG  
!GEX ISDVNPK 08/27/2007           
J2.DUTIES_TYPE            
J2.ASSIGNMENT_ID          
J2.TARGET_COMPRATE        
J2.CMP_DONT_ABSORB        
J2.SSN_EMPLOYER           
J2.UNITA_PROD_CD          
J2.ACTION_ITA             
J2.ACTION_REASON_ITA      
J2.SPECIAL_HIRCTG_ITA     
J2.PART_TIME_TYPE_ITA     
J2.PART_TIME_PERC_ITA     
J2.PARTTIME_ENDDT_ITA   
!GEX ISDVNPK 08/27/2007   
J2.WORKDAYS_NLD                            
J2.CONT_SAL_TYPE_BRA                       
J2.CBO_CD_BRA                              
J2.SEFIP_CATEGORY_BRA                      
J2.UNION_CD_ALT_BRA   
!GEX ISDVNPK 08/27/2007 

FROM PS_JOB_JR J2
WHERE J2.EMPLID = $emplid
  AND J2.EMPL_RCD = #EMPL_RCD
  AND J2.EFFDT = 
       (SELECT MAX(EFFDT)
	  FROM PS_JOB_JR
	 WHERE EMPLID = $emplid
	   AND EMPL_RCD = #EMPL_RCD
! added 06/09/1998 - CJH
	   AND EFFDT <= $effdt_dbf)
! added 06/09/1998 - CJH
  AND J2.EFFSEQ = 
       (SELECT MAX(EFFSEQ)
	  FROM PS_JOB_JR
	 WHERE EMPLID = $emplid
	   AND EMPL_RCD = #EMPL_RCD         
	   AND EFFDT = J2.EFFDT)
end-select

end-procedure
!GBD 08/26/2002 End

!AXL 3/4/2003 Begin
!*********************************************************************
!Select the corresponding Current Compensation Row
!*********************************************************************
begin-procedure select-current-comp-row
#debug9 show 'select-current-comp-row'

   move 'N' to $found_comp
   move 'N' to $errorfound

begin-select on-error=sql-error-found('select-current-comp-row')

J3.EMPLID                 
J3.EMPL_RCD               
J3.EFFDT                  
J3.EFFSEQ                 
J3.COMP_EFFSEQ            
J3.COMP_RATECD            
J3.COMP_RATE_POINTS       
J3.COMPRATE               
J3.COMP_PCT               
J3.COMP_FREQUENCY         
J3.CURRENCY_CD            
J3.MANUAL_SW              
J3.CONVERT_COMPRT         
J3.RATE_CODE_GROUP        
J3.CHANGE_AMT             
J3.CHANGE_PCT             
J3.CHANGE_PTS             
J3.FTE_INDICATOR          
J3.CMP_SRC_IND          

   move 'Y' to $found_comp

FROM PS_COMPENSATION J3

  WHERE J3.EMPLID   = $emplid
  AND   J3.EMPL_RCD = #EMPL_RCD

  AND  J3.EFFDT =
       (SELECT MAX(EFFDT) FROM PS_COMPENSATION
       WHERE J3.EMPLID      = EMPLID
         AND J3.EMPL_RCD    = EMPL_RCD
         !AND J3.COMP_EFFSEQ = COMP_EFFSEQ	AXL 3/10/2003 Max row not returned
         !AND J3.COMP_RATECD = COMP_RATECD	AXL 3/10/2003 Max row not returned
         AND EFFDT <= $effdt_Dbf)
   AND J3.EFFSEQ = 
       (SELECT MAX(EFFSEQ) FROM PS_COMPENSATION
        WHERE J3.EMPLID      = EMPLID
         AND J3.EMPL_RCD    = EMPL_RCD
         !AND J3.COMP_EFFSEQ = COMP_EFFSEQ	AXL 3/10/2003 Max row not returned
         !AND J3.COMP_RATECD = COMP_RATECD	AXL 3/10/2003 Max row not returned
         AND J3.EFFDT = EFFDT)  

end-select

  if $found_comp = 'N'
     do error-found
     print 'No Compensation info exists for the employee' (,34)
  end-if

end-procedure
!AXL 3/4/2003 End


!*********************************************************************
!Inserts into the job table with new config2 value 
!*********************************************************************

begin-procedure insert-job-row



                      show  '&J.EMPLID,                              =  '&J.EMPLID                 
                      show  '&J.EMPL_RCD,                            =  '&J.EMPL_RCD               
                      show  '$effdt_dbf,                             =  '$effdt_dbf                
                      show  '0,                                      =  '                          
                      show  '&J.PER_ORG,                             =  '&J.PER_ORG                
                      show  '&J.DEPTID,                              =  '&J.DEPTID                 
                      show  '&J.JOBCODE,                             =  '&J.JOBCODE                
                      show  '&J.POSITION_NBR,                        =  '&J.POSITION_NBR           
                      show  '&J.SUPERVISOR_ID,                       =  '&J.SUPERVISOR_ID          
                      show  '&J.POSITION_OVERRIDE,                   =  '&J.POSITION_OVERRIDE      
                      show  '&J.POSN_CHANGE_RECORD,                  =  '&J.POSN_CHANGE_RECORD     
                      show  '&J.EMPL_STATUS,                         =  '&J.EMPL_STATUS            
                      show  'ATO,                                    =  '                          
                      show  '$reportdate_ccyy,                       =  '$reportdate_ccyy          
                      show  '$reason,                                =  '$reason                   
                      show  '&J.LOCATION,                            =  '&J.LOCATION               
                      show  '&J.TAX_LOCATION_cD,                     =  '&J.TAX_LOCATION_cD        
                      show  '&J.JOB_ENTRY_DT,                        =  '&J.JOB_ENTRY_DT           
                      show  '&J.DEPT_ENTRY_DT,                       =  '&J.DEPT_ENTRY_DT          
                      show  '&J.POSITION_ENTRY_DT,                   =  '&J.POSITION_ENTRY_DT      
                      show  '&J.SHIFT,                               =  '&J.SHIFT                  
                      show  '&J.REG_TEMP,                            =  '&J.REG_TEMP               
                      show  '&J.FULL_PART_TIME,                      =  '&J.FULL_PART_TIME         
                      show  '&J.COMPANY,                             =  '&J.COMPANY                
                      show  '&J.PAYGROUP,                            =  '&J.PAYGROUP               
                      show  '&J.BAS_GROUP_ID,                        =  '&J.BAS_GROUP_ID           
                      show  '$elig_config1,                          =  '$elig_config1             
                      show  '&J.ELIG_CONFIG2,                        =  '&J.ELIG_CONFIG2           
                      show  '&J.ELIG_CONFIG3,                        =  '&J.ELIG_CONFIG3           
                      show  '&J.ELIG_CONFIG4,                        =  '&J.ELIG_CONFIG4           
                      show  '&J.ELIG_CONFIG5,                        =  '&J.ELIG_CONFIG5           
                      show  '&J.ELIG_CONFIG6,                        =  '&J.ELIG_CONFIG6           
                      show  '&J.ELIG_CONFIG7,                        =  '&J.ELIG_CONFIG7           
                      show  '&J.ELIG_CONFIG8,                        =  '&J.ELIG_CONFIG8           
                      show  '&J.ELIG_CONFIG9,                        =  '&J.ELIG_CONFIG9           
                      show  '&J.BEN_STATUS,                          =  '&J.BEN_STATUS             
                      show  '&BAC.BAS_ACTION,                        =  '&BAC.BAS_ACTION           
                      show  '&J.COBRA_aCTION,                        =  '&J.COBRA_aCTION           
                      show  '&J.EMPL_TYPE,                           =  '&J.EMPL_TYPE              
                      show  '&J.HOLIDAY_SCHEDULE,                    =  '&J.HOLIDAY_SCHEDULE       
                      show  '&J.STD_HOURS,                           =  '&J.STD_HOURS              
                      show  '&J.STD_HRS_FREQUENCY,                   =  '&J.STD_HRS_FREQUENCY      
                      show  '&J.OFFICER_CD,                          =  '&J.OFFICER_CD             
                      show  '&J.EMPL_CLASS,                          =  '&J.EMPL_CLASS             
                      show  '&J.SAL_ADMIN_PLAN,                      =  '&J.SAL_ADMIN_PLAN         
                      show  '&J.GRADE,                               =  '&J.GRADE                  
                      show  '&J.GRADE_ENTRY_dT,                      =  '&J.GRADE_ENTRY_dT         
                      show  '&J.STEP,                                =  '&J.STEP                   
                      show  '&J.STEP_ENTRY_DT,                       =  '&J.STEP_ENTRY_DT          
                      show  '&J.GL_PAY_TYPE,                         =  '&J.GL_PAY_TYPE            
                      show  '&J.ACCT_cD,                             =  '&J.ACCT_cD                
                      show  '&J.EARNS_DIST_TYPE,                     =  '&J.EARNS_DIST_TYPE        
                      show  '&J.COMP_FREQUENCY,                      =  '&J.COMP_FREQUENCY         
                      show  '&J.COMPRATE,                            =  '&J.COMPRATE               
                      show  '&J.CHANGE_AMT,                          =  '&J.CHANGE_AMT             
                      show  '&J.CHANGE_PCT,                          =  '&J.CHANGE_PCT             
                      show  '&J.ANNUAL_RT,                           =  '&J.ANNUAL_RT              
                      show  '&J.MONTHLY_RT,                          =  '&J.MONTHLY_RT             
                      show  '&J.DAILY_RT,                            =  '&J.DAILY_RT               
                      show  '&J.HOURLY_RT,                           =  '&J.HOURLY_RT              
                      show  '&J.ANNL_BENEF_BASE_RT,                  =  '&J.ANNL_BENEF_BASE_RT     
                      show  '&J.SHIFT_RT,                            =  '&J.SHIFT_RT               
                      show  '&J.SHIFT_FACTOR,                        =  '&J.SHIFT_FACTOR           
                      show  '&J.CURRENCY_CD,                         =  '&J.CURRENCY_CD            
                      show  '&J.BUSINESS_UNIT,                       =  '&J.BUSINESS_UNIT          
                      show  '&J.SETID_DEPT,                          =  '&J.SETID_DEPT             
                      show  '&J.SETID_JOBCODE,                       =  '&J.SETID_JOBCODE          
                      show  '&J.SETID_LOCATION,                      =  '&J.SETID_LOCATION         
                      show  '&J.SETID_SALARY,                        =  '&J.SETID_SALARY           
                      show  '&J.REG_REGION,                          =  '&J.REG_REGION             
                      show  '&J.DIRECTLY_TIPPED,                     =  '&J.DIRECTLY_TIPPED        
                      show  '&J.FLSA_STATUS,                         =  '&J.FLSA_STATUS            
                      show  '&J.EEO_CLASS,                           =  '&J.EEO_CLASS              
                      show  '&J.FUNCTION_CD,                         =  '&J.FUNCTION_CD            
                      show  '&J.TARIFF_GER,                          =  '&J.TARIFF_GER             
                      show  '&J.TARIFF_AREA_GER,                     =  '&J.TARIFF_AREA_GER        
                      show  '&J.PERFORM_GROUP_GER,                   =  '&J.PERFORM_GROUP_GER      
                      show  '&J.LABOR_TYPE_GER,                      =  '&J.LABOR_TYPE_GER         
                      show  '&J.SPK_COMM_ID_GER,                     =  '&J.SPK_COMM_ID_GER        
                      show  '&J.HOURLY_RT_FRA,                       =  '&J.HOURLY_RT_FRA          
                      show  '&J.ACCDNT_CD_FRA,                       =  '&J.ACCDNT_CD_FRA          
                      show  '&J.VALUE_1_FRA,                         =  '&J.VALUE_1_FRA            
                      show  '&J.VALUE_2_FRA,                         =  '&J.VALUE_2_FRA            
                      show  '&J.VALUE_3_FRA,                         =  '&J.VALUE_3_FRA            
                      show  '&J.VALUE_4_FRA,                         =  '&J.VALUE_4_FRA            
                      show  '&J.VALUE_5_FRA,                         =  '&J.VALUE_5_FRA            
                      show  '&J.CTG_RATE,                            =  '&J.CTG_RATE               
                      show  '&J.PAID_HOURS,                          =  '&J.PAID_HOURS             
                      show  '&J.PAID_FTE,                            =  '&J.PAID_FTE               
                      show  '&J.PAID_HRS_FREQUENCY,                  =  '&J.PAID_HRS_FREQUENCY     
                      show  '&J.UNION_FULL_PART,                     =  '&J.UNION_FULL_PART        
                      show  '&J.UNION_POS,                           =  '&J.UNION_POS              
                      show  '&J.MATRICULA_NBR,                       =  '&J.MATRICULA_NBR          
                      show  '&J.SOC_SEC_RISK_CODE,                   =  '&J.SOC_SEC_RISK_CODE      
                      show  '&J.UNION_FEE_AMOUNT,                    =  '&J.UNION_FEE_AMOUNT       
                      show  '&J.UNION_FEE_START_DT,                  =  '&J.UNION_FEE_START_DT     
                      show  '&J.UNION_FEE_END_DT,                    =  '&J.UNION_FEE_END_DT       
                      show  '&J.EXEMPT_JOB_LBR,                      =  '&J.EXEMPT_JOB_LBR         
                      show  '&J.EXEMPT_HOURS_MONTH,                  =  '&J.EXEMPT_HOURS_MONTH     
                      show  '&J.WRKS_CNCL_FUNCTION,                  =  '&J.WRKS_CNCL_FUNCTION     
                      show  '&J.INTERCTR_WRKS_CNCL,                  =  '&J.INTERCTR_WRKS_CNCL     
                      show  '&J.CURRENCY_CD1,                        =  '&J.CURRENCY_CD1           
                      show  '&J.PAY_UNION_FEE,                       =  '&J.PAY_UNION_FEE          
                      show  '&J.UNION_CD,                            =  '&J.UNION_CD               
                      show  '&J.BARG_UNIT,                           =  '&J.BARG_UNIT              
                      show  '&J.UNION_SENIORITY_DT,                  =  '&J.UNION_SENIORITY_DT     
                      show  '&J.ENTRY_DATE,                          =  '&J.ENTRY_DATE             
                      show  '&J.LABOR_AGREEMENT,                     =  '&J.LABOR_AGREEMENT        
                      show  '&J.EMPL_CTG,                            =  '&J.EMPL_CTG               
                      show  '&J.EMPL_CTG_L1,                         =  '&J.EMPL_CTG_L1            
                      show  '&J.EMPL_CTG_L2,                         =  '&J.EMPL_CTG_L2            
                      show  '&J.SETID_LBR_AGRMNT,                    =  '&J.SETID_LBR_AGRMNT       
                      show  '&J.WPP_STOP_FLAG,                       =  '&J.WPP_STOP_FLAG          
                      show  '&J.LABOR_FACILITY_ID,                   =  '&J.LABOR_FACILITY_ID      
                      show  '&J.LBR_FAC_ENTRY_DT,                    =  '&J.LBR_FAC_ENTRY_DT       
                      show  '&J.LAYOFF_EXEMPT_FLAG,                  =  '&J.LAYOFF_EXEMPT_FLAG     
                      show  '&J.LAYOFF_EXEMPT_RSN,                   =  '&J.LAYOFF_EXEMPT_RSN      
                      show  '&J.GP_PAYGROUP,                         =  '&J.GP_PAYGROUP            
                      show  '&J.GP_DFLT_ELIG_GRP,                    =  '&J.GP_DFLT_ELIG_GRP       
                      show  '&J.GP_ELIG_GRP,                         =  '&J.GP_ELIG_GRP            
                      show  '&J.GP_DFLT_CURRTTYP,                    =  '&J.GP_DFLT_CURRTTYP       
                      show  '&J.CUR_RT_TYPE,                         =  '&J.CUR_RT_TYPE            
                      show  '&J.GP_DFLT_EXRTDT,                      =  '&J.GP_DFLT_EXRTDT         
                      show  '&J.GP_ASOF_DT_EXG_RT,                   =  '&J.GP_ASOF_DT_EXG_RT      
                      show  '&J.ADDS_TO_FTE_ACTUAL,                  =  '&J.ADDS_TO_FTE_ACTUAL     
                      show  '&J.CLASS_INDC,                          =  '&J.CLASS_INDC             
                      show  '&J.ENCUMB_OVERRIDE,                     =  '&J.ENCUMB_OVERRIDE        
                      show  '&J.FICA_STATUS_EE,                      =  '&J.FICA_STATUS_EE         
                      show  '&J.FTE,                                 =  '&J.FTE                    
                      show  '&J.PRORATE_CNT_AMT,                     =  '&J.PRORATE_CNT_AMT        
                      show  '&J.PAY_SYSTEM_FLG,                      =  '&J.PAY_SYSTEM_FLG         
                      show  '&J.BORDER_WALKER,                       =  '&J.BORDER_WALKER          
                      show  '&J.LUMP_SUM_PAY,                        =  '&J.LUMP_SUM_PAY           
                      show  '&J.CONTRACT_NUM,                        =  '&J.CONTRACT_NUM           
                      show  '&J.JOB_INDICATOR,                       =  '&J.JOB_INDICATOR          
                      show  '&J.WRKS_CNCL_ROLE_CHE,                  =  '&J.WRKS_CNCL_ROLE_CHE     
                      !show  '&J.WRKS_CNCL_ID_LCL,                    =  '&J.WRKS_CNCL_ID_LCL       
                      show  '&J.BENEFIT_SYSTEM,                      =  '&J.BENEFIT_SYSTEM         
                      show  '&J.WORK_DAY_HOURS,                      =  '&J.WORK_DAY_HOURS         
                      show  '&J.HR_STATUS,                           =  '&J.HR_STATUS              
                      show  '&J.APPT_TYPE,                           =  '&J.APPT_TYPE              
                      show  '&J.MAIN_APPT_NUM_JPN,                   =  '&J.MAIN_APPT_NUM_JPN      
                      show  '&J.REPORTS_TO,                          =  '&J.REPORTS_TO             
                      show  '&J.FORCE_PUBLISH,                       =  '&J.FORCE_PUBLISH          
                      show  '&J.JOB_DATA_SRC_CD,                     =  '&J.JOB_DATA_SRC_CD        
                      show  '&J.ESTABID,                             =  '&J.ESTABID                
                      show  '&J.SUPV_LVL_ID                          =  '&J.SUPV_LVL_ID            
                      show  ',&J.SETID_SUPV_LVL                      =  '&J.SETID_SUPV_LVL         
                      show  ',&J.ABSENCE_SYSTEM_CD                   =  '&J.ABSENCE_SYSTEM_CD      
                      show  ',&J.POI_TYPE                            =  '&J.POI_TYPE               
                      show  ',&J.HIRE_DT                             =  '&J.HIRE_DT                
                      show  ',&J.LAST_HIRE_DT                        =  '&J.LAST_HIRE_DT           
                      show  ',&J.TERMINATION_DT                      =  '&J.TERMINATION_DT         
                      show  ',&J.ASGN_START_DT                       =  '&J.ASGN_START_DT          
                      show  ',&J.LST_ASGN_START_DT                   =  '&J.LST_ASGN_START_DT      
                      show  ',&J.ASGN_END_DT                         =  '&J.ASGN_END_DT            
                      show  ',&J.LDW_OVR                             =  '&J.LDW_OVR                
                      show  '                                        =  '                          
                      show  ',&J.EXPECTED_RETURN_DT                  =  '&J.EXPECTED_RETURN_DT     
                      show  ',&J.EXPECTED_END_DATE                   =  '&J.EXPECTED_END_DATE      
                      show  ',&J.AUTO_END_FLG                        =  '&J.AUTO_END_FLG           
                      show  ',&J.LASTUPDDTTM                         =  '&J.LASTUPDDTTM            
                      show  ',&J.LASTUPDOPRID,                       =  '&J.LASTUPDOPRID           
                      show  '&J.GEX_LIGHT_DUTY,                      =  '&J.GEX_LIGHT_DUTY         
                      show  'Y,                                      =  '                          
                      show  '&J.GEX_VOLUN_LOW_HRS,                   =  '&J.GEX_VOLUN_LOW_HRS      
                      show  '&J.GEX_STUDENT_IND,                     =  '&J.GEX_STUDENT_IND        
                      show  '&J.GEX_MOON_IND,                        =  '&J.GEX_MOON_IND           
                      show  '&J.GEX_DEPTID_OVR,                      =  '&J.GEX_DEPTID_OVR         
                      show  '&J.GEX_ACCT_CD_OVR,                     =  '&J.GEX_ACCT_CD_OVR        
                      show  '&J.GEX_GL_EXP_OVR,                      =  '&J.GEX_GL_EXP_OVR         
                      show  '&J.GEX_STEWARD,                         =  '&J.GEX_STEWARD            
                      show  '&J.GEX_DUES_EXEMPT,                     =  '&J.GEX_DUES_EXEMPT        
                      show  '&J.GEX_FINAN_CORE,                      =  '&J.GEX_FINAN_CORE         
                      show  '&J.GEX_INFLATED_HRS,                    =  '&J.GEX_INFLATED_HRS       
                      show  '&J.GEX_FP_CODE,                         =  '&J.GEX_FP_CODE            
                      show  '&J.GEX_SEASONAL_EMP)                    =  '&J.GEX_SEASONAL_EMP       
                  
          
        
                       
display 'insert-job-row'
display 'config1 : ' noline
display $elig_config1  
begin-sql on-error=sql-error-found('insert-job-row')
                       
insert into PS_JOB     
(EMPLID                                 
,EMPL_RCD                               
,EFFDT                                  
,EFFSEQ                                 
,PER_ORG                                
,DEPTID                                 
,JOBCODE                                
,POSITION_NBR                           
,SUPERVISOR_ID                          
,POSITION_OVERRIDE                      
,POSN_CHANGE_RECORD                     
,EMPL_STATUS                            
,ACTION                                 
,ACTION_DT                              
,ACTION_REASON                          
,LOCATION                               
,TAX_LOCATION_CD                        
,JOB_ENTRY_DT                           
,DEPT_ENTRY_DT                          
,POSITION_ENTRY_DT                      
,SHIFT                                  
,REG_TEMP                               
,FULL_PART_TIME                         
,COMPANY                                
,PAYGROUP                               
,BAS_GROUP_ID                           
,ELIG_CONFIG1                           
,ELIG_CONFIG2                           
,ELIG_CONFIG3                           
,ELIG_CONFIG4                           
,ELIG_CONFIG5                           
,ELIG_CONFIG6                           
,ELIG_CONFIG7                           
,ELIG_CONFIG8                           
,ELIG_CONFIG9                           
,BEN_STATUS                             
,BAS_ACTION                             
,COBRA_ACTION                           
,EMPL_TYPE                              
,HOLIDAY_SCHEDULE                       
,STD_HOURS                              
,STD_HRS_FREQUENCY                      
,OFFICER_CD                             
,EMPL_CLASS                             
,SAL_ADMIN_PLAN                         
,GRADE                                  
,GRADE_ENTRY_DT                         
,STEP                                   
,STEP_ENTRY_DT                          
,GL_PAY_TYPE                            
,ACCT_CD                                
,EARNS_DIST_TYPE                        
,COMP_FREQUENCY                         
,COMPRATE                               
,CHANGE_AMT                             
,CHANGE_PCT                             
,ANNUAL_RT                              
,MONTHLY_RT                             
,DAILY_RT                               
,HOURLY_RT                              
,ANNL_BENEF_BASE_RT                     
,SHIFT_RT                               
,SHIFT_FACTOR                           
,CURRENCY_CD                            
,BUSINESS_UNIT                          
,SETID_DEPT                             
,SETID_JOBCODE                          
,SETID_LOCATION                         
,SETID_SALARY                           
,REG_REGION                             
,DIRECTLY_TIPPED                        
,FLSA_STATUS                            
,EEO_CLASS                              
,FUNCTION_CD                            
,TARIFF_GER                             
,TARIFF_AREA_GER                        
,PERFORM_GROUP_GER                      
,LABOR_TYPE_GER                         
,SPK_COMM_ID_GER                        
,HOURLY_RT_FRA                          
,ACCDNT_CD_FRA                          
,VALUE_1_FRA                            
,VALUE_2_FRA                            
,VALUE_3_FRA                            
,VALUE_4_FRA                            
,VALUE_5_FRA                            
,CTG_RATE                               
,PAID_HOURS                             
,PAID_FTE                               
,PAID_HRS_FREQUENCY                     
,UNION_FULL_PART                        
,UNION_POS                              
,MATRICULA_NBR                          
,SOC_SEC_RISK_CODE                      
,UNION_FEE_AMOUNT                       
,UNION_FEE_START_DT                     
,UNION_FEE_END_DT                       
,EXEMPT_JOB_LBR                         
,EXEMPT_HOURS_MONTH                     
,WRKS_CNCL_FUNCTION                     
,INTERCTR_WRKS_CNCL                     
,CURRENCY_CD1                           
,PAY_UNION_FEE                          
,UNION_CD                               
,BARG_UNIT                              
,UNION_SENIORITY_DT                     
,ENTRY_DATE                             
,LABOR_AGREEMENT                        
,EMPL_CTG                               
,EMPL_CTG_L1                            
,EMPL_CTG_L2                            
,SETID_LBR_AGRMNT                       
,WPP_STOP_FLAG                          
,LABOR_FACILITY_ID                      
,LBR_FAC_ENTRY_DT                       
,LAYOFF_EXEMPT_FLAG                     
,LAYOFF_EXEMPT_RSN                      
,GP_PAYGROUP                            
,GP_DFLT_ELIG_GRP                       
,GP_ELIG_GRP                            
,GP_DFLT_CURRTTYP                       
,CUR_RT_TYPE                            
,GP_DFLT_EXRTDT                         
,GP_ASOF_DT_EXG_RT                      
,ADDS_TO_FTE_ACTUAL                     
,CLASS_INDC                             
,ENCUMB_OVERRIDE                        
,FICA_STATUS_EE                         
,FTE                                    
,PRORATE_CNT_AMT                        
,PAY_SYSTEM_FLG                         
,BORDER_WALKER                          
,LUMP_SUM_PAY                           
,CONTRACT_NUM                           
,JOB_INDICATOR                          
,WRKS_CNCL_ROLE_CHE                     
,BENEFIT_SYSTEM                         
,WORK_DAY_HOURS                         
,HR_STATUS                              
,APPT_TYPE                              
,MAIN_APPT_NUM_JPN                      
,REPORTS_TO                             
,FORCE_PUBLISH                          
,JOB_DATA_SRC_CD                        
,ESTABID                                
,SUPV_LVL_ID                            
,SETID_SUPV_LVL                         
,ABSENCE_SYSTEM_CD                      
,POI_TYPE                               
,HIRE_DT                                
,LAST_HIRE_DT                           
,TERMINATION_DT                         
,ASGN_START_DT                          
,LST_ASGN_START_DT                      
,ASGN_END_DT                            
,LDW_OVR                                
,LAST_DATE_WORKED                       
,EXPECTED_RETURN_DT                     
,EXPECTED_END_DATE                      
,AUTO_END_FLG                           
,LASTUPDDTTM                            
,LASTUPDOPRID                           
,GEX_LIGHT_DUTY                         
,GEX_CHANGE_RECORD                      
,GEX_VOLUN_LOW_HRS                      
,GEX_STUDENT_IND                        
,GEX_MOON_IND                           
,GEX_DEPTID_OVR                         
,GEX_ACCT_CD_OVR                        
,GEX_GL_EXP_OVR                         
,GEX_STEWARD                            
,GEX_DUES_EXEMPT                        
,GEX_FINAN_CORE                         
,GEX_INFLATED_HRS                       
,GEX_FP_CODE                            
,GEX_SEASONAL_EMP)	!AXL 5/14/2001 New job field)
VALUES
(&J.EMPLID,
&J.EMPL_RCD,
$effdt_dbf,
0,
&J.PER_ORG, 
&J.DEPTID,
&J.JOBCODE,
&J.POSITION_NBR,
&J.SUPERVISOR_ID,
&J.POSITION_OVERRIDE,
&J.POSN_CHANGE_RECORD,
&J.EMPL_STATUS,
'ATO',
$reportdate_ccyy,
$reason,
&J.LOCATION,
&J.TAX_LOCATION_cD,
&J.JOB_ENTRY_DT,
&J.DEPT_ENTRY_DT,
&J.POSITION_ENTRY_DT,
&J.SHIFT,
&J.REG_TEMP,
&J.FULL_PART_TIME,
&J.COMPANY,
&J.PAYGROUP,
!GBD 08/01/2002 Begin - removed in v8
!SXK 11/09/1999 Begin
!&J.PIN_NUM,
!&J.PAY_BASIS_NUM,
!SXK 11/09/1999 End
!GBD 08/01/2002 End
&J.BAS_GROUP_ID,
$elig_config1,
&J.ELIG_CONFIG2,
&J.ELIG_CONFIG3,
&J.ELIG_CONFIG4,
&J.ELIG_CONFIG5,
&J.ELIG_CONFIG6,
&J.ELIG_CONFIG7,
&J.ELIG_CONFIG8,
&J.ELIG_CONFIG9,
&J.BEN_STATUS,
!SXK 11/09/1999 Begin
&BAC.BAS_ACTION,
!SXK 11/09/1999 End
&J.COBRA_aCTION,
&J.EMPL_TYPE,
&J.HOLIDAY_SCHEDULE,
&J.STD_HOURS,
&J.STD_HRS_FREQUENCY,         !GBD 08/01/2002 Field Added
&J.OFFICER_CD,
&J.EMPL_CLASS,
&J.SAL_ADMIN_PLAN,
&J.GRADE,
&J.GRADE_ENTRY_dT,
&J.STEP,
&J.STEP_ENTRY_DT,
&J.GL_PAY_TYPE,
&J.ACCT_cD,
&J.EARNS_DIST_TYPE,
!&J.SALARY_MATRIX_CD,
!&J.RATING_SCALE,
!&J.REVIEW_RATING,
!&J.REVIEW_DT,
&J.COMP_FREQUENCY,
&J.COMPRATE,
&J.CHANGE_AMT,
&J.CHANGE_PCT,
&J.ANNUAL_RT,
&J.MONTHLY_RT,
&J.DAILY_RT,                 !GBD 08/01/2002 Field Added
&J.HOURLY_RT,
&J.ANNL_BENEF_BASE_RT,
&J.SHIFT_RT,
&J.SHIFT_FACTOR,
&J.CURRENCY_CD,
!sxk 11/09/1999 Begin
&J.BUSINESS_UNIT,
&J.SETID_DEPT,
&J.SETID_JOBCODE,
&J.SETID_LOCATION,           !GBD 08/01/2002 Field Added
&J.SETID_SALARY,             !GBD 08/01/2002 Field Added
&J.REG_REGION,
&J.DIRECTLY_TIPPED,
!SXK 11/09/1999 End
&J.FLSA_STATUS,
&J.EEO_CLASS,
&J.FUNCTION_CD,
!GBD 08/01/2002 Begin - Fields Added
&J.TARIFF_GER,
&J.TARIFF_AREA_GER,
&J.PERFORM_GROUP_GER,
&J.LABOR_TYPE_GER,
&J.SPK_COMM_ID_GER,
!&J.WRKS_CNCL_MEM_GER,
!GBD 08/01/2002 End - Fields Added
&J.HOURLY_RT_FRA,
&J.ACCDNT_CD_FRA,
!GBD 08/01/2002 Begin -  Fields Added
&J.VALUE_1_FRA,
&J.VALUE_2_FRA,
&J.VALUE_3_FRA,
&J.VALUE_4_FRA,
&J.VALUE_5_FRA,
&J.CTG_RATE,
&J.PAID_HOURS,
&J.PAID_FTE,
&J.PAID_HRS_FREQUENCY,
!&J.GVT_EFFDT,              
!&J.GVT_EFFDT_PROPOSED,     
!&J.GVT_TRANS_NBR,          
!&J.GVT_TRANS_NBR_SEQ,      
!&J.GVT_WIP_STATUS,         
!&J.GVT_STATUS_TYPE,        
!&J.GVT_NOA_CODE,           
!&J.GVT_LEG_AUTH_1,         
!&J.GVT_PAR_AUTH_D1,        
!&J.GVT_PAR_AUTH_D1_2,     
!&J.GVT_LEG_AUTH_2,      
!&J.GVT_PAR_AUTH_D2,        
!&J.GVT_PAR_AUTH_D2_2,      
!&J.GVT_PAR_NTE_DATE,       
!&J.GVT_WORK_SCHED,        
!&J.GVT_SUB_AGENCY,         
!&J.GVT_ELIG_FEHB,          
!&J.GVT_FEHB_DT,            
!&J.GVT_PAY_RATE_DETER,     
!&J.GVT_STEP,               
!&J.GVT_RTND_PAY_PLAN,      
!&J.GVT_RTND_SAL_PLAN,      
!&J.GVT_RTND_GRADE,         
!&J.GVT_RTND_STEP,          
!&J.GVT_RTND_GVT_STEP,      
!&J.GVT_PAY_BASIS,          
!&J.GVT_COMPRATE,           
!&J.GVT_LOCALITY_ADJ,       
!&J.GVT_BIWEEKLY_RT,        
!&J.GVT_DAILY_RT,           
!&J.GVT_HRLY_RT_NO_LOC,     
!&J.GVT_DLY_RT_NO_LOC,      
!&J.GVT_BW_RT_NO_LOC,       
!&J.GVT_MNLY_RT_NO_LOC,     
!&J.GVT_ANNL_RT_NO_LOC,     
!&J.GVT_XFER_FROM_AGCY,     
!&J.GVT_XFER_TO_AGCY,       
!&J.GVT_RETIRE_PLAN,        
!&J.GVT_ANN_IND,            
!&J.GVT_FEGLI,              
!&J.GVT_FEGLI_LIVING,       
!&J.GVT_LIVING_AMT,         
!&J.GVT_ANNUITY_OFFSET,     
!&J.GVT_CSRS_FROZN_SVC,     
!&J.GVT_PREV_RET_COVRG,     
!&J.GVT_FERS_COVERAGE,      
!&J.GVT_TYPE_OF_APPT,       
!&J.GVT_POI,                
!&J.GVT_POSN_OCCUPIED,      
!&J.GVT_CONT_EMPLID,        
!&J.GVT_ROUTE_NEXT,         
!&J.GVT_CHANGE_FLAG,       
!&J.GVT_TSP_UPD_IND,        
!&J.GVT_PI_UPD_IND,         
!&J.GVT_SF52_NBR,           
!&J.GVT_S113G_CEILING,      
!&J.GVT_LEO_POSITION,      
!&J.GVT_ANNUIT_COM_DT,      
!&J.GVT_BASIC_LIFE_RED,     
!&J.GVT_DED_PRORT_DT,       
!&J.GVT_FEGLI_BASC_PCT,     
!&J.GVT_FEGLI_OPT_PCT,      
!&J.GVT_FEHB_PCT,           
!&J.GVT_RETRO_FLAG,         
!&J.GVT_RETRO_DED_FLAG,     
!&J.GVT_RETRO_JOB_FLAG,     
!&J.GVT_RETRO_BSE_FLAG,     
!&J.GVT_OTH_PAY_CHG,        
!&J.GVT_DETL_POSN_NBR,      
!&J.ANNL_BEN_BASE_OVRD,     
!&J.BENEFIT_PROGRAM,        
!&J.UPDATE_PAYROLL,         
!&J.GVT_PAY_PLAN,           
!&J.GVT_PAY_FLAG,           
!&J.GVT_NID_CHANGE, 
&J.UNION_FULL_PART,
&J.UNION_POS,
&J.MATRICULA_NBR,
&J.SOC_SEC_RISK_CODE,
&J.UNION_FEE_AMOUNT,
&J.UNION_FEE_START_DT,
&J.UNION_FEE_END_DT,
&J.EXEMPT_JOB_LBR,
&J.EXEMPT_HOURS_MONTH,
&J.WRKS_CNCL_FUNCTION,
&J.INTERCTR_WRKS_CNCL,
&J.CURRENCY_CD1,
&J.PAY_UNION_FEE,
&J.UNION_CD,
&J.BARG_UNIT,
&J.UNION_SENIORITY_DT,
&J.ENTRY_DATE,
&J.LABOR_AGREEMENT,
&J.EMPL_CTG,
&J.EMPL_CTG_L1,
&J.EMPL_CTG_L2,
&J.SETID_LBR_AGRMNT,
&J.WPP_STOP_FLAG,                          
&J.LABOR_FACILITY_ID,                      
&J.LBR_FAC_ENTRY_DT,                       
&J.LAYOFF_EXEMPT_FLAG,                   
&J.LAYOFF_EXEMPT_RSN,
&J.GP_PAYGROUP,
&J.GP_DFLT_ELIG_GRP,
&J.GP_ELIG_GRP,
&J.GP_DFLT_CURRTTYP,
&J.CUR_RT_TYPE,
&J.GP_DFLT_EXRTDT,
&J.GP_ASOF_DT_EXG_RT,
&J.ADDS_TO_FTE_ACTUAL,
&J.CLASS_INDC,
&J.ENCUMB_OVERRIDE,
&J.FICA_STATUS_EE,
&J.FTE,
&J.PRORATE_CNT_AMT,
&J.PAY_SYSTEM_FLG,
&J.BORDER_WALKER,
&J.LUMP_SUM_PAY,
&J.CONTRACT_NUM,
&J.JOB_INDICATOR,
&J.WRKS_CNCL_ROLE_CHE,
!&J.WRKS_CNCL_ID_LCL,
&J.BENEFIT_SYSTEM,
&J.WORK_DAY_HOURS,
&J.HR_STATUS,                             
&J.APPT_TYPE,                              
&J.MAIN_APPT_NUM_JPN, 
&J.REPORTS_TO,
&J.FORCE_PUBLISH,
&J.JOB_DATA_SRC_CD,
!GBD 08/01/2002 End
&J.ESTABID,
&J.SUPV_LVL_ID                            
,&J.SETID_SUPV_LVL                         
,&J.ABSENCE_SYSTEM_CD                      
,&J.POI_TYPE                               
,&J.HIRE_DT                                
,&J.LAST_HIRE_DT                           
,&J.TERMINATION_DT                         
,&J.ASGN_START_DT                          
,&J.LST_ASGN_START_DT                      
,&J.ASGN_END_DT                            
,&J.LDW_OVR                                
!&J.LAST_dATE_WORKED
,''                     
,&J.EXPECTED_RETURN_DT                     
,&J.EXPECTED_END_DATE                      
,&J.AUTO_END_FLG                           
,&J.LASTUPDDTTM                            
,&J.LASTUPDOPRID,    
&J.GEX_LIGHT_DUTY,
'Y',
&J.GEX_VOLUN_LOW_HRS,
&J.GEX_STUDENT_IND,
&J.GEX_MOON_IND,
&J.GEX_DEPTID_OVR,
&J.GEX_ACCT_CD_OVR,
&J.GEX_GL_EXP_OVR,
&J.GEX_STEWARD,
&J.GEX_DUES_EXEMPT,
&J.GEX_FINAN_CORE,
&J.GEX_INFLATED_HRS,
&J.GEX_FP_CODE,
&J.GEX_SEASONAL_EMP)	  !AXL 5/14/2001 New job field
end-sql

end-procedure

!GBD 08/01/2002 Begin
!*********************************************************************
!Inserts into the job_jr table to match job row with new config2 value 
!*********************************************************************
begin-procedure insert-job-jr-row
#debug9 show 'insert-job-jr-row'

begin-sql on-error=sql-error-found('insert-job-jr-row')

insert into PS_JOB_JR
(EMPLID                                  
,EMPL_RCD                                
,EFFDT                                   
,EFFSEQ                                  
,LASTUPDDTTM                             
,LASTUPDOPRID                            
,TAXCODE_UK                              
,TAX_BASIS_UK                            
,WORKER_TYPE_MEX                         
,REDUCED_WEEK_MEX                        
,LOCATED_CD_MEX                          
,SALARY_TYPE_MEX                         
,IMS_TERM_DT_MEX                         
,BALANCE_GRP_NUM                         
,FP_ACTION_2                             
,CTG_RATE                                
,FP_LEGALSTAT_CD                         
,FP_SCNDMT_CD                            
,FP_SCND_TYP                             
,FP_CIVIL_PENSION                        
,FP_SOURCE_ORG                           
,FP_RECEP_ORG                            
,FP_RETURN_CD                            
,FP_PR_LEGSTA                            
,FP_FOREND_DT                            
,FP_END_DT                               
,FP_CAREFRZPCT                           
,FP_HIR_DOS_SIT                          
,FP_PT_PCT_DET                           
,FP_TITLE_NUM                            
,FP_DURATION_PCT                         
,FP_RATING_PRS_FLG                       
,FP_BUDGET_NBR                           
,FP_HDCNT_NBR                            
,FP_POTENT_NBR                           
,FP_RANK_CD                              
,FP_STEP_CD                              
,FP_RK_ENT_DT                            
,FP_CORPS_CD                             
,FP_CHG_COR_DT                           
,FP_CATG_FP                              
,FP_CATG_LEVEL                           
,FP_RK_TRIALPD                           
,FP_STEP_END_DT                          
,FP_FOR_PROM_DT                          
,FP_NOMINATION_DT                        
,FP_TRAINEE                              
,FP_TRNE_POSN                            
,FP_RK_PD_END_DT                         
,FP_SANCTION                             
,FP_DOWN_GRA                             
,FP_APPL_SAL_DT                          
,FP_CHG_IND                              
,FP_CLD_INST                             
,FP_SETID_RANK                           
,FP_INSTALL_DT                           
,FP_EQUIV_STEP                           
,FP_STEP_CD2                             
,FP_BUSINESS_CD                          
,FP_APPL_DT                              
,FP_CHG_SAL                              
,FP_POINTYP_CD                           
,FP_GROSS_IND                            
,FP_INCS_IND                             
,FP_INCS_IND2                            
,FP_PT_PCT                               
,FP_PT_END_DT                            
,FP_PT_FOREND_DT                         
,FP_COMPRATE                             
,FP_INST_STAT                            
,FP_RETROSPECT                           
,FP_ROW_END_DT                           
,LAST_UPDATE_DATE                        
,OTHER_ID_JPN                            
,INTCP_XFR_FLG                           
,INTCP_XFR_START_DT                      
,INTCP_XFR_END_DT                        
,INTCP_BUS_UNIT                          
,INTCP_DEPTID                            
,INTCP_DEPTID2                           
,INTCP_SETID_DEPT                        
,INTCP_COMPANY                           
,INTCP_COMPANY2                          
,INTCP_SUPV_LVL_ID                       
,INTCP_SUPV_LVL_ID2                      
,START_DATE_JPN                          
,EXP_END_DATE_JPN                        
,END_DATE_JPN                            
,DUTIES_TYPE                             
,ASSIGNMENT_ID                           
,TARGET_COMPRATE                         
,CMP_DONT_ABSORB                         
,SSN_EMPLOYER                            
,UNITA_PROD_CD                           
,ACTION_ITA                              
,ACTION_REASON_ITA                       
,SPECIAL_HIRCTG_ITA                      
,PART_TIME_TYPE_ITA                      
,PART_TIME_PERC_ITA                      
,PARTTIME_ENDDT_ITA                      
,WORKDAYS_NLD                            
,CONT_SAL_TYPE_BRA                       
,CBO_CD_BRA                              
,SEFIP_CATEGORY_BRA                      
,UNION_CD_ALT_BRA
)
VALUES
(&J2.EMPLID,
&J2.EMPL_RCD,
$effdt_dbf,
0,
&J2.LASTUPDDTTM                             
,&J2.LASTUPDOPRID                            
,&J2.TAXCODE_UK                              
,&J2.TAX_BASIS_UK                            
,&J2.WORKER_TYPE_MEX                         
,&J2.REDUCED_WEEK_MEX                        
,&J2.LOCATED_CD_MEX                          
,&J2.SALARY_TYPE_MEX                         
,&J2.IMS_TERM_DT_MEX                         
,&J2.BALANCE_GRP_NUM                         
,&J2.FP_ACTION_2                             
,&J2.CTG_RATE                                
,&J2.FP_LEGALSTAT_CD                         
,&J2.FP_SCNDMT_CD                            
,&J2.FP_SCND_TYP                             
,&J2.FP_CIVIL_PENSION                        
,&J2.FP_SOURCE_ORG                           
,&J2.FP_RECEP_ORG                            
,&J2.FP_RETURN_CD                            
,&J2.FP_PR_LEGSTA                            
,&J2.FP_FOREND_DT                            
,&J2.FP_END_DT                               
,&J2.FP_CAREFRZPCT                           
,&J2.FP_HIR_DOS_SIT                          
,&J2.FP_PT_PCT_DET                           
,&J2.FP_TITLE_NUM                            
,&J2.FP_DURATION_PCT                         
,&J2.FP_RATING_PRS_FLG                       
,&J2.FP_BUDGET_NBR                           
,&J2.FP_HDCNT_NBR                            
,&J2.FP_POTENT_NBR                           
,&J2.FP_RANK_CD                              
,&J2.FP_STEP_CD                              
,&J2.FP_RK_ENT_DT                            
,&J2.FP_CORPS_CD                             
,&J2.FP_CHG_COR_DT                           
,&J2.FP_CATG_FP                              
,&J2.FP_CATG_LEVEL                           
,&J2.FP_RK_TRIALPD                           
,&J2.FP_STEP_END_DT                          
,&J2.FP_FOR_PROM_DT                          
,&J2.FP_NOMINATION_DT                        
,&J2.FP_TRAINEE                              
,&J2.FP_TRNE_POSN                            
,&J2.FP_RK_PD_END_DT                         
,&J2.FP_SANCTION                             
,&J2.FP_DOWN_GRA                             
,&J2.FP_APPL_SAL_DT                          
,&J2.FP_CHG_IND                              
,&J2.FP_CLD_INST                             
,&J2.FP_SETID_RANK                           
,&J2.FP_INSTALL_DT                           
,&J2.FP_EQUIV_STEP                           
,&J2.FP_STEP_CD2                             
,&J2.FP_BUSINESS_CD                          
,&J2.FP_APPL_DT                              
,&J2.FP_CHG_SAL                              
,&J2.FP_POINTYP_CD                           
,&J2.FP_GROSS_IND                            
,&J2.FP_INCS_IND                             
,&J2.FP_INCS_IND2                            
,&J2.FP_PT_PCT                               
,&J2.FP_PT_END_DT                            
,&J2.FP_PT_FOREND_DT                         
,&J2.FP_COMPRATE                             
,&J2.FP_INST_STAT                            
,&J2.FP_RETROSPECT                           
,&J2.FP_ROW_END_DT                           
,&J2.LAST_UPDATE_DATE                        
,&J2.OTHER_ID_JPN                            
,&J2.INTCP_XFR_FLG                           
,&J2.INTCP_XFR_START_DT                      
,&J2.INTCP_XFR_END_DT                        
,&J2.INTCP_BUS_UNIT                          
,&J2.INTCP_DEPTID                            
,&J2.INTCP_DEPTID2                           
,&J2.INTCP_SETID_DEPT                        
,&J2.INTCP_COMPANY                           
,&J2.INTCP_COMPANY2                          
,&J2.INTCP_SUPV_LVL_ID                       
,&J2.INTCP_SUPV_LVL_ID2                      
,&J2.START_DATE_JPN                          
,&J2.EXP_END_DATE_JPN                        
,&J2.END_DATE_JPN                            
,&J2.DUTIES_TYPE                             
,&J2.ASSIGNMENT_ID                           
,&J2.TARGET_COMPRATE                         
,&J2.CMP_DONT_ABSORB                         
,&J2.SSN_EMPLOYER                            
,&J2.UNITA_PROD_CD                           
,&J2.ACTION_ITA                              
,&J2.ACTION_REASON_ITA                       
,&J2.SPECIAL_HIRCTG_ITA                      
,&J2.PART_TIME_TYPE_ITA                      
,&J2.PART_TIME_PERC_ITA                      
,&J2.PARTTIME_ENDDT_ITA                      
,&J2.WORKDAYS_NLD                            
,&J2.CONT_SAL_TYPE_BRA                       
,&J2.CBO_CD_BRA                              
,&J2.SEFIP_CATEGORY_BRA                      
,&J2.UNION_CD_ALT_BRA
)
end-sql
end-procedure
!GBD 08/26/2002 End

!AXL 3/4/2003 Begin
!********************************************************************
begin-procedure insert-compensation-row
!********************************************************************
   #debug9 show 'insert-compensation-row'
begin-SQL on-error=sql-error-found('insert-compensation-row')
Insert into ps_compensation
(EMPLID,
EMPL_RCD,
EFFDT,
EFFSEQ,
COMP_EFFSEQ,
COMP_RATECD,
COMP_RATE_POINTS,
COMPRATE,
COMP_PCT,
COMP_FREQUENCY,
CURRENCY_CD,
MANUAL_SW,
CONVERT_COMPRT,
RATE_CODE_GROUP,
CHANGE_AMT,
CHANGE_PCT,
CHANGE_PTS,
FTE_INDICATOR,
CMP_SRC_IND
)
values
(&J3.EMPLID,                 
&J3.EMPL_RCD,               
$effdt_dbf,
0,      
&J3.COMP_EFFSEQ,            
&J3.COMP_RATECD,            
&J3.COMP_RATE_POINTS,       
&J3.COMPRATE,               
&J3.COMP_PCT,               
&J3.COMP_FREQUENCY,         
&J3.CURRENCY_CD,            
&J3.MANUAL_SW,              
&J3.CONVERT_COMPRT,         
&J3.RATE_CODE_GROUP,        
&J3.CHANGE_AMT,             
&J3.CHANGE_PCT,             
&J3.CHANGE_PTS,             
&J3.FTE_INDICATOR,          
&J3.CMP_SRC_IND   
)

end-sql
end-procedure
!AXL 03/4/2003 End

!*********************************************************************
!Inserts into job table with new config2 value
!*********************************************************************

begin-procedure insert-job-row-effdt-exists

display 'insert=job-row-effdt-exists***************************************************************'
display 'config1 : ' noline
display $elig_config1
let $temp_1to3 = substr($elig_config1,1,3)
let $temp_4to10 = substr(&I.ELIG_CONFIG1,4,7)
let $elig_config1 = $temp_1to3||$temp_4to10
display 'config1:' noline
display $elig_config1


                                                       



                                      show   '&I.EMPLID                       =  '  &I.EMPLID                             
                                      show   '&I.EMPL_RCD                     =  '  &I.EMPL_RCD                           
                                      show   '&I.EFFDT                        =  '  &I.EFFDT                              
                                      show   '#effseq                         =  '  #effseq                               
                                      show   '&I.PER_ORG                      =  '  &I.PER_ORG                            
                                      show   '&I.DEPTID                       =  '  &I.DEPTID                             
                                      show   '&I.JOBCODE                      =  '  &I.JOBCODE                            
                                      show   '&I.POSITION_NBR                 =  '  &I.POSITION_NBR                       
                                      show   '&I.SUPERVISOR_ID                =  '  &I.SUPERVISOR_ID                      
                                      show   '&I.POSITION_OVERRIDE            =  '  &I.POSITION_OVERRIDE                  
                                      show   '&I.POSN_CHANGE_RECORD           =  '  &I.POSN_CHANGE_RECORD                 
                                      show   '&I.EMPL_STATUS                  =  '  &I.EMPL_STATUS                        
                                      show   'ATO                             =  '                                        
                                      show   '$reportdate_ccyy                =  '  $reportdate_ccyy                      
                                      show   '$reason                         =  '  $reason                               
                                      show   '&I.LOCATION                     =  '  &I.LOCATION                           
                                      show   '&I.TAX_LOCATION_cD              =  '  &I.TAX_LOCATION_cD                    
                                      show   '&I.JOB_ENTRY_DT                 =  '  &I.JOB_ENTRY_DT                       
                                      show   '&I.DEPT_ENTRY_DT                =  '  &I.DEPT_ENTRY_DT                      
                                      show   '&I.POSITION_ENTRY_DT            =  '  &I.POSITION_ENTRY_DT                  
                                      show   '&I.SHIFT                        =  '  &I.SHIFT                              
                                      show   '&I.REG_TEMP                     =  '  &I.REG_TEMP                           
                                      show   '&I.FULL_PART_TIME               =  '  &I.FULL_PART_TIME                     
                                      show   '&I.COMPANY                      =  '  &I.COMPANY                            
                                      show   '&I.PAYGROUP                     =  '  &I.PAYGROUP                           
                                      show   '&I.BAS_GROUP_ID                 =  '  &I.BAS_GROUP_ID                       
                                      show   '$elig_config1                   =  '  $elig_config1                         
                                      show   '&I.ELIG_CONFIG2                 =  '  &I.ELIG_CONFIG2                       
                                      show   '&I.ELIG_CONFIG3                 =  '  &I.ELIG_CONFIG3                       
                                      show   '&I.ELIG_CONFIG4                 =  '  &I.ELIG_CONFIG4                       
                                      show   '&I.ELIG_CONFIG5                 =  '  &I.ELIG_CONFIG5                       
                                      show   '&I.ELIG_CONFIG6                 =  '  &I.ELIG_CONFIG6                       
                                      show   '&I.ELIG_CONFIG7                 =  '  &I.ELIG_CONFIG7                       
                                      show   '&I.ELIG_CONFIG8                 =  '  &I.ELIG_CONFIG8                       
                                      show   '&I.ELIG_CONFIG9                 =  '  &I.ELIG_CONFIG9                       
                                      show   '&I.BEN_STATUS                   =  '  &I.BEN_STATUS                         
                                      show   '&BAC.BAS_ACTION                 =  '  &BAC.BAS_ACTION                       
                                      show   '&I.COBRA_aCTION                 =  '  &I.COBRA_aCTION                       
                                      show   '&I.EMPL_TYPE                    =  '  &I.EMPL_TYPE                          
                                      show   '&I.HOLIDAY_SCHEDULE             =  '  &I.HOLIDAY_SCHEDULE                   
                                      show   '&I.STD_HOURS                    =  '  &I.STD_HOURS                          
                                      show   '&I.STD_HRS_FREQUENCY            =  '  &I.STD_HRS_FREQUENCY                  
                                      show   '&I.OFFICER_CD                   =  '  &I.OFFICER_CD                         
                                      show   '&I.EMPL_CLASS                   =  '  &I.EMPL_CLASS                         
                                      show   '&I.SAL_ADMIN_PLAN               =  '  &I.SAL_ADMIN_PLAN                     
                                      show   '&I.GRADE                        =  '  &I.GRADE                              
                                      show   '&I.GRADE_ENTRY_dT               =  '  &I.GRADE_ENTRY_dT                     
                                      show   '&I.STEP                         =  '  &I.STEP                               
                                      show   '&I.STEP_ENTRY_DT                =  '  &I.STEP_ENTRY_DT                      
                                      show   '&I.GL_PAY_TYPE                  =  '  &I.GL_PAY_TYPE                        
                                      show   '&I.ACCT_cD                      =  '  &I.ACCT_cD                            
                                      show   '&I.EARNS_DIST_TYPE              =  '  &I.EARNS_DIST_TYPE                    
                                      show   '&I.COMP_FREQUENCY               =  '  &I.COMP_FREQUENCY                     
                                      show   '&I.COMPRATE                     =  '  &I.COMPRATE                           
                                      show   '&I.CHANGE_AMT                   =  '  &I.CHANGE_AMT                         
                                      show   '&I.CHANGE_PCT                   =  '  &I.CHANGE_PCT                         
                                      show   '&I.ANNUAL_RT                    =  '  &I.ANNUAL_RT                          
                                      show   '&I.MONTHLY_RT                   =  '  &I.MONTHLY_RT                         
                                      show   '&I.DAILY_RT                     =  '  &I.DAILY_RT                           
                                      show   '&I.HOURLY_RT                    =  '  &I.HOURLY_RT                          
                                      show   '&I.ANNL_BENEF_BASE_RT           =  '  &I.ANNL_BENEF_BASE_RT                 
                                      show   '&I.SHIFT_RT                     =  '  &I.SHIFT_RT                           
                                      show   '&I.SHIFT_FACTOR                 =  '  &I.SHIFT_FACTOR                       
                                      show   '&I.CURRENCY_CD                  =  '  &I.CURRENCY_CD                        
                                      show   '&I.BUSINESS_UNIT                =  '  &I.BUSINESS_UNIT                      
                                      show   '&I.SETID_DEPT                   =  '  &I.SETID_DEPT                         
                                      show   '&I.SETID_JOBCODE                =  '  &I.SETID_JOBCODE                      
                                      show   '&I.SETID_LOCATION               =  '  &I.SETID_LOCATION                     
                                      show   '&I.SETID_SALARY                 =  '  &I.SETID_SALARY                       
                                      show   '&I.REG_REGION                   =  '  &I.REG_REGION                         
                                      show   '&I.DIRECTLY_TIPPED              =  '  &I.DIRECTLY_TIPPED                    
                                      show   '&I.FLSA_STATUS                  =  '  &I.FLSA_STATUS                        
                                      show   '&I.EEO_CLASS                    =  '  &I.EEO_CLASS                          
                                      show   '&I.FUNCTION_CD                  =  '  &I.FUNCTION_CD                        
                                      show   '&I.TARIFF_GER                   =  '  &I.TARIFF_GER                         
                                      show   '&I.TARIFF_AREA_GER              =  '  &I.TARIFF_AREA_GER                    
                                      show   '&I.PERFORM_GROUP_GER            =  '  &I.PERFORM_GROUP_GER                  
                                      show   '&I.LABOR_TYPE_GER               =  '  &I.LABOR_TYPE_GER                     
                                      show   '&I.SPK_COMM_ID_GER              =  '  &I.SPK_COMM_ID_GER                    
                                      show   '&I.HOURLY_RT_FRA                =  '  &I.HOURLY_RT_FRA                      
                                      show   '&I.ACCDNT_CD_FRA                =  '  &I.ACCDNT_CD_FRA                      
                                      show   '&I.VALUE_1_FRA                  =  '  &I.VALUE_1_FRA                        
                                      show   '&I.VALUE_2_FRA                  =  '  &I.VALUE_2_FRA                        
                                      show   '&I.VALUE_3_FRA                  =  '  &I.VALUE_3_FRA                        
                                      show   '&I.VALUE_4_FRA                  =  '  &I.VALUE_4_FRA                        
                                      show   '&I.VALUE_5_FRA                  =  '  &I.VALUE_5_FRA                        
                                      show   '&I.CTG_RATE                     =  '  &I.CTG_RATE                           
                                      show   '&I.PAID_HOURS                   =  '  &I.PAID_HOURS                         
                                      show   '&I.PAID_FTE                     =  '  &I.PAID_FTE                           
                                      show   '&I.PAID_HRS_FREQUENCY           =  '  &I.PAID_HRS_FREQUENCY                 
                                      show   '&I.UNION_FULL_PART              =  '  &I.UNION_FULL_PART                    
                                      show   '&I.UNION_POS                    =  '  &I.UNION_POS                          
                                      show   '&I.MATRICULA_NBR                =  '  &I.MATRICULA_NBR                      
                                      show   '&I.SOC_SEC_RISK_CODE            =  '  &I.SOC_SEC_RISK_CODE                  
                                      show   '&I.UNION_FEE_AMOUNT             =  '  &I.UNION_FEE_AMOUNT                   
                                      show   '&I.UNION_FEE_START_DT           =  '  &I.UNION_FEE_START_DT                 
                                      show   '&I.UNION_FEE_END_DT             =  '  &I.UNION_FEE_END_DT                   
                                      show   '&I.EXEMPT_JOB_LBR               =  '  &I.EXEMPT_JOB_LBR                     
                                      show   '&I.EXEMPT_HOURS_MONTH           =  '  &I.EXEMPT_HOURS_MONTH                 
                                      show   '&I.WRKS_CNCL_FUNCTION           =  '  &I.WRKS_CNCL_FUNCTION                 
                                      show   '&I.INTERCTR_WRKS_CNCL           =  '  &I.INTERCTR_WRKS_CNCL                 
                                      show   '&I.CURRENCY_CD1                 =  '  &I.CURRENCY_CD1                       
                                      show   '&I.PAY_UNION_FEE                =  '  &I.PAY_UNION_FEE                      
                                      show   '&I.UNION_CD                     =  '  &I.UNION_CD                           
                                      show   '&I.BARG_UNIT                    =  '  &I.BARG_UNIT                          
                                      show   '&I.UNION_SENIORITY_DT           =  '  &I.UNION_SENIORITY_DT                 
                                      show   '&I.ENTRY_DATE                   =  '  &I.ENTRY_DATE                         
                                      show   '&I.LABOR_AGREEMENT              =  '  &I.LABOR_AGREEMENT                    
                                      show   '&I.EMPL_CTG                     =  '  &I.EMPL_CTG                           
                                      show   '&I.EMPL_CTG_L1                  =  '  &I.EMPL_CTG_L1                        
                                      show   '&I.EMPL_CTG_L2                  =  '  &I.EMPL_CTG_L2                        
                                      show   '&I.SETID_LBR_AGRMNT             =  '  &I.SETID_LBR_AGRMNT                   
                                      show   '&I.WPP_STOP_FLAG                =  '  &I.WPP_STOP_FLAG                      
                                      show   '&I.LABOR_FACILITY_ID            =  '  &I.LABOR_FACILITY_ID                  
                                      show   '&I.LBR_FAC_ENTRY_DT             =  '  &I.LBR_FAC_ENTRY_DT                   
                                      show   '&I.LAYOFF_EXEMPT_FLAG           =  '  &I.LAYOFF_EXEMPT_FLAG                 
                                      show   '&I.LAYOFF_EXEMPT_RSN            =  '  &I.LAYOFF_EXEMPT_RSN                  
                                      show   '&I.GP_PAYGROUP                  =  '  &I.GP_PAYGROUP                        
                                      show   '&I.GP_DFLT_ELIG_GRP             =  '  &I.GP_DFLT_ELIG_GRP                   
                                      show   '&I.GP_ELIG_GRP                  =  '  &I.GP_ELIG_GRP                        
                                      show   '&I.GP_DFLT_CURRTTYP             =  '  &I.GP_DFLT_CURRTTYP                   
                                      show   '&I.CUR_RT_TYPE                  =  '  &I.CUR_RT_TYPE                        
                                      show   '&I.GP_DFLT_EXRTDT               =  '  &I.GP_DFLT_EXRTDT                     
                                      show   '&I.GP_ASOF_DT_EXG_RT            =  '  &I.GP_ASOF_DT_EXG_RT                  
                                      show   '&I.ADDS_TO_FTE_ACTUAL           =  '  &I.ADDS_TO_FTE_ACTUAL                 
                                      show   '&I.CLASS_INDC                   =  '  &I.CLASS_INDC                         
                                      show   '&I.ENCUMB_OVERRIDE              =  '  &I.ENCUMB_OVERRIDE                    
                                      show   '&I.FICA_STATUS_EE               =  '  &I.FICA_STATUS_EE                     
                                      show   '&I.FTE                          =  '  &I.FTE                                
                                      show   '&I.PRORATE_CNT_AMT              =  '  &I.PRORATE_CNT_AMT                    
                                      show   '&I.PAY_SYSTEM_FLG               =  '  &I.PAY_SYSTEM_FLG                     
                                      show   '&I.BORDER_WALKER                =  '  &I.BORDER_WALKER                      
                                      show   '&I.LUMP_SUM_PAY                 =  '  &I.LUMP_SUM_PAY                       
                                      show   '&I.CONTRACT_NUM                 =  '  &I.CONTRACT_NUM                       
                                      show   '&I.JOB_INDICATOR                =  '  &I.JOB_INDICATOR                      
                                      show   '&I.WRKS_CNCL_ROLE_CHE           =  '  &I.WRKS_CNCL_ROLE_CHE                 
                                      show   '&I.BENEFIT_SYSTEM               =  '  &I.BENEFIT_SYSTEM                     
                                      show   '&I.WORK_DAY_HOURS               =  '  &I.WORK_DAY_HOURS                     
                                      show   '&I.HR_STATUS                    =  '  &I.HR_STATUS                          
                                      show   '&I.APPT_TYPE                    =  '  &I.APPT_TYPE                          
                                      show   '&I.MAIN_APPT_NUM_JPN            =  '  &I.MAIN_APPT_NUM_JPN                  
                                      show   '&I.REPORTS_TO                   =  '  &I.REPORTS_TO                         
                                      show   '&I.FORCE_PUBLISH                =  '  &I.FORCE_PUBLISH                      
                                      show   '&I.JOB_DATA_SRC_CD              =  '  &I.JOB_DATA_SRC_CD                    
                                      show   '&I.ESTABID                      =  '  &I.ESTABID                            
                                      show   '&I.SUPV_LVL_ID                  =  '  &I.SUPV_LVL_ID                        
                                      show   '&I.SETID_SUPV_LVL               =  '  &I.SETID_SUPV_LVL                     
                                      show   '&I.ABSENCE_SYSTEM_CD            =  '  &I.ABSENCE_SYSTEM_CD                  
                                      show   '&I.POI_TYPE                     =  '  &I.POI_TYPE                           
                                      show   '&I.HIRE_DT                      =  '  &I.HIRE_DT                            
                                      show   '&I.LAST_HIRE_DT                 =  '  &I.LAST_HIRE_DT                       
                                      show   '&I.TERMINATION_DT               =  '  &I.TERMINATION_DT                     
                                      show   '&I.ASGN_START_DT                =  '  &I.ASGN_START_DT                      
                                      show   '&I.LST_ASGN_START_DT            =  '  &I.LST_ASGN_START_DT                  
                                      show   '&I.ASGN_END_DT                  =  '  &I.ASGN_END_DT                        
                                      show   '&I.LDW_OVR                      =  '  &I.LDW_OVR                            
                                      show   '                                =  '                                        
                                      show   '&I.EXPECTED_RETURN_DT           =  '  &I.EXPECTED_RETURN_DT                 
                                      show   '&I.EXPECTED_END_DATE            =  '  &I.EXPECTED_END_DATE                  
                                      show   '&I.AUTO_END_FLG                 =  '  &I.AUTO_END_FLG                       
                                      show   '&I.LASTUPDDTTM                  =  '  &I.LASTUPDDTTM                        
                                      show   '&I.LASTUPDOPRID                 =  '  &I.LASTUPDOPRID                       
                                      show   '&I.GEX_LIGHT_DUTY               =  '  &I.GEX_LIGHT_DUTY                     
                                      show   '                                =  '                                        
                                      show   '&I.GEX_VOLUN_LOW_HRS            =  '  &I.GEX_VOLUN_LOW_HRS                  
                                      show   '&I.GEX_STUDENT_IND              =  '  &I.GEX_STUDENT_IND                    
                                      show   '&I.GEX_MOON_IND                 =  '  &I.GEX_MOON_IND                       
                                      show   '&I.GEX_DEPTID_OVR               =  '  &I.GEX_DEPTID_OVR                     
                                      show   '&I.GEX_ACCT_CD_OVR              =  '  &I.GEX_ACCT_CD_OVR                    
                                      show   '&I.GEX_GL_EXP_OVR               =  '  &I.GEX_GL_EXP_OVR                     
                                      show   '&I.GEX_STEWARD                  =  '  &I.GEX_STEWARD                        
                                      show   '&I.GEX_DUES_EXEMPT              =  '  &I.GEX_DUES_EXEMPT                    
                                      show   '&I.GEX_FINAN_CORE               =  '  &I.GEX_FINAN_CORE                     
                                      show   '&I.GEX_INFLATED_HRS             =  '  &I.GEX_INFLATED_HRS                   
                                      show   '&I.GEX_FP_CODE                  =  '  &I.GEX_FP_CODE                        
                                      show   '&I.GEX_SEASONAL_EMP             =  '  &I.GEX_SEASONAL_EMP                   



begin-sql on-error=sql-error-found('insert-job-row-effdt-exists')

INSERT INTO PS_JOB
(EMPLID                                 
,EMPL_RCD                               
,EFFDT                                  
,EFFSEQ                                 
,PER_ORG                                
,DEPTID                                 
,JOBCODE                                
,POSITION_NBR                           
,SUPERVISOR_ID                          
,POSITION_OVERRIDE                      
,POSN_CHANGE_RECORD                     
,EMPL_STATUS                            
,ACTION                                 
,ACTION_DT                              
,ACTION_REASON                          
,LOCATION                               
,TAX_LOCATION_CD                        
,JOB_ENTRY_DT                           
,DEPT_ENTRY_DT                          
,POSITION_ENTRY_DT                      
,SHIFT                                  
,REG_TEMP                               
,FULL_PART_TIME                         
,COMPANY                                
,PAYGROUP                               
,BAS_GROUP_ID                           
,ELIG_CONFIG1                           
,ELIG_CONFIG2                           
,ELIG_CONFIG3                           
,ELIG_CONFIG4                           
,ELIG_CONFIG5                           
,ELIG_CONFIG6                           
,ELIG_CONFIG7                           
,ELIG_CONFIG8                           
,ELIG_CONFIG9                           
,BEN_STATUS                             
,BAS_ACTION                             
,COBRA_ACTION                           
,EMPL_TYPE                              
,HOLIDAY_SCHEDULE                       
,STD_HOURS                              
,STD_HRS_FREQUENCY                      
,OFFICER_CD                             
,EMPL_CLASS                             
,SAL_ADMIN_PLAN                         
,GRADE                                  
,GRADE_ENTRY_DT                         
,STEP                                   
,STEP_ENTRY_DT                          
,GL_PAY_TYPE                            
,ACCT_CD                                
,EARNS_DIST_TYPE                        
,COMP_FREQUENCY                         
,COMPRATE                               
,CHANGE_AMT                             
,CHANGE_PCT                             
,ANNUAL_RT                              
,MONTHLY_RT                             
,DAILY_RT                               
,HOURLY_RT                              
,ANNL_BENEF_BASE_RT                     
,SHIFT_RT                               
,SHIFT_FACTOR                           
,CURRENCY_CD                            
,BUSINESS_UNIT                          
,SETID_DEPT                             
,SETID_JOBCODE                          
,SETID_LOCATION                         
,SETID_SALARY                           
,REG_REGION                             
,DIRECTLY_TIPPED                        
,FLSA_STATUS                            
,EEO_CLASS                              
,FUNCTION_CD                            
,TARIFF_GER                             
,TARIFF_AREA_GER                        
,PERFORM_GROUP_GER                      
,LABOR_TYPE_GER                         
,SPK_COMM_ID_GER                        
,HOURLY_RT_FRA                          
,ACCDNT_CD_FRA                          
,VALUE_1_FRA                            
,VALUE_2_FRA                            
,VALUE_3_FRA                            
,VALUE_4_FRA                            
,VALUE_5_FRA                            
,CTG_RATE                               
,PAID_HOURS                             
,PAID_FTE                               
,PAID_HRS_FREQUENCY                     
,UNION_FULL_PART                        
,UNION_POS                              
,MATRICULA_NBR                          
,SOC_SEC_RISK_CODE                      
,UNION_FEE_AMOUNT                       
,UNION_FEE_START_DT                     
,UNION_FEE_END_DT                       
,EXEMPT_JOB_LBR                         
,EXEMPT_HOURS_MONTH                     
,WRKS_CNCL_FUNCTION                     
,INTERCTR_WRKS_CNCL                     
,CURRENCY_CD1                           
,PAY_UNION_FEE                          
,UNION_CD                               
,BARG_UNIT                              
,UNION_SENIORITY_DT                     
,ENTRY_DATE                             
,LABOR_AGREEMENT                        
,EMPL_CTG                               
,EMPL_CTG_L1                            
,EMPL_CTG_L2                            
,SETID_LBR_AGRMNT                       
,WPP_STOP_FLAG                          
,LABOR_FACILITY_ID                      
,LBR_FAC_ENTRY_DT                       
,LAYOFF_EXEMPT_FLAG                     
,LAYOFF_EXEMPT_RSN                      
,GP_PAYGROUP                            
,GP_DFLT_ELIG_GRP                       
,GP_ELIG_GRP                            
,GP_DFLT_CURRTTYP                       
,CUR_RT_TYPE                            
,GP_DFLT_EXRTDT                         
,GP_ASOF_DT_EXG_RT                      
,ADDS_TO_FTE_ACTUAL                     
,CLASS_INDC                             
,ENCUMB_OVERRIDE                        
,FICA_STATUS_EE                         
,FTE                                    
,PRORATE_CNT_AMT                        
,PAY_SYSTEM_FLG                         
,BORDER_WALKER                          
,LUMP_SUM_PAY                           
,CONTRACT_NUM                           
,JOB_INDICATOR                          
,WRKS_CNCL_ROLE_CHE                     
,BENEFIT_SYSTEM                         
,WORK_DAY_HOURS                         
,HR_STATUS                              
,APPT_TYPE                              
,MAIN_APPT_NUM_JPN                      
,REPORTS_TO                             
,FORCE_PUBLISH                          
,JOB_DATA_SRC_CD                        
,ESTABID                                
,SUPV_LVL_ID                            
,SETID_SUPV_LVL                         
,ABSENCE_SYSTEM_CD                      
,POI_TYPE                               
,HIRE_DT                                
,LAST_HIRE_DT                           
,TERMINATION_DT                         
,ASGN_START_DT                          
,LST_ASGN_START_DT                      
,ASGN_END_DT                            
,LDW_OVR                                
,LAST_DATE_WORKED                       
,EXPECTED_RETURN_DT                     
,EXPECTED_END_DATE                      
,AUTO_END_FLG                           
,LASTUPDDTTM                            
,LASTUPDOPRID                           
,GEX_LIGHT_DUTY                         
,GEX_CHANGE_RECORD                      
,GEX_VOLUN_LOW_HRS                      
,GEX_STUDENT_IND                        
,GEX_MOON_IND                           
,GEX_DEPTID_OVR                         
,GEX_ACCT_CD_OVR                        
,GEX_GL_EXP_OVR                         
,GEX_STEWARD                            
,GEX_DUES_EXEMPT                        
,GEX_FINAN_CORE                         
,GEX_INFLATED_HRS                       
,GEX_FP_CODE                            
,GEX_SEASONAL_EMP)	!AXL 5/14/2001 New job field
VALUES
(&I.EMPLID,
&I.EMPL_RCD,
&I.EFFDT,
#effseq,
&I.PER_ORG,
&I.DEPTID,
&I.JOBCODE,
&I.POSITION_NBR,
&I.SUPERVISOR_ID,
&I.POSITION_OVERRIDE,
&I.POSN_CHANGE_RECORD,
&I.EMPL_STATUS,
'ATO',
$reportdate_ccyy,
$reason,
&I.LOCATION,
&I.TAX_LOCATION_CD,                  !ISDVMXR FIXED COLUMN NAME
&I.JOB_ENTRY_DT,
&I.DEPT_ENTRY_DT,
&I.POSITION_ENTRY_DT,
&I.SHIFT,
&I.REG_TEMP,
&I.FULL_PART_TIME,
&I.COMPANY,
&I.PAYGROUP,
&I.BAS_GROUP_ID,
$elig_config1,
&I.ELIG_CONFIG2,
&I.ELIG_CONFIG3,
&I.ELIG_CONFIG4,
&I.ELIG_CONFIG5,
&I.ELIG_CONFIG6,
&I.ELIG_CONFIG7,
&I.ELIG_CONFIG8,
&I.ELIG_CONFIG9,
&I.BEN_STATUS,
&BAC.BAS_ACTION,
&I.COBRA_aCTION,
&I.EMPL_TYPE,
&I.HOLIDAY_SCHEDULE,
&I.STD_HOURS,
&I.STD_HRS_FREQUENCY,         !GBD 08/01/2002 Field Added
&I.OFFICER_CD,
&I.EMPL_CLASS,
&I.SAL_ADMIN_PLAN,
&I.GRADE,
&I.GRADE_ENTRY_dT,
&I.STEP,
&I.STEP_ENTRY_DT,
&I.GL_PAY_TYPE,
&I.ACCT_CD,                      !ISDVMXR FIXED COLUMN NAME
&I.EARNS_DIST_TYPE,
&I.COMP_FREQUENCY,
&I.COMPRATE,
&I.CHANGE_AMT,
&I.CHANGE_PCT,
&I.ANNUAL_RT,
&I.MONTHLY_RT,
&I.DAILY_RT,                 !GBD 08/01/2002 Field Added
&I.HOURLY_RT,
&I.ANNL_BENEF_BASE_RT,
&I.SHIFT_RT,
&I.SHIFT_FACTOR,
&I.CURRENCY_CD,
&I.BUSINESS_UNIT,
&I.SETID_DEPT,
&I.SETID_JOBCODE,
&I.SETID_LOCATION,           !GBD 08/01/2002 Field Added
&I.SETID_SALARY,             !GBD 08/01/2002 Field Added
&I.REG_REGION,
&I.DIRECTLY_TIPPED,
&I.FLSA_STATUS,
&I.EEO_CLASS,
&I.FUNCTION_CD,
&I.TARIFF_GER,
&I.TARIFF_AREA_GER,
&I.PERFORM_GROUP_GER,
&I.LABOR_TYPE_GER,
&I.SPK_COMM_ID_GER,
&I.HOURLY_RT_FRA,
&I.ACCDNT_CD_FRA,
&I.VALUE_1_FRA,
&I.VALUE_2_FRA,
&I.VALUE_3_FRA,
&I.VALUE_4_FRA,
&I.VALUE_5_FRA,
&I.CTG_RATE,
&I.PAID_HOURS,
&I.PAID_FTE,
&I.PAID_HRS_FREQUENCY,
&I.UNION_FULL_PART,
&I.UNION_POS,
&I.MATRICULA_NBR,
&I.SOC_SEC_RISK_CODE,
&I.UNION_FEE_AMOUNT,
&I.UNION_FEE_START_DT,
&I.UNION_FEE_END_DT,
&I.EXEMPT_JOB_LBR,
&I.EXEMPT_HOURS_MONTH,
&I.WRKS_CNCL_FUNCTION,
&I.INTERCTR_WRKS_CNCL,
&I.CURRENCY_CD1,
&I.PAY_UNION_FEE,
&I.UNION_CD,
&I.BARG_UNIT,
&I.UNION_SENIORITY_DT,
&I.ENTRY_DATE,
&I.LABOR_AGREEMENT,
&I.EMPL_CTG,
&I.EMPL_CTG_L1,
&I.EMPL_CTG_L2,
&I.SETID_LBR_AGRMNT,
&I.WPP_STOP_FLAG,                         
&I.LABOR_FACILITY_ID,                      
&I.LBR_FAC_ENTRY_DT,                      
&I.LAYOFF_EXEMPT_FLAG,                     
&I.LAYOFF_EXEMPT_RSN, 
&I.GP_PAYGROUP,
&I.GP_DFLT_ELIG_GRP,
&I.GP_ELIG_GRP,
&I.GP_DFLT_CURRTTYP,
&I.CUR_RT_TYPE,
&I.GP_DFLT_EXRTDT,
&I.GP_ASOF_DT_EXG_RT,
&I.ADDS_TO_FTE_ACTUAL,
&I.CLASS_INDC,
&I.ENCUMB_OVERRIDE,
&I.FICA_STATUS_EE,
&I.FTE,
&I.PRORATE_CNT_AMT,
&I.PAY_SYSTEM_FLG,
&I.BORDER_WALKER,
&I.LUMP_SUM_PAY,
&I.CONTRACT_NUM,
&I.JOB_INDICATOR,
&I.WRKS_CNCL_ROLE_CHE,
&I.BENEFIT_SYSTEM,
&I.WORK_DAY_HOURS,
&I.HR_STATUS,                              
&I.APPT_TYPE,                             
&I.MAIN_APPT_NUM_JPN,    
&I.REPORTS_TO,
&I.FORCE_PUBLISH,
&I.JOB_DATA_SRC_CD,
&I.ESTABID,
&I.SUPV_LVL_ID,                            
&I.SETID_SUPV_LVL                         
,&I.ABSENCE_SYSTEM_CD                      
,&I.POI_TYPE                               
,&I.HIRE_DT                                
,&I.LAST_HIRE_DT                           
,&I.TERMINATION_DT                         
,&I.ASGN_START_DT                          
,&I.LST_ASGN_START_DT                      
,&I.ASGN_END_DT                            
,&I.LDW_OVR                                
,''                       
,&I.EXPECTED_RETURN_DT                     
,&I.EXPECTED_END_DATE                      
,&I.AUTO_END_FLG                           
,&I.LASTUPDDTTM                            
,&I.LASTUPDOPRID,        
&I.GEX_LIGHT_DUTY,
'Y',
&I.GEX_VOLUN_LOW_HRS,
&I.GEX_STUDENT_IND,
&I.GEX_MOON_IND,
&I.GEX_DEPTID_OVR,
&I.GEX_ACCT_CD_OVR,
&I.GEX_GL_EXP_OVR,
&I.GEX_STEWARD,
&I.GEX_DUES_EXEMPT,
&I.GEX_FINAN_CORE,
&I.GEX_INFLATED_HRS,
&I.GEX_FP_CODE,
&I.GEX_SEASONAL_EMP)	!AXL 5/14/2001 New job field
end-sql

end-procedure

!GBD 08/26/2002 Begin
!*********************************************************************
!Inserts into the job_jr table to match job row with new config2 value 
!*********************************************************************
begin-procedure insert-job-jr-row-effdt-exists
#debug9 show 'insert-job-jr-row-effdt-exists'

begin-sql on-error=sql-error-found('insert-job-jr-row-effdt-exists')

insert into PS_JOB_JR
(EMPLID                                  
,EMPL_RCD                                
,EFFDT                                   
,EFFSEQ                                  
,LASTUPDDTTM                             
,LASTUPDOPRID                            
,TAXCODE_UK                              
,TAX_BASIS_UK                            
,WORKER_TYPE_MEX                         
,REDUCED_WEEK_MEX                        
,LOCATED_CD_MEX                          
,SALARY_TYPE_MEX                         
,IMS_TERM_DT_MEX                         
,BALANCE_GRP_NUM                         
,FP_ACTION_2                             
,CTG_RATE                                
,FP_LEGALSTAT_CD                         
,FP_SCNDMT_CD                            
,FP_SCND_TYP                             
,FP_CIVIL_PENSION                        
,FP_SOURCE_ORG                           
,FP_RECEP_ORG                            
,FP_RETURN_CD                            
,FP_PR_LEGSTA                            
,FP_FOREND_DT                            
,FP_END_DT                               
,FP_CAREFRZPCT                           
,FP_HIR_DOS_SIT                          
,FP_PT_PCT_DET                           
,FP_TITLE_NUM                            
,FP_DURATION_PCT                         
,FP_RATING_PRS_FLG                       
,FP_BUDGET_NBR                           
,FP_HDCNT_NBR                            
,FP_POTENT_NBR                           
,FP_RANK_CD                              
,FP_STEP_CD                              
,FP_RK_ENT_DT                            
,FP_CORPS_CD                             
,FP_CHG_COR_DT                           
,FP_CATG_FP                              
,FP_CATG_LEVEL                           
,FP_RK_TRIALPD                           
,FP_STEP_END_DT                          
,FP_FOR_PROM_DT                          
,FP_NOMINATION_DT                        
,FP_TRAINEE                              
,FP_TRNE_POSN                            
,FP_RK_PD_END_DT                         
,FP_SANCTION                             
,FP_DOWN_GRA                             
,FP_APPL_SAL_DT                          
,FP_CHG_IND                              
,FP_CLD_INST                             
,FP_SETID_RANK                           
,FP_INSTALL_DT                           
,FP_EQUIV_STEP                           
,FP_STEP_CD2                             
,FP_BUSINESS_CD                          
,FP_APPL_DT                              
,FP_CHG_SAL                              
,FP_POINTYP_CD                           
,FP_GROSS_IND                            
,FP_INCS_IND                             
,FP_INCS_IND2                            
,FP_PT_PCT                               
,FP_PT_END_DT                            
,FP_PT_FOREND_DT                         
,FP_COMPRATE                             
,FP_INST_STAT                            
,FP_RETROSPECT                           
,FP_ROW_END_DT                           
,LAST_UPDATE_DATE                        
,OTHER_ID_JPN                            
,INTCP_XFR_FLG                           
,INTCP_XFR_START_DT                      
,INTCP_XFR_END_DT                        
,INTCP_BUS_UNIT                          
,INTCP_DEPTID                            
,INTCP_DEPTID2                           
,INTCP_SETID_DEPT                        
,INTCP_COMPANY                           
,INTCP_COMPANY2                          
,INTCP_SUPV_LVL_ID                       
,INTCP_SUPV_LVL_ID2                      
,START_DATE_JPN                          
,EXP_END_DATE_JPN                        
,END_DATE_JPN                            
,DUTIES_TYPE                             
,ASSIGNMENT_ID                           
,TARGET_COMPRATE                         
,CMP_DONT_ABSORB                         
,SSN_EMPLOYER                            
,UNITA_PROD_CD                           
,ACTION_ITA                              
,ACTION_REASON_ITA                       
,SPECIAL_HIRCTG_ITA                      
,PART_TIME_TYPE_ITA                      
,PART_TIME_PERC_ITA                      
,PARTTIME_ENDDT_ITA                      
,WORKDAYS_NLD                            
,CONT_SAL_TYPE_BRA                       
,CBO_CD_BRA                              
,SEFIP_CATEGORY_BRA                      
,UNION_CD_ALT_BRA
)
VALUES
(&I2.EMPLID,
&I2.EMPL_RCD,
&I2.EFFDT,
#effseq,
&I2.LASTUPDDTTM                             
,&I2.LASTUPDOPRID                            
,&I2.TAXCODE_UK                              
,&I2.TAX_BASIS_UK                            
,&I2.WORKER_TYPE_MEX                         
,&I2.REDUCED_WEEK_MEX                        
,&I2.LOCATED_CD_MEX                          
,&I2.SALARY_TYPE_MEX                         
,&I2.IMS_TERM_DT_MEX                         
,&I2.BALANCE_GRP_NUM                         
,&I2.FP_ACTION_2                             
,&I2.CTG_RATE                                
,&I2.FP_LEGALSTAT_CD                         
,&I2.FP_SCNDMT_CD                            
,&I2.FP_SCND_TYP                             
,&I2.FP_CIVIL_PENSION                        
,&I2.FP_SOURCE_ORG                           
,&I2.FP_RECEP_ORG                            
,&I2.FP_RETURN_CD                            
,&I2.FP_PR_LEGSTA                            
,&I2.FP_FOREND_DT                            
,&I2.FP_END_DT                               
,&I2.FP_CAREFRZPCT                           
,&I2.FP_HIR_DOS_SIT                          
,&I2.FP_PT_PCT_DET                           
,&I2.FP_TITLE_NUM                            
,&I2.FP_DURATION_PCT                         
,&I2.FP_RATING_PRS_FLG                       
,&I2.FP_BUDGET_NBR                           
,&I2.FP_HDCNT_NBR                            
,&I2.FP_POTENT_NBR                           
,&I2.FP_RANK_CD                              
,&I2.FP_STEP_CD                              
,&I2.FP_RK_ENT_DT                            
,&I2.FP_CORPS_CD                             
,&I2.FP_CHG_COR_DT                           
,&I2.FP_CATG_FP                              
,&I2.FP_CATG_LEVEL                           
,&I2.FP_RK_TRIALPD                           
,&I2.FP_STEP_END_DT                          
,&I2.FP_FOR_PROM_DT                          
,&I2.FP_NOMINATION_DT                        
,&I2.FP_TRAINEE                              
,&I2.FP_TRNE_POSN                            
,&I2.FP_RK_PD_END_DT                         
,&I2.FP_SANCTION                             
,&I2.FP_DOWN_GRA                             
,&I2.FP_APPL_SAL_DT                          
,&I2.FP_CHG_IND                              
,&I2.FP_CLD_INST                             
,&I2.FP_SETID_RANK                           
,&I2.FP_INSTALL_DT                           
,&I2.FP_EQUIV_STEP                           
,&I2.FP_STEP_CD2                             
,&I2.FP_BUSINESS_CD                          
,&I2.FP_APPL_DT                              
,&I2.FP_CHG_SAL                              
,&I2.FP_POINTYP_CD                           
,&I2.FP_GROSS_IND                            
,&I2.FP_INCS_IND                             
,&I2.FP_INCS_IND2                            
,&I2.FP_PT_PCT                               
,&I2.FP_PT_END_DT                            
,&I2.FP_PT_FOREND_DT                         
,&I2.FP_COMPRATE                             
,&I2.FP_INST_STAT                            
,&I2.FP_RETROSPECT                           
,&I2.FP_ROW_END_DT                           
,&I2.LAST_UPDATE_DATE                        
,&I2.OTHER_ID_JPN                            
,&I2.INTCP_XFR_FLG                           
,&I2.INTCP_XFR_START_DT                      
,&I2.INTCP_XFR_END_DT                        
,&I2.INTCP_BUS_UNIT                          
,&I2.INTCP_DEPTID                            
,&I2.INTCP_DEPTID2                           
,&I2.INTCP_SETID_DEPT                        
,&I2.INTCP_COMPANY                           
,&I2.INTCP_COMPANY2                          
,&I2.INTCP_SUPV_LVL_ID                       
,&I2.INTCP_SUPV_LVL_ID2                      
,&I2.START_DATE_JPN                          
,&I2.EXP_END_DATE_JPN                        
,&I2.END_DATE_JPN                            
,&I2.DUTIES_TYPE                             
,&I2.ASSIGNMENT_ID                           
,&I2.TARGET_COMPRATE                         
,&I2.CMP_DONT_ABSORB                         
,&I2.SSN_EMPLOYER                            
,&I2.UNITA_PROD_CD                           
,&I2.ACTION_ITA                              
,&I2.ACTION_REASON_ITA                       
,&I2.SPECIAL_HIRCTG_ITA                      
,&I2.PART_TIME_TYPE_ITA                      
,&I2.PART_TIME_PERC_ITA                      
,&I2.PARTTIME_ENDDT_ITA                      
,&I2.WORKDAYS_NLD                            
,&I2.CONT_SAL_TYPE_BRA                       
,&I2.CBO_CD_BRA                              
,&I2.SEFIP_CATEGORY_BRA                      
,&I2.UNION_CD_ALT_BRA
)
end-sql
end-procedure
!GBD 08/26/2002 End

!AXL 3/4/2003 Begin
!********************************************************************
begin-procedure insert-compensation-row-effdt-exists
!********************************************************************
#debug9 show 'insert-compensation-row-effdt-exists'

begin-SQL on-error=sql-error-found('insert-compensation-row-effdt-exists')
Insert into ps_compensation
(EMPLID,
EMPL_RCD,
EFFDT,
EFFSEQ,
COMP_EFFSEQ,
COMP_RATECD,
COMP_RATE_POINTS,
COMPRATE,
COMP_PCT,
COMP_FREQUENCY,
CURRENCY_CD,
MANUAL_SW,
CONVERT_COMPRT,
RATE_CODE_GROUP,
CHANGE_AMT,
CHANGE_PCT,
CHANGE_PTS,
FTE_INDICATOR,
CMP_SRC_IND)
values
(&I3.EMPLID,                 
&I3.EMPL_RCD,               
&I3.EFFDT,                  
#effseq_comp,                
&I3.COMP_EFFSEQ,            
&I3.COMP_RATECD,            
&I3.COMP_RATE_POINTS,       
&I3.COMPRATE,               
&I3.COMP_PCT,               
&I3.COMP_FREQUENCY,         
&I3.CURRENCY_CD,            
&I3.MANUAL_SW,              
&I3.CONVERT_COMPRT,         
&I3.RATE_CODE_GROUP,        
&I3.CHANGE_AMT,             
&I3.CHANGE_PCT,             
&I3.CHANGE_PTS,             
&I3.FTE_INDICATOR,          
&I3.CMP_SRC_IND            
)
end-sql
end-procedure
!AXL 3/4/2003 End

!*********************************************************************
!Updates the BAS_DATA_CHG field on the personal data table
!*********************************************************************

!begin-procedure update-personal-data

!display 'In updating personal data'

!begin-sql on-error=sql-error-found('update-personal-data')
!UPDATE PS_PERSONAL_DATA
!   SET BAS_DATA_CHG = 'Y'
!WHERE EMPLID = $emplid
!end-sql
!SXK 11/09/1999 Begin
!move 'Y' to $update-is-done
!End-Procedure

!*********************************************************************
!Updates future job rows
!*********************************************************************
Begin-Procedure select-all-future-job-rows


!SXK 11/09/1999 End
begin-SELECT on-error=sql-error-found('select-all-future-job-rows')
JJJ.emplid
JJJ.empl_rcd
JJJ.effdt
JJJ.effseq
JJJ.elig_config1
  display 'Future Effdt:' noline
  display &jjj.effdt
  let $new_elig_cfg1 = substr($elig_config1,1,3)||substr(&JJJ.elig_config1,4,7)  
  display 'Old config1:' noline
  display &jjj.elig_config1
  display 'New config1:' noline
  display $new_elig_cfg1
  do update-job2
  
from PS_JOB JJJ
where JJJ.emplid = $emplid
  AND JJJ.EMPL_RCD = #empl_rcd
  AND JJJ.EFFDT > $effdt_dbf

end-SELECT
!SXK 11/09/1999 Begin
!move 'Y' to $update-is-done
!SXK 11/09/1999 End
end-procedure

begin-procedure update-job2
begin-sql on-error=sql-error-found('update-future-job-rows')
UPDATE PS_JOB
   SET ELIG_CONFIG1 = $new_elig_cfg1
WHERE EMPLID = &JJJ.emplid
  AND EMPL_RCD = &JJJ.EMPL_RCD
  AND EFFDT = &JJJ.EFFDT
  AND EFFSEQ = &JJJ.effseq
end-sql
end-procedure
!SXK 11/09/1999 Begin
!*******************************************************************
!Retrieves Bas Action Value from Action Reason Table
!*******************************************************************
Begin-Procedure get-bas-action

begin-select on-error=sql-error-found('Get-Bas-Action')
BAC.BAS_ACTION
  let $bas_action_retrieved = 'Y'
FROM PS_ACT_RSN_TBL_NA BAC   ! PS_ACTN_REASON_TBL BAC GEX ISDVNPK 08/27/2007
WHERE BAC.ACTION = 'ATO'
AND BAC.ACTION_REASON = $reason
AND BAC.EFFDT = (select max(effdt)
		from PS_ACT_RSN_TBL_NA  ! PS_ACTN_REASON_TBL GEX ISDVNPK 08/27/2007
		where action = bac.action
		and action_Reason = bac.action_reason
		and effdt <= $effdt_dbf)
end-select
end-procedure

!********************************************************************
!Check to see if bas_activity already exists
!********************************************************************
begin-procedure select-bas-activity-row

Begin-Select on-error=sql-error-found('Select-Bas-Activity-Row')
'BAC'
    let $bas_activity_exists = 'Y'
FROM PS_BAS_ACTIVITY BAC1
WHERE BAC1.EMPLID = $bac_emplid
and bac1.empl_rcd = #bac_empl_rcd
and bac1.bas_action_source = $bac_bas_action_source
and bac1.event_dt = $bac_event_dt
and bac1.event_effseq = #bac_event_effseq
end-select
end-procedure

!*******************************************************************
!Inserts into BAS_ACTIVITY table
!*******************************************************************
begin-procedure insert-bas-activity-row


do select-benefit-rcdnum

begin-sql on-error=sql-error-found('Insert-Bas-Activity-Row')
INSERT INTO PS_BAS_ACTIVITY
(EMPLID,
EMPL_RCD,
BAS_ACTION_SOURCE,
EVENT_DT,
EVENT_EFFSEQ,
BAS_ACTION,
BENEFIT_RCD_NBR,
COBRA_ACTION,
BAS_ALL_JOBS,                            !GBD 08/26/2002 Field Added
BAS_SUPPRESS_FORMS)                      !GBD 01/03/2003
VALUES(
$bac_emplid,
#bac_empl_rcd,
$bac_bas_action_source,
$bac_event_dt,
#bac_event_effseq,
&BAC.BAS_ACTION,
#bac_benefit_rcd,
$bac_cobra_action,
' ',                                     !GBD 08/26/2002 Field Added
' ')                                     !GBD 01/03/2003
end-sql
end-procedure

!********************************************************************
!Selects Employment.benefit_rcd_nbr
!********************************************************************
Begin-Procedure Select-Benefit-RcdNum
let #bac_benefit_rcd = 0
begin-select on-error=sql-error-found('Select-Benefit-RcdNum')
EBAC.BENEFIT_RCD_NBR
 move &EBAC.BENEFIT_RCD_NBR to #bac_benefit_rcd
FROM PS_EMPLOYMENT EBAC
WHERE EBAC.EMPLID = $bac_emplid
and ebac.empl_rcd = #bac_empl_rcd
end-select
end-procedure

!SXK 11/09/1999 End


!********************************************************************
!This procedure displays in the error report if there are any sql erros
!happened in the program
!********************************************************************

begin-procedure SQL-Error-Found($Proc_Name) 

  do error-found
  print 'SQL Error in ' (,34)
  print $Proc_Name ()  
  print $_sql-error () 
  print 'sql-status:' ()
  print #_sql-status () edit 99999 

end-procedure

!*********************************************************************
!This procedure displays the error message for the records that are in
!progress
!*********************************************************************

begin-procedure Error-Found

  move 'Y' to $ErrorFound
  use-report report-log
  do Format-Number(#InputTran, $out, '99999')
  print $out (+1,1)
  !GEX_SEC_REENG 2016-06-02 Vahini Katta Begins
  !let $EmplId_1st3 = substr($EmplId,1,3)
  !let $EmplId_mid2 = substr($EmplId,4,2)
  !let $EmplId_last4 = substr($EmplId,6,4)
 
  !String $EmplId_1st3 $EmplID_mid2 $EmplId_last4 by '-' into $EmplId11

  !print $EmplID11 (,16)
  print $EmplId (,16)
  !GEX_SEC_REENG 2016-06-02 Vahini Katta Ends
end-procedure

