!***********************************************************************
!  GEXPL009:  RMC Health & Welfare Report                              *
!***********************************************************************
!                                                                      *
!               Confidentiality Information:                           *
!                                                                      *
! This module is the confidential and proprietary information of       *
! Giant Eagle, Inc.; it is not to be copied, reproduced,or transmitted *
! in any form, by any means, in whole or in part, nor is it to be used *
! for any purpose other than that for which it is expressly provided   *
! without the written permission of Giant Eagle.                       *
!                                                                      *
! Copyright (c) 1997-1998 Giant Eagle,Inc. All Rights Reserved         *
!                                                                      *
!***********************************************************************
!                                                                      *
! GEXPL009:             RMC Health & Welfare Report                    *
!                                                                      *
! Narrative:		This program creates a monthly report for      *
!                       RMC that contains employee information         *
!                       required by the union to administer the        *
!                       Health & Welfare benefit.                      *
!                                                                      *
! #Debugx Used:		#debug9 paragraph trace                        *
!                       #debug8 key variable values                    *
!                       #debug7 data returned from sql calls           *
!                                                                      *
! SQL Tables:           pay_calendar                                   *
!                       ben_defn_optn                                  *
!                       ben_defn_pgm                                   *
!                       personal_data                                  *
!                       employment                                     *
!                       job                                            *
!                       benef_plan_tbl                                 *
!                       earnings_bal                                   *
!                       pay_line                                       *
!                       pay_check                                      *
!                       pay_deduction                                  *
!                       health_benefit                                 *
!                                                                      *
! Written by:           Jim Hutchison                                  *
!                                                                      *
! Normally Run:	        Monthly                                        *
!                                                                      *
! Control Parms:        FOR WHERE CLAUSE:                              *
!                         Plan Type(s)                                 *
!                         Vendor ID(s)                                 *
!                                                                      *
!***********************************************************************
!                         MODIFICATION HISTORY                         *
!***********************************************************************
!  INITIALS   DATE       DESCRIPTION OF THE CHANGE                     *
!***********************************************************************
!  JDH        02/10/99   Initial Creation                              *
!                                                                      *
!  JDH        02/26/99   Pull pay_check rows by the check date of the  *
!                          pay end rather than the check date of the   *
!                          pay_check row.                              *
!                        Add descending sort on effseq.                *
!                                                                      *
!  JDH        03/01/99   Added missing line to select.                 *
!                        Modified logic to get hours for the month of  *
!                          the last confirmed pay end date minus one   *
!                          pay period.                                 *
!                        Modified logic to get deduction for the month *
!                          of the check date associated with the last  *
!                          confirmed pay period.                       *
!                                                                      *
!  JDH        04/13/99   Get the effdt, action, action_reason from     *
!                          the job row that originally set the         *
!                          empl_status to its current value for        *
!                          empl_status in ('L','P','R','T').           *
!                                                                      *
!  JDH        06/29/99   Changed logic to get action, action_reason,   *
!                          effdt.                                      *
!  SXK        11/23/99   Changed ssn to emplid                         *
!  GBD        07/15/02   Added Fieldvalue to effective dated selection *
!                        of the Load-Lookup procedure.                 *
!                        Corrected spacing issue with report output.   *
!  GBD        09/12/02   v8.3 Upgrade - Vendor ID field changed to     *
!                        Vendor ID.                                    *
!                                                                      *
!  GBD        10/16/02   Modify select statement to join BEN_DEFN_PGM  *
!                        to BEN_DEFN_OPTN by Benefit_Program and Effdt *
!                        only to avoid multiple row selection.         *
!                                                                      *
!  AXL        06/01/04   Changed the setup sqc. Doublespaced the       *
!                        output.  Add GEX_INFLATED                     *
! GEX-CXB   10/05/2007   Upgrade 9.0 Changes.	         	       *
!GEX-RBC    11/19/2007      Made Changes to display the date in the    * 
!				format mm/dd/yy.                       *
! KXY	     08/26/2009		Done the changes as per ITG 65625      *
! KXY	     09/25/2009		Done the changes for ITG 67439         *
! KXY      12/08/2009   Done the changes for ITG 70473	               *
!                           when store changes in month being processed*
!ISDVAWD     04/22/2014     ITG# 827  - Changed file path  '\\nt5\' *
!			       with '\\corp.gianteagle.com\'`	       *
! GEX_SEC_REENG 2015-04-29 Vahini Katta                                *
! Changes related to gex_emplid_mapp/7 digit emplid                    *
!***********************************************************************


#Include 'setenv.sqc'    !Set environment
!AXL 6/1/2004 Override print parms for Mobius direct prints - Begin
!#Include 'setup32.sqc'   Printer and page-size initialization
begin-setup		  !Printer and page-size initialization

declare-printer DEFAULT-PD
  point-size=7.6
  pitch=17
  font=3
end-declare

#define PAGE_ORIENTATION LANDSCAPE
!#define PAGE_MAX_COLS    177  !VENDKXY Done the changes for ITG 65625
#define PAGE_MAX_COLS    179 !VENDKXY Done the changes for ITG 65625
#define PAGE_MAX_LINES   58
#Define ColR 160 

! Define Parameters
    #define PAGE_PAPER_SIZE (11,8.5)
    #define LINE_HEIGHT 9.5 

    #if {PRINTER_TYPE} = 'LINEPRINTER'
      #define PAGE_LEFT_MARG 0.25			!AXL was 0.0
      #define PAGE_TOP_MARG  0.5			!AXL was .125
      #define CHAR_WIDTH 4.32
    #endif
    
 declare-layout default
  paper-size={PAGE_PAPER_SIZE}
  orientation={PAGE_ORIENTATION}
  max-columns={PAGE_MAX_COLS}
  max-lines={PAGE_MAX_LINES}
  left-margin={PAGE_LEFT_MARG}
  top-margin={PAGE_TOP_MARG}
  line-height={LINE_HEIGHT}              ! 72/printer_point-size
  char-width={CHAR_WIDTH}                ! points, to handle max cols
end-declare

end-setup   
!AXL 6/1/2004 - End
!VENDKXY Done the changes for ITG 65625-- Begin
!#define #column1     1
!#define #column2    33
!#define #column3    44
!#define #column4    56
!!GBD 07/15/2002 Begin
!
!#define #column5    68 
!
!#define #column6    79
!
!#define #column7    85
!
!#define #column8    91
!
!#define #column9    97
!
!#define #column10  109
!
!#define #column11  120
!
!#define #column12  136
!
!#define #column13  152
!
!#define #column14  169
!
!#define #column15  173  !AXL 6/1/2004 New Column
!GBD 07/15/2002 End



#define #column1  1    ! vendor id 	
                       
#define #column2  11   !deptid

#define #column3  16   !  name

#define #column4  48   !  emplid/ssn

#define #column5  59   !  job title
                       
#define #column6  70   !service date 
                       
#define #column7  79  !  reg temp
                       
#define #column8  90  !  empl stat
                       
#define #column9  95  !  Action
                       
#define #column10 100  !  Action Reason
                       
#define #column11 105  !  effdate
                       
#define #column12 114  !  benefit term date 
                       
#define #column13 124  ! previous mtd hrs
                       
#define #column14 140  ! current mtd hrs 
                       
#define #column15 156  !mtd benefit paid 
                       
#define #column16 172 !VL
			 
#define #column17 175  !IH 

!VENDKXY Done the changes for ITG 65625-- End



Begin-Heading 8
#debug9 Show 'Begin-Heading'

#Include 'stdhdg01.sqc'

  Do Get-Provider-Name
  Do Get-Department-Name

!  Print 'Provider:'            (3,1)
  Print 'VendorID:'            (3,1)
  Print $Provider              (3,13)
  Print $ProviderName          (3,+2)

  Print $Reporting_Period      (3,) Center 

  Print 'Deptid:'              (4,1)
  Print $Deptid                (4,13)
  Print $DeptName              (4,+2)

  !VENDKXY Done the changes for ITG 65625-- Begin  
 
  !Print 'IN STORE'             (+2,{#column3})  
  !Print 'SERVICE'              (+0,{#column4})  
  !Print 'REG'                  (+0,{#column5})
  !Print 'EMPL'                 (+0,{#column6})
  !Print 'ACTN'                 (+0,{#column8})
  !Print 'EFF'                  (+0,{#column9})
  !Print 'BENEFIT'              (+0,{#column10})
  !Print '      PREVIOUS'       (+0,{#column11})
  !Print '       CURRENT'       (+0,{#column12})
  !Print '   MTD BENEFIT'       (+0,{#column13})
  
  Print 'DEPT' 			(+2,{#column2})  
  Print 'SERVICE'              (+0,{#column6})	 
  Print 'REG'                  (+0,{#column7})
  Print 'EMPL'                 (+0,{#column8})
  Print 'ACTN'                 (+0,{#column10})
  Print 'EFF'                  (+0,{#column11})
  Print 'BENEFIT'              (+0,{#column12})
  Print '      PREVIOUS'       (+0,{#column13})
  Print '       CURRENT'       (+0,{#column14})
  Print '   MTD BENEFIT'       (+0,{#column15})
 
   !VENDKXY Done the changes for ITG 65625-- End  

  Print 'VENDORID'	       (+1,{#column1})!VENDKXY Done the changes for ITG 65625
  Print 'ID'	       (+0,{#column2})!VENDKXY Done the changes for ITG 65625
  
  !Print 'EMPLOYEE NAME'        (+1,{#column1})!VENDKXY Done the changes for ITG 65625
  !Print 'SSN'                  (+0,{#column2})!VENDKXY Done the changes for ITG 65625
  
  Print 'EMPLOYEE NAME'        (+0,{#column3})!VENDKXY Done the changes for ITG 65625
  Print 'SSN'                  (+0,{#column4})!VENDKXY Done the changes for ITG 65625
  
  !Print 'DEPARTMENT'           (+0,{#column3}) !VENDKXY Done the changes for ITG 65625
  
  Print 'JOB TITLE'    		(+0,{#column5}) !VENDKXY Done the changes for ITG 65625
  
 !VENDKXY Done the changes for ITG 65625- Begin
  
 !Print 'DATE'                 (+0,{#column4})
 !Print 'TEMP'                 (+0,{#column5})
 !Print 'STAT'                 (+0,{#column6})
 !Print 'ACTN'                 (+0,{#column7})
 !Print 'RSN'                  (+0,{#column8})
 !Print 'DATE'                 (+0,{#column9})
 !Print 'TERM DATE'            (+0,{#column10})
 !Print '       MTD HRS'       (+0,{#column11})
 !Print '       MTD HRS'       (+0,{#column12})
 !Print '          PAID'       (+0,{#column13})
 !Print 'VL'                   (+0,{#column14})
 !Print 'IH'                   (+0,{#column15})  !AXL 6/1/2004 New Column  
 
  Print 'DATE'                 (+0,{#column6})
  Print 'TEMP'                 (+0,{#column7})
  Print 'STAT'                 (+0,{#column8})
  Print 'ACTN'                 (+0,{#column9})
  Print 'RSN'                  (+0,{#column10})
  Print 'DATE'                 (+0,{#column11})
  Print 'TERM DATE'            (+0,{#column12})
  Print '       MTD HRS'      (+0,{#column13})
  Print '       MTD HRS'      (+0,{#column14})
  Print '          PAID'      (+0,{#column15})
  Print 'VL'                   (+0,{#column16})
  Print 'IH'                   (+0,{#column17})  
 
  !Print '-'                    (+1,{#column1},30)  Fill
  !Print '-'                    (+0,{#column2},09)  Fill
  !Print '-'                    (+0,{#column3},10)  Fill
  !Print '-'                    (+0,{#column4},10)  Fill
  !Print '-'                    (+0,{#column5},10)  Fill
  !Print '-'                    (+0,{#column6},04)  Fill
  !Print '-'                    (+0,{#column7},04)  Fill
  !Print '-'                    (+0,{#column8},04)  Fill
  !Print '-'                    (+0,{#column9},10)  Fill
  !Print '-'                    (+0,{#column10},10) Fill
  !Print '-'                    (+0,{#column11},14) Fill
  !Print '-'                    (+0,{#column12},14) Fill
  !Print '-'                    (+0,{#column13},14) Fill
  !Print '-'                    (+0,{#column14},2)  Fill
  !Print '-'                    (+0,{#column15},2)  Fill	!AXL 6/1/2004 New Column
  
  
  Print '-'                    (+1,{#column1},10)  Fill
  Print '-'                    (+0,{#column2},04)  Fill
  Print '-'                    (+0,{#column3},30)  Fill
  Print '-'                    (+0,{#column4},10)  Fill
  Print '-'                    (+0,{#column5},10)  Fill
  Print '-'                    (+0,{#column6},10)  Fill
  Print '-'                    (+0,{#column7},10)  Fill
  Print '-'                    (+0,{#column8},04)  Fill
  Print '-'                    (+0,{#column9},04)  Fill
  Print '-'                    (+0,{#column10},04)  Fill
  Print '-'                    (+0,{#column11},10)  Fill
  Print '-'                    (+0,{#column12},10) Fill
  Print '-'                    (+0,{#column13},14) Fill
  Print '-'                    (+0,{#column14},14) Fill
  Print '-'                    (+0,{#column15},14) Fill
  Print '-'                    (+0,{#column16},2)  Fill
  Print '-'                    (+0,{#column17},2)  Fill	
  
  !VENDKXY Done the changes for ITG 65625-- End			
End-Heading


Begin-Report
#debug9 Show 'Begin-Report'
  MOVE $CURRENT-DATE TO $CURRDT 'MMDDYY'   !VENDKXY Done the Changes for ITG 70473
  !let $report-name = '\\corp.gianteagle.com\mobius\hrreports\' ||'PL009PDF.pdf'  !VENDKXY Done the changes for ITG 67439 !VENDKXY Done the changes for ITG 70473
!*****************************************************************
! ISDVAWD ITG# 827- 4/22/2014 - Begin - - Changed Report name 
!*****************************************************************
!  let $report-name = '\\nt5\ftproot\benefits\Local 880_GEXPL009\' ||'PL009PDF_' || $CURRDT || '.pdf'  !VENDKXY Done the changes for ITG 70473
   let $report-name = '\\corp.gianteagle.com\common\HR\HRPS\secure\benefitsk\Local 880_GEXPL009\' ||'PL009PDF_' || $CURRDT || '.pdf'   
!******************************************************************
! ISDVAWD ITG# 827- 4/22/2014 - End  
!******************************************************************
  new-report  $report-name   !VENDKXY Done the changes for ITG 67439

  !Do Set-Optimizer-Goal

  Do Init-DateTime           !datetime.sqc
  Do Init-Number             !number.sqc
  Do Get-Current-DateTime    !curdttim.sqc
  Do Stdapi-Init             !stdapi.sqc
  
  Do P100-Start
  Do Openfile     !VENDKXY Done the changes for ITG 65625
  Do P200-Main-Process
  Do P300-Finish

  Do Reset                   !reset.sqc
  Do Stdapi-Term             !stdapi.sqc

  Show 'Successful end of report'
End-Report

!VENDKXY Done the changes for ITG 65625-- Begin
Begin-Procedure Openfile

    !Close 1
    encode '<009>' into $delim
    
       
    !Let $file009 = '\\corp.gianteagle.com\mobius\hrreports\' || 'gexpl009xls' || '.xls'  !Vendkxy done the changes for ITG 67439
    
    !Let $file009 = '\\corp.gianteagle.com\mobius\hrreports\' || 'PL009XLS' || '.xls'  !Vendkxy done the changes for ITG 67439 !VENDKXY Done the changes for ITG 70473
!*****************************************************************
! ISDVAWD ITG# 827- 4/22/2014 - Begin - Updated File path   
!*****************************************************************    
!    Let $file009 = '\\nt5\ftproot\benefits\Local 880_GEXPL009\' || 'PL009XLS_' || $CURRDT || '.xls' !VENDKXY Done the changes for ITG 70473
    Let $file009 = '\\corp.gianteagle.com\common\HR\HRPS\secure\benefitsk\Local 880_GEXPL009\' || 'PL009XLS_' || $CURRDT || '.xls'  
!******************************************************************
! ISDVAWD ITG# 827- 4/22/2014 - End  
!******************************************************************
   	  		
    Open $file009 As 1 For-Writing Record=1000:Vary
    
   !Vendkxy done the changes for ITG 67439
   Move 'PL009XLS'			To $Report  
   encode '<012>' into $newline 
   String 'Report ID:' $Report  ' ' ' ' ' ' ' ' ' ' $ReportTitle by $delim into $gexpl009
   Write 1 from $gexpl009
   Write 1 from $newline 
   !Vendkxy done the changes for ITG 67439
    
   !String 'VENDORID' 'DEPTID' 'EMPLOYEE NAME' 'SSN' 'JOB TITLE'  'SERVICE DATE' 'REG TEMP' 'EMPL STAT'   !VENDKXY Done the changes for ITG 67439
    String 'VENDORID' 'DEPTID' 'DEPTID DESCRIPTION' 'EMPLOYEE NAME' 'SSN' 'JOB TITLE'  'SERVICE DATE' 'REG TEMP' 'EMPL STAT'      !VENDKXY Done the changes for ITG 67439                                  
    'ACTN' 'ACTN RSN' 'EFF DATE' 'BENEFIT TERM DATE' 'PREVIOUS MTD HRS' 'CURRENT MTD HRS' 'MTD BENEFIT PAID' 'VL' 'IH' by $delim into $gexpl009
  Write 1 from $gexpl009
    
End-Procedure

!VENDKXY Done the changes for ITG 65625-- End

Begin-Procedure Set-Optimizer-Goal
  Begin-SQL
    !Alter Session Set OPTIMIZER_GOAL=RULE;	!GEX-CXB Commented for Upgrade 9.0 on 10/23/2007
    Alter Session Set OPTIMIZER_MODE=RULE;	!GEX-CXB Added for Upgrade 9.0 on 10/23/2007
  End-SQL
End-Procedure


Begin-Procedure P100-Start
#debug9 Show 'P100-Start'

  !Move 'GEXPL009'                    To $ReportID  !VENDKXY Done the changes for ITG 67439
  Move 'PL009PDF'			To $ReportID    !VENDKXY Done the changes for ITG 67439
  Move 'RMC HEALTH & WELFARE REPORT' To $ReportTitle

  Show '$ReportID=' $ReportID
  Show '$ReportTitle=' $ReportTitle

  If $prcs_process_instance = ''

    Move '''' to $ProviderString
    Display 'Enter Vendor ID or leave blank to exit.'
    While 1=1
      Input $Provider maxlen=6 'Provider ID'
      if RTRIM($Provider, ' ') = ''
        concat '''' with $ProviderString
        break
      end-if
      if $ProviderString <> ''''
        concat ''',''' with $ProviderString
      end-if
      concat $Provider with $ProviderString
    End-While

    let $Vendor_ID = $Provider

    if $ProviderString = ''''''
      let $GEXXX927_INCLUDE_VENDOR_ID_CRITERIA = '1=1'
      let $GEXXX927_INCLUDE_VENDOR_ID_DISPLAY_CRITERIA = 'ALL'
    else
      let $GEXXX927_INCLUDE_VENDOR_ID_CRITERIA = 'bpt.vendor_id In (' || $ProviderString || ')'
      let $GEXXX927_INCLUDE_VENDOR_ID_DISPLAY_CRITERIA = $GEXXX927_INCLUDE_VENDOR_ID_CRITERIA
    end-if

    Move '''' to $PlanTypeString
    Display 'Enter Plan Type or leave blank to exit.'
    While 1=1
      Input $PlanType Maxlen=2 'Plan Type'
      Uppercase $PlanType
      if RTRIM($PlanType, ' ') = ''
        concat '''' with $PlanTypeString
        break
      end-if
      if $PlanTypeString <> ''''
        concat ''',''' with $PlanTypeString
      end-if
      concat $PlanType with $PlanTypeString
    End-While

    if $PlanTypeString = ''''''
      let $GEXXX912_INCLUDE_BENEFIT_PLAN_CRITERIA2 = '1=1'
      let $GEXXX912_INCLUDE_BENEFIT_PLAN_CRITERIA = '1=1'
      let $GEXXX912_INCLUDE_BENEFIT_PLAN_DISPLAY_CRITERIA = 'ALL'
    else
      let $GEXXX912_INCLUDE_BENEFIT_PLAN_CRITERIA2 = 'hb1.plan_type In (' || $PlanTypeString || ')'
      let $GEXXX912_INCLUDE_BENEFIT_PLAN_CRITERIA = 'bpt.plan_type In (' || $PlanTypeString || ')'
      let $GEXXX912_INCLUDE_BENEFIT_PLAN_DISPLAY_CRITERIA = $GEXXX912_INCLUDE_BENEFIT_PLAN_CRITERIA
    end-if

  Else

    Let $GEXXX912_Plan_Type_Alias = 'hb1.plan_type'
    Let $GEXXX912_Benefit_Plan_Alias = 'hb1.benefit_plan'
    Do GEXXX912-Select-Benefit-Plan-Parameters
    Let $GEXXX912_INCLUDE_BENEFIT_PLAN_CRITERIA2 = $GEXXX912_INCLUDE_BENEFIT_PLAN_CRITERIA

    Let $GEXXX912_Plan_Type_Alias = 'bpt.plan_type'
    Let $GEXXX912_Benefit_Plan_Alias = 'bpt.benefit_plan'
    Do GEXXX912-Select-Benefit-Plan-Parameters

    Let $GEXXX927_Vendor_ID_Alias = 'bpt.vendor_id'
    Do GEXXX927-Select-Vendor-ID-Parameters

  End-If

  date-time () HH:MI:SS &timeBegan
  date-time () MM/DD/YYYY &dateBegan
  show 'Report Began at ' &timeBegan ' on ' &dateBegan

  If $GEXXX912_INCLUDE_BENEFIT_PLAN_CRITERIA = '1=1'
    Display 'At least one plan type parameter must be specified'
    Stop
  End-If

  If $GEXXX927_INCLUDE_VENDOR_ID_CRITERIA = '1=1'
    Display 'At least one vendor id parameter must be specified'
    Stop
  End-If

  Let $X000_ORDER_BY = 'Vendor ID, Deptid, Employee Name'

  Show '$GEXXX912_INCLUDE_BENEFIT_PLAN_DISPLAY_CRITERIA  = '   $GEXXX912_INCLUDE_BENEFIT_PLAN_DISPLAY_CRITERIA
  Show '$GEXXX927_INCLUDE_VENDOR_ID_DISPLAY_CRITERIA      = '   $GEXXX927_INCLUDE_VENDOR_ID_DISPLAY_CRITERIA

  Do Get-Calendar-Year-Id    !getbalid.sqc

  Do P140-Get-Pay-Period
  Do P150-Print-Cover-Page
  Do P170-Get-Xlat-Lookup
End-Procedure


Begin-Procedure P140-Get-Pay-Period
#debug9 Show 'P140-Get-Pay-Period'

Begin-Select
pay_end_dt
To_Number(To_Char(pay_end_dt-7,'MM'))                   &hours_period
To_Number(To_Char(pay_end_dt-7,'YYYY'))                 &hours_year
To_Number(To_Char(Add_Months(pay_end_dt-7,-1),'MM'))    &prev_month_hours_period
To_Number(To_Char(Add_Months(pay_end_dt-7,-1),'YYYY'))  &prev_month_hours_year
To_Char(check_dt,'fmMonth YYYY')                        &period
Last_Day(Add_Months(check_dt,-1))                       &prev_month_end
Last_Day(Add_Months(check_dt,1))                        &next_month_end

  Let $AsOfDate         = &pay_end_dt
  Let $pay_end_dt       = &pay_end_dt
  Let #hours_year       = &hours_year
  Let #hours_period     = &hours_period
  Let $Reporting_Period = &period

  Let $next_month_end      = &next_month_end
  Let $prev_month_begin    = '01-'||Substr(&prev_month_end,4,8)

  Let #prev_month_hours_year   = &prev_month_hours_year
  Let #prev_month_hours_period = &prev_month_hours_period

  If Rtrim($pay_end_dt,' ') = ''
    Show 'No confirmed pay period found in calendar'
    Stop
  Else
    Show 'This is the ' $Reporting_Period ' bill'
  End-If

  Do P160-Get-Begin-Date

  Show 'Report will show deductions taken between ' $begin_date ' and ' $pay_end_dt

From   ps_pay_calendar

Where  company  = 'GEI'
And    paygroup = 'RET'

And    pay_end_dt =
      (Select Max(pay_end_dt)
       From   ps_pay_calendar
       Where  company = 'GEI'
       And    paygroup = 'RET'
       And    pay_end_dt <= $AsOfToday
       And    pay_confirm_run = 'Y'
       And    pay_period = 1)
End-Select
End-Procedure


begin-procedure P150-Print-Cover-Page
#debug9 Show 'P150-Print-Cover-Page'

  !AXL 6/1/2004  Initialize for Mobius
  let $Provider   = 'XXXXX'
  let $Deptid     = 'XXXX'
  let $DeptName   = 'XXXXXXXXXX'

  Print 'RUN CONTROL INFORMATION FOR THIS REPORT RUN:'        (+5,1)
  Print '$Prcs_OPRID          = '                             (+2,5)
  Print $Prcs_OPRID                                           (0,+2)
  Print '$PRCS_RUN_CNTL_ID    = '                             (+1,5)
  Print $PRCS_RUN_CNTL_ID                                     (0,+2)

  Print 'SELECTION CRITERIA FOR THIS REPORT RUN:'             (+5,2)
  Print '$GEXXX912_INCLUDE_BENEFIT_PLAN_DISPLAY_CRITERIA = '  (+2,5)
  Print $GEXXX912_INCLUDE_BENEFIT_PLAN_DISPLAY_CRITERIA       (0,+2)
  Print '$GEXXX927_INCLUDE_VENDOR_ID_DISPLAY_CRITERIA     = '  (+2,5)
  Print $GEXXX927_INCLUDE_VENDOR_ID_DISPLAY_CRITERIA           (0,+2)

  Print 'This is the'                                         (+2,5)
  Print $Reporting_Period                                     (0,+1)
  Print 'bill'                                                (0,+1)

  Print 'SORT ORDER FOR THIS REPORT RUN:'                     (+5,2)
  Print $X000_ORDER_BY                                        (+2,5)

  Let #PAGE-COUNT = 0
End-Procedure


Begin-Procedure P160-Get-Begin-Date
#debug9 Show 'P160-Get-Begin-Date'
Begin-Select
pc1.pay_end_dt

  Let $begin_date = &pc1.pay_end_dt

From   ps_pay_calendar pc1

Where  company  = 'GEI'
And    paygroup = 'RET'

And    pay_end_dt =
      (Select Max(pay_end_dt)
       From   ps_pay_calendar
       Where  company = 'GEI'
       And    paygroup = 'RET'
       And    pay_end_dt <= $pay_end_dt
       And    pay_confirm_run = 'Y'
       And    pay_period = 2)
End-Select
End-Procedure


begin-procedure P170-Get-Xlat-Lookup
#debug9 Show 'P170-Get-Xlat-Lookup'

  Let $Where = '     x.fieldname   = ''REG_TEMP''' ||
	       ' And x.eff_status  = ''A''' ||
!       	' And x.language_cd = ''ENG''' ||	!GEX-CXB Commented for Upgrade 9.0 on 10/23/2007
	       ' And x.effdt       = (Select Max(effdt)' ||
!	       '                      From   xlattable x1' ||	!GEX-CXB Commented for Upgrade 9.0 on 10/23/2007
	       '                      From   PSXLATITEM x1' ||	!GEX-CXB Commented for Upgrade 9.0 on 10/23/2007
	       '                      Where  x1.fieldname    = x.fieldname' ||
!GBD 07/15/2002 Begin
!	       '                      And    x1.language_cd  = ''ENG''' ||
!	       '                      And    x1.language_cd  = x.language_cd' ||!GEX-CXB Commented for Upgrade 9.0 on 10/23/2007
	       '                      And    x1.fieldvalue  = x.fieldvalue' ||
!GBD 07/15/2002 End
	       '                      And    x1.effdt       <= ''' || $pay_end_dt || '''' ||
	       '                      And    x1.eff_status   = ''A'')'

  Load-Lookup
    Name=XlatLookup
    Rows=10
    !Table='XLATTABLE X'	!GEX-CXB Commented for Upgrade 9.0 on 10/23/2007
    Table='PSXLATITEM X'	!GEX-CXB Added for Upgrade 9.0 on 10/23/2007
    Key='X.FIELDVALUE'
    Return_Value='X.XLATSHORTNAME'
    Where=$Where
    Quiet
End-Procedure


Begin-Procedure P200-Main-Process
#debug9 Show 'P200-Main-Process'
 
  Let $Data-Found-Flag = 'N'

Begin-Select
bpt.vendor_id        ()     On-Break   Level=1
                                       Print=Never
                                       Save=$Save_Vendor_ID
                                       After=P270-After-Vendor-ID-Break

pl.deptid            ()     On-Break   Level=2
                                       Print=Never
                                       Save=$Save_Deptid
                                       After=P280-After-Deptid-Break
                                       Before=P285-Before-Deptid-Break

per.name             ()     On-Break   Level=3
                                       Print=Never

j.emplid             ()     On-Break   Level=4
                                       Print=Never

j.empl_rcd          ()     On-Break   Level=5
                                       Print=Never
                                       After=P290-Employee-Break

bdp.gex_spcl_accum_cd

e.service_dt

per.birthdate
per.emplid  !SXK 11/23/1999 Changed from ssn to emplid

j.company
j.effdt
j.acct_cd
j.empl_status
j.reg_temp
j.full_part_time
j.gex_volun_low_hrs
j.gex_inflated_hrs	!AXL 06/28/2004 - Add

pd.ded_cur
j.position_nbr  !VENDKXY Done the changes for ITG 65625

  Let $Data-Found-Flag = 'Y'

  Let $Provider              = &bpt.vendor_id
  Let $Vendor_ID             = &bpt.vendor_id
  Let $Deptid                = &pl.deptid
  Let $per.name              = &per.name
  Let $j.company             = &j.company
  Let $j.emplid              = &j.emplid
  Let #j.empl_rcd            = &j.empl_rcd
  Let $bdp.gex_spcl_accum_cd = &bdp.gex_spcl_accum_cd
  Let $e.service_dt          = &e.service_dt
  Let $per.birthdate         = &per.birthdate
  Let $per.ssn               = &per.emplid !SXK 11/23/1999 Changed to emplid from ssn
  Let $j.effdt               = &j.effdt
  Let $j.acct_cd             = &j.acct_cd
  Let $j.empl_status         = &j.empl_status
  Let $j.reg_temp            = &j.reg_temp
  Let $j.full_part_time      = &j.full_part_time
  Let $j.gex_volun_low_hrs   = &j.gex_volun_low_hrs
  Let $j.gex_inflated_hrs    = &j.gex_inflated_hrs !AXL 6/1/2004 New Column
  Let #ded_cur               = &pd.ded_cur
  
  !VENDKXY Done the changes for ITG 65625-- Begin
  Let $Position_Nbr          = &j.position_nbr  
  Let $AsOfDate = $pay_end_dt
  do Get-Position-Title
  Let $jobtitle		     = $PosNameAbbrv 
  !VENDKXY Done the changes for ITG 65625--End
  
  Add #ded_cur To #grs_mtd

From   ps_personal_data          per,
       ps_employment             e,
       ps_job                    j,
       ps_ben_defn_pgm           bdp,
       ps_ben_defn_optn          bdo,
       ps_benef_plan_tbl         bpt,
       ps_pay_line               pl,
       ps_pay_check              pc,
       ps_pay_deduction          pd

Where  per.emplid                = j.emplid
!and j.emplid in ('583516902','271883801','292789096','275528442','555312427','300720130','204288174','290888771') !Vendkxy for testing
And    e.emplid                  = j.emplid
And    e.empl_rcd               = j.empl_rcd

And    j.effdt                   =
      (Select Max(effdt)
       From   ps_job
       Where  emplid             = j.emplid
       And    empl_rcd          = j.empl_rcd
       And    effdt             <= $pay_end_dt)

And    j.effseq                  =
      (Select Max(effseq)
       From   ps_job
       Where  emplid             = j.emplid
       And    empl_rcd          = j.empl_rcd
       And    effdt              = j.effdt)
       
And    bpt.effdt                 =
      (Select Max(effdt)
       From   ps_benef_plan_tbl
       Where  plan_type          = bpt.plan_type
       And    benefit_plan       = bpt.benefit_plan
       And    effdt             <= $pay_end_dt)

And    bdo.plan_type             = bpt.plan_type
And    bdo.benefit_plan          = bpt.benefit_plan

!GBD 10/16/2002 Begin
!And    bdo.effdt                 =
!      (Select Max(effdt)
!       From   ps_ben_defn_optn
!       Where  benefit_program    = bdo.benefit_program
!       And    effdt             <= $pay_end_dt
!       And    plan_type          = bdo.plan_type
!       And    option_id          = bdo.option_id)
!GBD 10/16/2002 End

And    bdp.effdt                 =
      (Select Max(effdt)
       From   ps_ben_defn_pgm
       Where  benefit_program    = bdp.benefit_program
       And    effdt             <= $pay_end_dt)

And    bdp.benefit_program       = bdo.benefit_program    !GBD 10/16/2002
And    bdp.effdt                 = bdo.effdt              !GBD 10/16/2002
And    pc.emplid                 = j.emplid
And    pc.empl_rcd              = j.empl_rcd

And    pc.pay_end_dt          Between $begin_date And $pay_end_dt

And    pd.company                = pc.company
And    pd.paygroup               = pc.paygroup
And    pd.pay_end_dt             = pc.pay_end_dt
And    pd.off_cycle              = pc.off_cycle
And    pd.page_num                  = pc.page_num
And    pd.line_num                  = pc.line_num
And    pd.sepchk                 = pc.sepchk

And    pl.company                = pc.company
And    pl.paygroup               = pc.paygroup
And    pl.pay_end_dt             = pc.pay_end_dt
And    pl.off_cycle              = pc.off_cycle
And    pl.page_num                  = pc.page_num
And    pl.line_num                  = pc.line_num

And    pd.plan_type              = bpt.plan_type
And    pd.benefit_plan           = bpt.benefit_plan
And    pd.ded_class              = 'N'

And   [$GEXXX912_INCLUDE_BENEFIT_PLAN_CRITERIA]
And   [$GEXXX927_INCLUDE_VENDOR_ID_CRITERIA]

Order By bpt.vendor_id,
       pl.deptid,
       per.name,
       j.emplid,
       j.empl_rcd

End-Select
End-Procedure


Begin-Procedure P220-Get-Benefit-Termination-Row
#debug9 Show 'P220-Get-Benefit-Termination-Row'
Begin-Select
Min(hb1.coverage_begin_dt) &hb1.coverage_begin_dt

From   ps_health_benefit hb1

Where  hb1.emplid         = $j.emplid
And    hb1.empl_rcd      = #j.empl_rcd

And   [$GEXXX912_INCLUDE_BENEFIT_PLAN_CRITERIA2]
And    hb1.plan_type     <> '1V'

And    hb1.effdt          =
      (Select Max(effdt)
       From   ps_health_benefit
       Where  emplid      = hb1.emplid
       And    empl_rcd   = hb1.empl_rcd
       And    plan_type   = hb1.plan_type)

And    hb1.coverage_begin_dt Between $prev_month_begin
                                 And $next_month_end

And    hb1.coverage_elect = 'T'
End-Select
End-Procedure


Begin-Procedure P230-Get-Leave-Begin-Date
#debug9 Show 'P230-Get-Leave-Begin-Date'
  Let $Status-Change = 'N'
Begin-Select
JOB.EFFDT
JOB.EMPL_STATUS
JOB.ACTION
JOB.ACTION_REASON

  If &JOB.EMPL_STATUS = $J.EMPL_STATUS And
      $Status-Change = 'N'
    Let $Effective-Date = &JOB.EFFDT
    Let $Action         = &JOB.ACTION
    Let $Action_Reason  = &JOB.ACTION_REASON
    Let $Status-Change = 'N'
  Else
    Let $Status-Change = 'Y'
  End-If

FROM   PS_JOB JOB

WHERE  EMPLID     = $J.EMPLID
AND    EMPL_RCD  = #J.EMPL_RCD
AND    EFFDT     <= $J.EFFDT
ORDER BY JOB.EFFDT DESC, JOB.EFFSEQ DESC
End-Select
End-Procedure


Begin-Procedure P235-Get-Status-Date
#debug9 Show 'P235-Get-Status-Date'
  Let $Reg-Temp-Change = 'N'
Begin-Select
J1.EFFDT
J1.REG_TEMP
J1.ACTION
J1.ACTION_REASON
J1.EMPL_STATUS

  If &J1.REG_TEMP = $J.REG_TEMP And
      $Reg-Temp-Change = 'N'
    Let $Reg-Temp-Change = 'N'
    If &J1.EMPL_STATUS <> 'T'
      Let $Effective-Date = &J1.EFFDT
      Let $Action         = &J1.ACTION
      Let $Action_Reason  = &J1.ACTION_REASON
    End-If
  Else
    Let $Reg-Temp-Change = 'Y'
  End-If

FROM   PS_JOB J1

WHERE  EMPLID     = $J.EMPLID
AND    EMPL_RCD  = #J.EMPL_RCD
AND    EFFDT     <= $J.EFFDT
ORDER BY J1.EFFDT DESC, J1.EFFSEQ DESC
End-Select
End-Procedure


Begin-Procedure P240-Get-Hours
#debug9 Show 'P240-Get-Hours'

  Let #hrs_mtd = 0

Begin-Select
eb.hrs_mtd

  Let #hrs_mtd = &eb.hrs_mtd

From   ps_earnings_bal eb

Where  eb.emplid              = $j.emplid
And    eb.company             = $j.company
And    eb.balance_id          = 'CY'
And    eb.balance_year        = #year
And    eb.balance_period      = #period
And    eb.spcl_balance        = 'Y'
And    eb.erncd               = $bdp.gex_spcl_accum_cd
And    eb.empl_rcd            = #j.empl_rcd
End-Select
End-Procedure


Begin-Procedure P250-Format-Record
#debug9 Show 'P250-Format-Record'

  Lookup XlatLookup $j.reg_temp $reg_temp

  Let $acctcd = $j.acct_cd
  Do Get-Acct-cd-descr

  If $j.gex_volun_low_hrs = 'Y'
    Let $gex_volun_low_hrs = 'Y'
  Else
    Let $gex_volun_low_hrs = ''
  End-If
  !AXL 6/1/2004 Begin
  If $j.gex_inflated_hrs = 'Y'
    Let $gex_inflated_hrs = 'Y'
  Else
    Let $gex_inflated_hrs = ''
  End-If
  !AXL 6/1/2004 End

  !Do Format-DateTime($e.service_dt, $Service_Dt, {DEFMDY}, '', '') Vendrbc
  Let $Service_Dt = edit($e.service_dt,'mm/dd/yy') ! VENDRBC Added for upgarde 9.0 on
  !Do Format-DateTime($per.birthdate, $Birth_Date, {DEFMDY}, '', '') VENDRBC
  Let $Birth_Date=edit($per.birthdate,'mm/dd/yy') ! VENDRBC Added for upgarde 9.0 on
  !Do Format-DateTime($Effective-Date, $eff_dt, {DEFMDY}, '', '') VENDRBC
  Let $eff_dt =edit($Effective-Date,'mm/dd/yy') ! VENDRBC Added for upgarde 9.0 on
  !Do Format-DateTime(&hb1.coverage_begin_dt, $Term_Date, {DEFMDY}, '', '') VENDRBC
  Let $Term_Date=edit(&hb1.coverage_begin_dt,'mm/dd/yy') ! VENDRBC Added for upgarde 9.0 on
End-Procedure


Begin-Procedure P260-Print-Record
#debug9 Show 'P260-Print-Record'
 
 !Vendkxy done the changes for ITG 65625-- Begin
 
  !Print $per.name                  (+1,{#column1},30)
  !Print $per.ssn                   (+0,{#column2})
  !Print $AcctNameAbbrv             (+0,{#column3})
  !Print $Service_Dt                (+0,{#column4})
  !Print $reg_temp                  (+0,{#column5})
  !Print $j.empl_status             (+0,{#column6})
  !Print $Action                    (+0,{#column7})
  !Print $Action_Reason             (+0,{#column8})
  !Print $eff_dt                    (+0,{#column9})
  !Print $Term_Date                 (+0,{#column10})
  !Print #prev_hrs_mtd              (+0,{#column11})  Edit 999,999,999.99
  !Print #curr_hrs_mtd              (+0,{#column12})  Edit 999,999,999.99
  !Print #grs_mtd                   (+0,{#column13})  Edit 999,999,999.99
  !Print $gex_volun_low_hrs         (+0,{#column14})
  !Print $gex_inflated_hrs          (+0,{#column15})  !AXL 6/1/2004 New Column
  !Print ' '                        (+1,{#column1})   !AXL 6/1/2004 Double Space
 
 
  do Get-Emp-Ssn ($per.ssn, $Ssn_Out) !GEX_SEC_REENG 2015-04-29 Vahini Katta 

  Print $Vendor_ID		    (+1,{#column1})
  Print $Deptid 		    (+0,{#column2})
  Print $per.name                  (+0,{#column3},30)
  !GEX_SEC_REENG 2015-04-29 Vahini Katta Begins
  !Print $per.ssn                   (+0,{#column4})
  Print $Ssn_Out                   (+0,{#column4})
  !GEX_SEC_REENG 2015-04-29 Vahini Katta Ends
  Print $jobtitle		    (+0,{#column5})
  Print $Service_Dt                (+0,{#column6})
  Print $reg_temp                  (+0,{#column7})
  Print $j.empl_status             (+0,{#column8})
  Print $Action                    (+0,{#column9})
  Print $Action_Reason             (+0,{#column10})
  Print $eff_dt                    (+0,{#column11})
  Print $Term_Date                 (+0,{#column12})
  Print #prev_hrs_mtd              (+0,{#column13})  Edit 999,999,999.99
  Print #curr_hrs_mtd              (+0,{#column14})  Edit 999,999,999.99
  Print #grs_mtd                   (+0,{#column15})  Edit 999,999,999.99
  Print $gex_volun_low_hrs         (+0,{#column16})
  Print $gex_inflated_hrs          (+0,{#column17})  
  Print ' '                        (+1,{#column1})   

  
   Do Get-Department-Name   !VENDKXY Done the changes for ITG 67439
    
   !STRING $Vendor_ID $Deptid $per.name $per.ssn $jobtitle $Service_Dt $reg_temp  $j.empl_status  $Action  $Action_Reason $eff_dt $Term_Date #prev_hrs_mtd #curr_hrs_mtd #grs_mtd $gex_volun_low_hrs $gex_inflated_hrs BY $DELIM INTO $GEXPL009 !VENDKXY Done the changes for ITG 67439
   !GEX_SEC_REENG 2015-04-29 Vahini Katta Begins
   !STRING $Vendor_ID $Deptid $DeptName $per.name $per.ssn $jobtitle $Service_Dt $reg_temp  $j.empl_status  $Action  $Action_Reason $eff_dt $Term_Date #prev_hrs_mtd #curr_hrs_mtd #grs_mtd $gex_volun_low_hrs $gex_inflated_hrs BY $DELIM INTO $GEXPL009 !VENDKXY Done the changes for ITG 67439
   STRING $Vendor_ID $Deptid $DeptName $per.name $Ssn_Out $jobtitle $Service_Dt $reg_temp  $j.empl_status  $Action  $Action_Reason $eff_dt $Term_Date #prev_hrs_mtd #curr_hrs_mtd #grs_mtd $gex_volun_low_hrs $gex_inflated_hrs BY $DELIM INTO $GEXPL009 !VENDKXY Done the changes for ITG 67439
   !GEX_SEC_REENG 2015-04-29 Vahini Katta Ends
   WRITE 1 FROM $GEXPL009


  !Vendkxy done the changes for ITG 65625-- End
End-Procedure


Begin-Procedure P270-After-Vendor-ID-Break
#debug9 Show 'P270-After-Vendor-ID-Break'

  !Vendkxy done the changes for ITG 65625-- Begin
  
  !Print '-'                        (+2,{#column11},014)   Fill
  !Print '-'                        (,{#column12},014)     Fill
  !Print '-'                        (,{#column13},014)     Fill
  ! Print 'Provider'                 (+1,{#column8})
  !Print 'VendorID'                 (+1,{#column8})
  !Print $Save_Vendor_ID            (0,+1)
  !Print 'Totals'                   (0,+1)
  !Print #Vendor-ID-HW-Previous-Hrs (0,{#column11})        Edit 999,999,999.99
  !Print #Vendor-ID-HW-Current-Hrs  (0,{#column12})        Edit 999,999,999.99
  !Print #Vendor-ID-HW-Amount       (0,{#column13})        Edit 999,999,999.99
  
  Print '-'                        (+2,{#column13},014)   Fill
  Print '-'                        (,{#column14},014)     Fill
  Print '-'                        (,{#column15},014)     Fill
  Print 'VendorID'                 (+1,{#column7})
  Print $Save_Vendor_ID            (0,+1)
  Print 'Totals'                   (0,+1)
  Print #Vendor-ID-HW-Previous-Hrs (0,{#column13})        Edit 999,999,999.99
  Print #Vendor-ID-HW-Current-Hrs  (0,{#column14})        Edit 999,999,999.99
  Print #Vendor-ID-HW-Amount       (0,{#column15})        Edit 999,999,999.99

  !Vendkxy done the changes for ITG 65625-- End

  Let #Vendor-ID-HW-Previous-Hrs = 0
  Let #Vendor-ID-HW-Current-Hrs  = 0
  Let #Vendor-ID-HW-Amount       = 0
End-Procedure


Begin-Procedure P280-After-Deptid-Break
#debug9 Show 'P280-After-Deptid-Break'

  !Vendkxy done the changes for ITG 65625-- Begin

  !Print '-'                        (+2,{#column11},014)   Fill
  !Print '-'                        (,{#column12},014)     Fill
  !Print '-'                        (,{#column13},014)     Fill
  !Print 'Deptid'                   (+1,{#column5})
  !Print $Save_Deptid               (0,+1)
  !Print 'Count'                    (0,+1)
  !Print #Deptid-HW-Count           (0,+1)                 Edit 999,999,999
  !Print #Deptid-HW-Previous-Hrs    (0,{#column11})        Edit 999,999,999.99
  !Print #Deptid-HW-Current-Hrs     (0,{#column12})        Edit 999,999,999.99
  !Print #Deptid-HW-Amount          (0,{#column13})        Edit 999,999,999.99


  Print '-'                        (+2,{#column13},014)   Fill
  Print '-'                        (,{#column14},014)     Fill
  Print '-'                        (,{#column15},014)     Fill
  Print 'Deptid'                   (+1,{#column7})
  Print $Save_Deptid               (0,+1)
  Print 'Count'                    (0,+1)
  Print #Deptid-HW-Count           (0,+1)                 Edit 999,999,999   
  Print #Deptid-HW-Previous-Hrs    (0,{#column13})        Edit 999,999,999.99
  Print #Deptid-HW-Current-Hrs     (0,{#column14})        Edit 999,999,999.99
  Print #Deptid-HW-Amount          (0,{#column15})        Edit 999,999,999.99


  !Vendkxy done the changes for ITG 65625-- End

  Add #Deptid-HW-Previous-Hrs To #Vendor-ID-HW-Previous-Hrs
  Add #Deptid-HW-Current-Hrs  To #Vendor-ID-HW-Current-Hrs
  Add #Deptid-HW-Amount       To #Vendor-ID-HW-Amount

  Let #Deptid-HW-Count        = 0
  Let #Deptid-HW-Previous-Hrs = 0
  Let #Deptid-HW-Current-Hrs  = 0
  Let #Deptid-HW-Amount       = 0
End-Procedure


Begin-Procedure P285-Before-Deptid-Break
#debug9 Show 'P285-Before-Deptid-Break'

  New-Page
End-Procedure


Begin-Procedure P290-Employee-Break
#debug9 Show 'P290-Employee-Break'

  Do P220-Get-Benefit-Termination-Row

  Evaluate $j.empl_status
    When = 'L'
    When = 'P'
    When = 'R'
    When = 'T'
      Do P230-Get-Leave-Begin-Date
      Break
    When-Other
      Do P235-Get-Status-Date
  End-Evaluate

  Let #prev_hrs_mtd = 0
  Let #year   = #prev_month_hours_year
  Let #period = #prev_month_hours_period
  Do P240-Get-Hours
  Let #prev_hrs_mtd = #hrs_mtd

  Let #curr_hrs_mtd = 0
  Let #year   = #hours_year
  Let #period = #hours_period
  Do P240-Get-Hours
  Let #curr_hrs_mtd = #hrs_mtd

  Do P250-Format-Record
  Do P260-Print-Record

  Add 1             To #Deptid-HW-Count
  Add #prev_hrs_mtd To #Deptid-HW-Previous-Hrs
  Add #curr_hrs_mtd To #Deptid-HW-Current-Hrs
  Add #grs_mtd      To #Deptid-HW-Amount

  Let #prev_hrs_mtd = 0
  Let #curr_hrs_mtd = 0
  Let #grs_mtd      = 0
End-Procedure


Begin-Procedure P300-Finish
#debug9 Show 'P300-Finish'

  Do P310-Print-Report-Totals

  date-time () HH:MI:SS &timeEnded
  date-time () MM/DD/YYYY &dateEnded
  show 'Report Ended at ' &timeEnded ' on ' &dateEnded
End-Procedure


Begin-Procedure P310-Print-Report-Totals
#debug9 Show 'P310-Print-Report-Totals'

  If $Data-Found-Flag <> 'Y'
    New-Page
    Print 'NO DATA SELECTED FOR THIS REPORT RUN'	(25,) Center
  End-If
End-Procedure


#include 'gexxx912.sqc'  !Get plan type multiple row table
#include 'gexxx927.sqc'  !Get vendor id multiple row table
#include 'getdptnm.sqc'  !Get-Department-Name procedure
#include 'getactnm.sqc'  !Get-Account-Name procedure
#include 'getprvnm.sqc'  !Get-Provider-Name procedure
#Include 'stdapi.sqc'    !Routines to Update Run Status
#Include 'curdttim.sqc'  !Get-Current-DateTime Procedure
#Include 'datetime.sqc'  !Routines for date and time formatting
#Include 'number.sqc'    !Routines to format numbers
#Include 'reset.sqc'     !Reset printer Procedure
#Include 'getbalid.sqc'  !Get-Calendar-Year-Id
#Include 'getposnm.sqc'  !Get-Position-Title procedure !VENDKXY Done the changes for ITG 65625
#Include 'getgeid.sqc'   !Get SSN !GEX_SEC_REENG 2015-04-29 Vahini Katta