!***********************************************************************
! GEXPY012:  Distribution Center Earnings Report                       *
!***********************************************************************
!                                                                      *
!               Confidentiality Information:                           *
!                                                                      *
! This module is the confidential and proprietary information of       *
! Giant Eagle, Inc.; it is not to be copied, reproduced,or transmitted *
! in any form, by any means, in whole or in part, nor is it to be used *
! for any purpose other than that for which it is expressly provided   *
! without the written permission of Giant Eagle.                       *
!                                                                      *
! Copyright (c) 1997-1998 Giant Eagle,Inc. All Rights Reserved         *
!                                                                      *
!***********************************************************************
!                                                                      *        
! GEXPY012 :            Distribution Center Earnings Report            *
!                                                                      *        
! Narrative:            This program creates a report of earnings      *
!                        broken out and accumulated in the following   *
!                        categories:  management salaries, clerical    *
!                        salaries, warehouse salaries, union salaries, *
!                        and non-union salaries.  Also, the final page *
!                        of the report will be a total of the earnings *
!                        for all distribution center employees.        *
!                                                                      *
! #Debugx Used:         #debug9 paragraph trace                        *
!                       #debug8 key variable values                    *
!			#debug7 data returned from sql calls           * 
!                                                                      *  
! SQL Tables:		pay_earnings                                   *
!                       pay_oth_earns                                  *
!                       gex_dept_tbl                                   *
!                       jobcode_tbl                                    *
!                       employment                                     *
!                       job                                            *
!                                                                      *
! Written by:		Jim Hutchison                                  *       
!                                                                      *
! Normally Run:		Weekly                                         *
!                                                                      *
! Control Parms:        FOR WHERE CLAUSE:                              *
!                         From Date                                    *
!                         Thru Date                                    *
!                         Business Unit(s)                             *
!                         Department(s)                                *
!                                                                      *
!***********************************************************************
!                         MODIFICATION HISTORY                         *
!***********************************************************************
! INITIALS     DATE         DESCRIPTION OF THE CHANGE                  *
!***********************************************************************
! JDH          10/12/99     Initial Creation                           *
!                                                                      *
! JNB          01/31/2000   Changed so that system will obtain from    *
!                           date and thru date if left blank on the    *
!                           panel.                                     *
!                                                                      *
! SXK          01/20/2000   Modified to have union from job_labor      *
!                                                                      *
! JNB          02/15/2000   Changed to report earnings with the same   *
!                           roll up as on the P&L statements           *
!                                                                      *
! AXL          11/15/2000   Added new training codes.                  *
!                                                                      *
! MRP          01/10/2001   COD Modifications:                         *
!                           Added Earn Codes 178,179,520,521,519,522,  *
!                           & 523 in P210-Pay-Oth-Earns Routine.       *
!                                                                      *
! AXL          02/19/2002   Added Trng earn cd 14A.                    *
!                                                                      *
! GBD          07/03/2002   Added new logic to determine what employees*
!                           get printed on the various reports that are*
!                           produced by this program.                  *
! PSR          08/06/2002     Modified UNION_CD FROM JOB_LABOR         * 
!                                     TO JOB   - Upgrade 8.3           *
!                                                                      *
! GBD          04/08/2003   Added Erncd 164 Pharmacy Night Premium to  *
!                           earnings code selection for oth earns amt. *
! Vendaxg      07/22/2008   Added logic for new earning Code 173       *
!***********************************************************************


#include 'setenv.sqc' !Set environment
#include 'setup32.sqc'


Begin-Setup
  Declare-Report Summary
Printer-Type=HPLASERJET
  End-Declare
  Declare-Report Management
Printer-Type=HPLASERJET
  End-Declare
  Declare-Report Clerical
Printer-Type=HPLASERJET
  End-Declare
  Declare-Report Warehouse
Printer-Type=HPLASERJET
  End-Declare
  Declare-Report Transportation
Printer-Type=HPLASERJET
  End-Declare
  Declare-Report Union
Printer-Type=HPLASERJET
  End-Declare
  Declare-Report NonUnion
Printer-Type=HPLASERJET
  End-Declare
  Declare-Report DC
Printer-Type=HPLASERJET
  End-Declare
End-Setup


Begin-Heading 5 For-Reports=(Summary)
#debug9 Show 'Begin-Heading'
  Let $ReportId = 'GEXPY12S'

#Include 'stdhdg01.sqc'

  If Rtrim($business_unit,' ') <> ''
    Print 'Bus. Unit'     (3,1)
    Print $business_unit  (3,13)
  End-If

  Let $hdr = 'Pay Period ' || $FromDate_mmddyy || ' thru ' || $ThruDate_mmddyy
  Print $hdr            (3,)  Center

  If Rtrim($department,' ') <> ''
    Print 'Department'    (4,1)
    Print $department     (4,13)
  End-If
End-Heading


Begin-Heading 7 For-Reports=(Management)
#debug9 Show 'Begin-Heading'
  Let $ReportId = 'GEXPY12D'

#Include 'stdhdg01.sqc'

  If Rtrim($business_unit,' ') <> ''
    Print 'Bus. Unit'     (3,1)
    Print $business_unit  (3,13)
  End-If

  Let $hdr = 'Pay Period ' || $FromDate_mmddyy || ' thru ' || $ThruDate_mmddyy
  Print $hdr            (3,)  Center

  If Rtrim($department,' ') <> ''
    Print 'Department'    (4,1)
    Print $department     (4,13)
  End-If

  Print 'Management Salaries Detail'   (4,)  Center

  Print 'Emplid'           (6,1)
  Print 'Empl Rcd#'        (,12)
!  Print 'Company'          (,27)
!  Print 'Paygroup'         (,40)
  print 'Name'             (,23) 
  Print 'Pay End Dt'       (,54)
  Print 'Reg Earns'        (,65)
  
  !VENDAXG Modified for ITG#   - Begin
  Print 'OTP Earns'        (,77)
  Print 'UOT Earns'	   (,89)
  Print 'Vac Earns'        (,101)
  Print 'Trn Earns'        (,113)
  Print 'Bns Earns'        (,125)   
  Print 'Wcp Earns'        (,137)   
  Print 'Hol Earns'        (,149)   
  Print 'Oth Earns'        (,161)
  !Print 'OTP Earns'        (,80)
  !Print 'Vac Earns'        (,95)
  !Print 'Trn Earns'        (,110)
  !Print 'Bns Earns'        (,125)   
  !Print 'Wcp Earns'        (,140)   
  !Print 'Hol Earns'        (,155)   
  !Print 'Oth Earns'        (,169)
  !VENDAXG Modified for ITG#   - End
  
End-Heading


Begin-Heading 7 For-Reports=(Clerical)
#debug9 Show 'Begin-Heading'
  Let $ReportId = 'GEXPY12D'

#Include 'stdhdg01.sqc'

  If Rtrim($business_unit,' ') <> ''
    Print 'Bus. Unit'     (3,1)
    Print $business_unit  (3,13)
  End-If

  Let $hdr = 'Pay Period ' || $FromDate_mmddyy || ' thru ' || $ThruDate_mmddyy
  Print $hdr            (3,)  Center

  If Rtrim($department,' ') <> ''
    Print 'Department'    (4,1)
    Print $department     (4,13)
  End-If

  Print 'Clerical Salaries Detail'   (4,)  Center

  Print 'Emplid'           (6,1)
  Print 'Empl Rcd#'        (,12)
!  Print 'Company'          (,27)
!  Print 'Paygroup'         (,40)
  print 'Name'             (,23) 
  Print 'Pay End Dt'       (,54)
  Print 'Reg Earns'        (,65)
  
 !VENDAXG Modified for ITG#   - Begin
  Print 'OTP Earns'        (,77)
  Print 'UOT Earns'	   (,89)
  Print 'Vac Earns'        (,101)
  Print 'Trn Earns'        (,113)
  Print 'Bns Earns'        (,125)   
  Print 'Wcp Earns'        (,137)   
  Print 'Hol Earns'        (,149)   
  Print 'Oth Earns'        (,161)
  !Print 'OTP Earns'        (,80)
  !Print 'Vac Earns'        (,95)
  !Print 'Trn Earns'        (,110)
  !Print 'Bns Earns'        (,125)   
  !Print 'Wcp Earns'        (,140)   
  !Print 'Hol Earns'        (,155)   
  !Print 'Oth Earns'        (,169)
 !VENDAXG Modified for ITG#   - End
End-Heading


Begin-Heading 7 For-Reports=(Warehouse)
#debug9 Show 'Begin-Heading'
  Let $ReportId = 'GEXPY12D'

#Include 'stdhdg01.sqc'

  If Rtrim($business_unit,' ') <> ''
    Print 'Bus. Unit'     (3,1)
    Print $business_unit  (3,13)
  End-If

  Let $hdr = 'Pay Period ' || $FromDate_mmddyy || ' thru ' || $ThruDate_mmddyy
  Print $hdr            (3,)  Center

  If Rtrim($department,' ') <> ''
    Print 'Department'    (4,1)
    Print $department     (4,13)
  End-If

  Print 'Warehouse Salaries Detail'   (4,)  Center

  Print 'Emplid'           (6,1)
  Print 'Empl Rcd#'        (,12)
!  Print 'Company'          (,27)
!  Print 'Paygroup'         (,40)
  print 'Name'             (,23) 
  Print 'Pay End Dt'       (,54)
  Print 'Reg Earns'        (,65)
  
  !VENDAXG Modified for ITG#   - Begin
  Print 'OTP Earns'        (,77)
  Print 'UOT Earns'	   (,89)
  Print 'Vac Earns'        (,101)
  Print 'Trn Earns'        (,113)
  Print 'Bns Earns'        (,125)   
  Print 'Wcp Earns'        (,137)   
  Print 'Hol Earns'        (,149)   
  Print 'Oth Earns'        (,161)
  !Print 'OTP Earns'        (,80)
  !Print 'Vac Earns'        (,95)
  !Print 'Trn Earns'        (,110)
  !Print 'Bns Earns'        (,125)   
  !Print 'Wcp Earns'        (,140)   
  !Print 'Hol Earns'        (,155)   
  !Print 'Oth Earns'        (,169)
  !VENDAXG Modified for ITG#   - End
  
End-Heading


Begin-Heading 7 For-Reports=(Transportation)
#debug9 Show 'Begin-Heading'
  Let $ReportId = 'GEXPY12D'

#Include 'stdhdg01.sqc'

  If Rtrim($business_unit,' ') <> ''
    Print 'Bus. Unit'     (3,1)
    Print $business_unit  (3,13)
  End-If

  Let $hdr = 'Pay Period ' || $FromDate_mmddyy || ' thru ' || $ThruDate_mmddyy
  Print $hdr            (3,)  Center

  If Rtrim($department,' ') <> ''
    Print 'Department'    (4,1)
    Print $department     (4,13)
  End-If

  Print 'Transportation Salaries Detail'   (4,)  Center

  Print 'Emplid'           (6,1)
  Print 'Empl Rcd#'        (,12)
!  Print 'Company'          (,27)
!  Print 'Paygroup'         (,40)
  print 'Name'             (,23) 
  Print 'Pay End Dt'       (,54)
  Print 'Reg Earns'        (,65)
  
  !VENDAXG Modified for ITG#   - Begin
  Print 'OTP Earns'        (,77)
  Print 'UOT Earns'	   (,89)
  Print 'Vac Earns'        (,101)
  Print 'Trn Earns'        (,113)
  Print 'Bns Earns'        (,125)   
  Print 'Wcp Earns'        (,137)   
  Print 'Hol Earns'        (,149)   
  Print 'Oth Earns'        (,161)
  !Print 'OTP Earns'        (,80)
  !Print 'Vac Earns'        (,95)
  !Print 'Trn Earns'        (,110)
  !Print 'Bns Earns'        (,125)   
  !Print 'Wcp Earns'        (,140)   
  !Print 'Hol Earns'        (,155)   
  !Print 'Oth Earns'        (,169)
  !VENDAXG Modified for ITG#   - End

End-Heading


Begin-Heading 7 For-Reports=(Union)
#debug9 Show 'Begin-Heading'
  Let $ReportId = 'GEXPY12D'

#Include 'stdhdg01.sqc'

  If Rtrim($business_unit,' ') <> ''
    Print 'Bus. Unit'     (3,1)
    Print $business_unit  (3,13)
  End-If

  Let $hdr = 'Pay Period ' || $FromDate_mmddyy || ' thru ' || $ThruDate_mmddyy
  Print $hdr            (3,)  Center

  If Rtrim($department,' ') <> ''
    Print 'Department'    (4,1)
    Print $department     (4,13)
  End-If

  Print 'Union Salaries Detail'   (4,)  Center

  Print 'Emplid'           (6,1)
  Print 'Empl Rcd#'        (,12)
!  Print 'Company'          (,27)
!  Print 'Paygroup'         (,40)
  print 'Name'             (,23) 
  Print 'Pay End Dt'       (,54)
  Print 'Reg Earns'        (,65)
  
 !VENDAXG Modified for ITG#   - Begin 
  Print 'OTP Earns'        (,77)
  Print 'UOT Earns'	   (,89)
  Print 'Vac Earns'        (,101)
  Print 'Trn Earns'        (,113)
  Print 'Bns Earns'        (,125)   
  Print 'Wcp Earns'        (,137)   
  Print 'Hol Earns'        (,149)   
  Print 'Oth Earns'        (,161)
  !Print 'OTP Earns'        (,80)
  !Print 'Vac Earns'        (,95)
  !Print 'Trn Earns'        (,110)
  !Print 'Bns Earns'        (,125)   
  !Print 'Wcp Earns'        (,140)   
  !Print 'Hol Earns'        (,155)   
  !Print 'Oth Earns'        (,169)
 !VENDAXG Modified for ITG#   - End
  
End-Heading


Begin-Heading 7 For-Reports=(NonUnion)
#debug9 Show 'Begin-Heading'
  Let $ReportId = 'GEXPY12D'

#Include 'stdhdg01.sqc'

  If Rtrim($business_unit,' ') <> ''
    Print 'Bus. Unit'     (3,1)
    Print $business_unit  (3,13)
  End-If

  Let $hdr = 'Pay Period ' || $FromDate_mmddyy || ' thru ' || $ThruDate_mmddyy
  Print $hdr            (3,)  Center

  If Rtrim($department,' ') <> ''
    Print 'Department'    (4,1)
    Print $department     (4,13)
  End-If

  Print 'Non-Union Salaries Detail'   (4,)  Center

  Print 'Emplid'           (6,1)
  Print 'Empl Rcd#'        (,12)
!  Print 'Company'          (,27)
!  Print 'Paygroup'         (,40)
  print 'Name'             (,23) 
  Print 'Pay End Dt'       (,54)
  Print 'Reg Earns'        (,65)
  
 !VENDAXG Modified for ITG#   - Begin 
  Print 'OTP Earns'        (,77)
  Print 'UOT Earns'	   (,89)
  Print 'Vac Earns'        (,101)
  Print 'Trn Earns'        (,113)
  Print 'Bns Earns'        (,125)   
  Print 'Wcp Earns'        (,137)   
  Print 'Hol Earns'        (,149)   
  Print 'Oth Earns'        (,161)
  !Print 'OTP Earns'        (,80)
  !Print 'Vac Earns'        (,95)
  !Print 'Trn Earns'        (,110)
  !Print 'Bns Earns'        (,125)   
  !Print 'Wcp Earns'        (,140)   
  !Print 'Hol Earns'        (,155)   
  !Print 'Oth Earns'        (,169)
 !VENDAXG Modified for ITG#   - Begin 

End-Heading


Begin-Heading 7 For-Reports=(DC)
#debug9 Show 'Begin-Heading'
  Let $ReportId = 'GEXPY12D'

#Include 'stdhdg01.sqc'

  If Rtrim($business_unit,' ') <> ''
    Print 'Bus. Unit'     (3,1)
    Print $business_unit  (3,13)
  End-If

  Let $hdr = 'Pay Period ' || $FromDate_mmddyy || ' thru ' || $ThruDate_mmddyy
  Print $hdr            (3,)  Center

  If Rtrim($department,' ') <> ''
    Print 'Department'    (4,1)
    Print $department     (4,13)
  End-If

  Print 'Distribution Center Salaries Detail'   (4,)  Center

  Print 'Emplid'           (6,1)
  Print 'Empl Rcd#'        (,12)
!  Print 'Company'          (,27)
!  Print 'Paygroup'         (,40)
  print 'Name'             (,23) 
  Print 'Pay End Dt'       (,54)
  Print 'Reg Earns'        (,65)
  
 !VENDAXG Modified for ITG#   - Begin 
  Print 'OTP Earns'        (,77)
  Print 'UOTS Earns'	   (,89)
  Print 'Vac Earns'        (,101)
  Print 'Trn Earns'        (,113)
  Print 'Bns Earns'        (,125)   
  Print 'Wcp Earns'        (,137)   
  Print 'Hol Earns'        (,149)   
  Print 'Oth Earns'        (,161)
  !Print 'OTP Earns'        (,80)
  !Print 'Vac Earns'        (,95)
  !Print 'Trn Earns'        (,110)
  !Print 'Bns Earns'        (,125)   
  !Print 'Wcp Earns'        (,140)   
  !Print 'Hol Earns'        (,155)   
  !Print 'Oth Earns'        (,169)
 !VENDAXG Modified for ITG#   - End

End-Heading


Begin-Report
#debug9 Show 'Begin-Report'
  Do P100-Initialization
  Do P200-Main-Process
  Do P300-Finalization
End-Report


Begin-Procedure P100-Initialization
#debug9 Show 'P100-Initialization'
  Do Init-DateTime           !datetime.sqc
  Do Init-Number             !number.sqc
  Do Get-Current-DateTime    !curdttim.sqc
  Do Stdapi-Init             !stdapi.sqc

  Let $ReportID      = 'GEXPY012'
  Let $ReportTitle   = 'DISTRIBUTION CENTER EARNINGS REPORT'

  Show '$ReportID    = ' $ReportID
  Show '$ReportTitle = ' $ReportTitle

  Let $GEXXX935_Department_Alias    = 'gdt.department'
  Let $GEXXX936_Business_Unit_Alias = 'gdt.business_unit'

  If $prcs_process_instance = ''


    Do Ask-From-Thru-Date

    Let $BusinessUnitString = ''''
    Display 'Enter Business Unit or leave blank to exit.'
    While 1=1
      Input $In-BusinessUnit Maxlen=5 'Business Unit'
      Uppercase $In-BusinessUnit
      If Rtrim($In-BusinessUnit, ' ') = ''
        Concat '''' With $BusinessUnitString
        Break
      End-If
      If $BusinessUnitString <> ''''
        Concat ''',''' With $BusinessUnitString
      End-If
      Concat $In-BusinessUnit With $BusinessUnitString
    End-While

    Let $DepartmentString = ''''
    Display 'Enter Department or leave blank to exit.'
    While 1=1
      Input $In-Department Maxlen=10 'Department'
      Uppercase $In-Department
      If Rtrim($In-Department, ' ') = ''
        Concat '''' With $DepartmentString
        Break
      End-If
      If $DepartmentString <> ''''
        Concat ''',''' With $DepartmentString
      End-If
      Concat $In-Department With $DepartmentString
    End-While

    If $BusinessUnitString = ''''''
      Let $GEXXX936_INCLUDE_BUSINESS_UNIT_CRITERIA = '1=1'
      Let $GEXXX936_INCLUDE_BUSINESS_UNIT_DISPLAY_CRITERIA = 'ALL'
    Else
      Let $GEXXX936_INCLUDE_BUSINESS_UNIT_CRITERIA = $GEXXX936_Business_Unit_Alias || ' In (' || $BusinessUnitString || ')'
      Let $GEXXX936_INCLUDE_BUSINESS_UNIT_DISPLAY_CRITERIA = $GEXXX936_INCLUDE_BUSINESS_UNIT_CRITERIA
    End-If

    If $DepartmentString = ''''''
      Let $GEXXX935_INCLUDE_DEPARTMENT_CRITERIA = '1=1'
      Let $GEXXX935_INCLUDE_DEPARTMENT_DISPLAY_CRITERIA = 'ALL'
    Else
      Let $GEXXX935_INCLUDE_DEPARTMENT_CRITERIA = $GEXXX935_Department_Alias || ' In (' || $DepartmentString || ')'
      Let $GEXXX935_INCLUDE_DEPARTMENT_DISPLAY_CRITERIA = $GEXXX935_INCLUDE_DEPARTMENT_CRITERIA
    End-If
  Else
    Do GEXXX922-Select-Parameters
    Do GEXXX935-Select-Department-Parameters
    Do GEXXX936-Select-Business-Unit-Parameters
    Let $FromDate = $GEX_RC_PAY.FromDate
    Let $ThruDate = $GEX_RC_PAY.ThruDate
    If Rtrim($FromDate,' ') = '' Or
       Rtrim($ThruDate,' ') = ''
!      Show 'From and Thru Dates are required parameters for this report'  JNB 01/31/2000
!      Stop                                                                JNB 01/31/2000
       do get-pay-end-dt                                                  !JNB 01/31/2000 
    End-If
  End-If

  date-time () HH:MI:SS &timeBegan
  date-time () MM/DD/YYYY &dateBegan
  show ' '
  show 'Report Began at ' &timeBegan ' on ' &dateBegan

  Show '$GEXXX935_Include_Department_Display_Criteria = ' $GEXXX935_Include_Department_Display_Criteria
  Show '$GEXXX936_Include_Business_Unit_Display_Criteria = ' $GEXXX936_Include_Business_Unit_Display_Criteria
  Show '$FromDate: ' $FromDate
  Show '$ThruDate: ' $ThruDate

  Do Format-DateTime($FromDate,$FromDate_mmddyy, {DEFMDY}, '', '')
  Do Format-DateTime($ThruDate,$ThruDate_mmddyy, {DEFMDY}, '', '')

  Use-Report Summary
  Do P130-Print-Cover-Page

  Use-Report Management
  Do P130-Print-Cover-Page
End-Procedure


Begin-Procedure P130-Print-Cover-Page
#debug9 Show 'P130-Print-Cover-Page'
  Print 'RUN CONTROL INFORMATION FOR THIS REPORT RUN:'            (+5,1)
  Print '$Prcs_OprID          ='                                  (+2,5)
  Print $Prcs_OprID                                               (0,+2)
  Print '$Prcs_Run_Cntl_ID    ='                                  (+1,5)
  Print $Prcs_Run_Cntl_ID                                         (0,+2)

  Print 'SELECTION CRITERIA FOR THIS REPORT RUN:'                 (+5,2)
  Print '$GEXXX935_Include_Department_Display_Criteria ='         (+1,5)
  Print $GEXXX935_Include_Department_Display_Criteria             (0,+2)
  Print '$GEXXX936_Include_Business_Unit_Display_Criteria ='      (+1,5)
  Print $GEXXX936_Include_Business_Unit_Display_Criteria          (0,+2)

  Print 'From Date:'    (+2,5)
  Print $FromDate       (0,+2)
  Print 'Thru Date:'    (+1,5)
  Print $ThruDate       (0,+2)


  Let #PAGE-COUNT = 0
  NEW-PAGE
End-Procedure


Begin-Procedure P200-Main-Process
#debug9 Show 'P200-Main-Process'
Begin-Select
gdt.business_unit ()  On-Break  Level=1
                                Print=Never
                                After=P260-Business-Unit-Break

gdt.department    ()  On-Break  Level=2
                                Print=Never
                                After=P250-Deptid-Break

pe.emplid         ()  On-Break  Level=3
                                Print=Never

pe.empl_rcd      ()  On-Break  Level=4
                                Print=Never

pe.pay_end_dt     ()  On-Break  Level=5
                                Print=Never
                                After=P230-Evaluate-Detail

J.UNION_CD
jt.manager_level
!GBD 07/03/2002 Begin
j.sal_admin_plan
!GBD 07/03/2002 End
j.acct_cd
pe.company
pe.paygroup
pe.off_cycle
pe.page_num
pe.line_num
pe.addl_nbr
pe.reg_earns+pe.reg_hrly_earns &reg_earns
pe.ot_hrly_earns               &otp_earns

  let $business_unit = &gdt.business_unit
  let $department    = &gdt.department
  let $emplid        = &pe.emplid
  let #empl_rcd      = &pe.empl_rcd
  let $company       = &pe.company
  let $paygroup      = &pe.paygroup
  let $pay_end_dt    = &pe.pay_end_dt
  let $off_cycle     = &pe.off_cycle
  let #page          = &pe.page_num
  let #line          = &pe.line_num
  let #addl          = &pe.addl_nbr
  let #reg_earns     = &reg_earns
  let #otp_earns     = &otp_earns
  let #vac_earns     = 0
  let #other_earns   = 0
  let #trn_earns     = 0    !jnb 02/15/2000
  let #bns_earns     = 0    !jnb 02/15/2000
  let #wcp_earns     = 0    !jnb 02/15/2000
  let #hol_earns     = 0    !jnb 02/15/2000
  let #173_earns     = 0    !Vendaxg Added for ITG#   on 07/31/2008 

  let $m-report = 'N'
  let $c-report = 'N'
  let $w-report = 'N'
  let $t-report = 'N'
  let $u-report = 'N'
  let $n-report = 'N'

  Do P190-Obtain-Name 
  Do P210-Pay-Oth-Earns

!GBD 07/03/2002 Begin

!Management Report
  if &j.sal_admin_plan = 'EXE' and 
    (&j.acct_cd  = 'XXX' or &j.acct_cd = '801')
     Let $m-report = 'Y'
     Let $m-det-report = 'Y'
     Let $m-data-found = 'Y'
  end-if

!Clerical Report
  if &j.sal_admin_plan = 'NEX' and
    (&j.acct_cd = 'XXX' or &j.acct_cd = '801')
     Let $c-report = 'Y'
     Let $c-det-report = 'Y'
     Let $c-data-found = 'Y'     
  end-if

!Warehouse Report
  if &j.acct_cd = '803' or &j.acct_cd = '804'
     Let $w-report = 'Y'
     Let $w-det-report = 'Y'
     Let $w-data-found = 'Y'
  end-if

!Transportation Report
  if &j.acct_cd = '802' or &j.acct_cd = '805' or &j.acct_cd = '806'
     Let $t-report = 'Y'
     Let $t-det-report = 'Y'
     Let $t-data-found = 'Y'
  end-if

!Union Report
  if &j.acct_cd = '802' or &j.acct_cd = '803' or &j.acct_cd = '804' or
     &j.acct_cd = '805' or &j.acct_cd = '806'
     Let $u-report = 'Y'
     Let $u-det-report = 'Y'
     Let $u-data-found = 'Y'
  end-if

!Nonunion Report
  if &j.sal_admin_plan = 'EXE' or &j.sal_admin_plan = 'NEX'
     Let $n-report = 'Y'
     Let $n-det-report = 'Y'
     Let $n-data-found = 'Y'
  end-if

!********** Old Logic **********
!  If &jt.manager_level <> '99'
!    Let $m-report = 'Y'
!    Let $m-det-report = 'Y'
!    Let $m-data-found = 'Y'
!  Else
!    If &jl.union_cd = 'NON'
!      Let $c-report = 'Y'
!      Let $c-det-report = 'Y'
!      Let $c-data-found = 'Y'
!    End-If
!  End-If
!
!  If &jl.union_cd = 'NON'
!    Let $n-report = 'Y'
!    Let $n-det-report = 'Y'
!    Let $n-data-found = 'Y'
!  Else
!    Let $u-report = 'Y'
!    Let $u-det-report = 'Y'
!    Let $u-data-found = 'Y'
!    If (&j.acct_cd   = '802' Or
!        &j.acct_cd   = '805' Or
!        &j.acct_cd   = '806')
!      Let $t-report = 'Y'
!      Let $t-det-report = 'Y'
!      Let $t-data-found = 'Y'
!    Else
!      Let $w-report = 'Y'
!      Let $w-det-report = 'Y'
!      Let $w-data-found = 'Y'
!    End-If
!  End-If
!*******************************
!GBD 07/03/2002 End

  If $m-report = 'Y'
    Add #reg_earns   To #m_det_reg_earns
    Add #otp_earns   To #m_det_otp_earns
    Add #173_earns   To #m_det_173_earns 	!Vendaxg Added for ITG#   on 07/08/2008 
    Add #vac_earns   To #m_det_vac_earns
    Add #other_earns To #m_det_other_earns
    Add #trn_earns   To #m_det_trn_earns     !jnb 02/15/2000
    Add #bns_earns   To #m_det_bns_earns     !jnb 02/15/2000
    Add #wcp_earns   To #m_det_wcp_earns     !jnb 02/15/2000
    Add #hol_earns   To #m_det_hol_earns     !jnb 02/15/2000
  End-If

  If $c-report = 'Y'
    Add #reg_earns   To #c_det_reg_earns
    Add #otp_earns   To #c_det_otp_earns
    Add #173_earns   To #c_det_173_earns 	!Vendaxg Added for ITG#   on 07/08/2008 
    Add #vac_earns   To #c_det_vac_earns
    Add #other_earns To #c_det_other_earns
    Add #trn_earns   To #c_det_trn_earns     !jnb 02/15/2000
    Add #bns_earns   To #c_det_bns_earns     !jnb 02/15/2000
    Add #wcp_earns   To #c_det_wcp_earns     !jnb 02/15/2000
    Add #hol_earns   To #c_det_hol_earns     !jnb 02/15/2000

  End-If

  If $w-report = 'Y'
    Add #reg_earns   To #w_det_reg_earns
    Add #otp_earns   To #w_det_otp_earns
    Add #173_earns   To #w_det_173_earns 	!Vendaxg Added for ITG#   on 07/08/2008 
    Add #vac_earns   To #w_det_vac_earns
    Add #other_earns To #w_det_other_earns
    Add #trn_earns   To #w_det_trn_earns     !jnb 02/15/2000
    Add #bns_earns   To #w_det_bns_earns     !jnb 02/15/2000
    Add #wcp_earns   To #w_det_wcp_earns     !jnb 02/15/2000
    Add #hol_earns   To #w_det_hol_earns     !jnb 02/15/2000

  End-If

  If $t-report = 'Y'
    Add #reg_earns   To #t_det_reg_earns
    Add #otp_earns   To #t_det_otp_earns
    Add #173_earns   To #t_det_173_earns 	!Vendaxg Added for ITG#   on 07/08/2008 
    Add #vac_earns   To #t_det_vac_earns
    Add #other_earns To #t_det_other_earns
    Add #trn_earns   To #t_det_trn_earns     !jnb 02/15/2000
    Add #bns_earns   To #t_det_bns_earns     !jnb 02/15/2000
    Add #wcp_earns   To #t_det_wcp_earns     !jnb 02/15/2000
    Add #hol_earns   To #t_det_hol_earns     !jnb 02/15/2000

  End-If

  If $u-report = 'Y'
    Add #reg_earns   To #u_det_reg_earns
    Add #otp_earns   To #u_det_otp_earns
    Add #173_earns   To #u_det_173_earns 	!Vendaxg Added for ITG#   on 07/08/2008 
    Add #vac_earns   To #u_det_vac_earns
    Add #other_earns To #u_det_other_earns
    Add #trn_earns   To #u_det_trn_earns     !jnb 02/15/2000
    Add #bns_earns   To #u_det_bns_earns     !jnb 02/15/2000
    Add #wcp_earns   To #u_det_wcp_earns     !jnb 02/15/2000
    Add #hol_earns   To #u_det_hol_earns     !jnb 02/15/2000

  End-If

  If $n-report = 'Y'
    Add #reg_earns   To #n_det_reg_earns
    Add #otp_earns   To #n_det_otp_earns
    Add #173_earns   To #n_det_173_earns 	!Vendaxg Added for ITG#   on 07/08/2008 
    Add #vac_earns   To #n_det_vac_earns
    Add #other_earns To #n_det_other_earns
    Add #trn_earns   To #n_det_trn_earns     !jnb 02/15/2000
    Add #bns_earns   To #n_det_bns_earns     !jnb 02/15/2000
    Add #wcp_earns   To #n_det_wcp_earns     !jnb 02/15/2000
    Add #hol_earns   To #n_det_hol_earns     !jnb 02/15/2000

  End-If

  Add #reg_earns   To #r_det_reg_earns
  Add #otp_earns   To #r_det_otp_earns
  Add #173_earns   To #r_det_173_earns   	!Vendaxg Added for ITG#   on 07/08/2008   
  Add #vac_earns   To #r_det_vac_earns
  Add #other_earns To #r_det_other_earns
  Add #trn_earns   To #r_det_trn_earns     !jnb 02/15/2000
  Add #bns_earns   To #r_det_bns_earns     !jnb 02/15/2000
  Add #wcp_earns   To #r_det_wcp_earns     !jnb 02/15/2000
  Add #hol_earns   To #r_det_hol_earns     !jnb 02/15/2000


From   ps_gex_dept_tbl  gdt,
       ps_jobcode_tbl   jt,
       ps_pay_earnings  pe,
       ps_job           j

Where  j.emplid                 = pe.emplid
AND    j.empl_rcd              = pe.empl_rcd
AND pe.company = j.company
AND pe.paygroup = j.paygroup 
And    pe.pay_end_dt       Between $FromDate And $ThruDate
      and j.effdt                   =
      (Select Max(effdt)
       From   ps_job
       Where  emplid             = j.emplid
       And    empl_rcd          = j.empl_rcd
       And    effdt             <= pe.pay_end_dt)

And    j.effseq                  =
      (Select Max(effseq)
       From   ps_job
       Where  emplid             = j.emplid
       And    empl_rcd          = j.empl_rcd
       And    effdt              = j.effdt)
    AND gdt.setid  = 'COMMN'
And    gdt.deptid                = Decode(Rtrim(j.gex_deptid_ovr,' '),null,pe.deptid,j.gex_deptid_ovr)

And    gdt.effdt                 =
      (Select Max(effdt)
       From   ps_gex_dept_tbl
       Where  deptid             = gdt.deptid
       And    effdt             <= pe.pay_end_dt)

And    gdt.sequence_number       =
      (Select Max(sequence_number)
       From   ps_gex_dept_tbl
       Where  deptid             = gdt.deptid
       And    effdt              = gdt.effdt)
AND jt.setid = 'COMMN'
And    jt.jobcode                = pe.jobcode

And    jt.effdt                  =
      (Select Max(effdt)
       From   ps_jobcode_tbl
       Where  jobcode            = jt.jobcode
       And    effdt             <= pe.pay_end_dt)

And   [$GEXXX935_Include_Department_Criteria]
And   [$GEXXX936_Include_Business_Unit_Criteria]

Order By gdt.business_unit, gdt.department, pe.emplid, pe.empl_rcd, pe.pay_end_dt
End-Select
End-Procedure

Begin-Procedure P190-Obtain-Name 
#debug9 Show 'P190-Obtain-Name'
Begin-Select
p.name &p.name

From   ps_personal_data  p

where  p.emplid = $emplid

End-Select
End-Procedure


Begin-Procedure P210-Pay-Oth-Earns
#debug9 Show 'P210-Pay-Oth-Earns'
Begin-Select
poe.erncd
poe.oth_earns

  Evaluate &poe.erncd
    When = 'REG'
    When = '008'
    When = '506'
    When = '170'
    When = '200'
    When = '004'
    when = '164'                        ! GBD 04/08/2003 Erncd Added
    When = '165'
    When = '168'
    When = '166'
    When = '167'
    When = '176'
    When = '175'
    When = '169'
    When = '560'
    When = 'ADJ'
    When = '178'                        !COD mod, MRP, 01/09/2001
       Add &poe.oth_earns To #reg_earns
      Break
    When = 'OTP'
    When = '002'
    When = '003'
    When = '171'
    When = '001'
    When = '006'
    When = '005'
    When = '172'
    When = '179'                        !COD mod, MRP, 01/09/2001
      Add &poe.oth_earns To #otp_earns
      Break
    When = '513'
    When = '515'
    When = '519'                        !COD mod, MRP, 01/09/2001
    When = '522'                        !COD mod, MRP, 01/09/2001
    When = '523'                        !COD mod, MRP, 01/09/2001
      Add &poe.oth_earns To #vac_earns
      Break
    When = '150'
    When = '151'
    When = '152'
    When = '153'
    When = '154'
    When = '155'
    When = '156'
    When = '140'
    When = '141'
    When = '142'
    When = '143'
    When = '144'
    When = '145'
    When = '146'
    !AXL 11/15/2000 New Trng Codes - Begin
    When = '147'
    When = '148'
    When = '149'
    !AXL 11/15/2000 New Trng Codes - End
    When = '14A'  	!AXL 02/19/2002 New Trng Code Add
      Add &poe.oth_earns To #trn_earns
      Break
    When = '510'
    When = '511'
    When = '512'
    When = '517'
      Add &poe.oth_earns To #bns_earns
      Break
    !VENDAXG added for ITG# -   - Begin 
    When = '173'
    show &poe.oth_earns 
      Add &poe.oth_earns To #173_earns
      Break    
    !VENDAXG added for ITG# -   - End
    
    When = '509'
      Add &poe.oth_earns To #wcp_earns
      Break
    When = 'HOL'
    When = '502'
    When = '505'
    When = '514'
    When = '520'                        !COD mod, MRP, 01/09/2001
    When = '521'                        !COD mod, MRP, 01/09/2001
      Add &poe.oth_earns To #hol_earns
      Break    
    When-Other
      Add &poe.oth_earns To #other_earns
  End-Evaluate

From   ps_pay_oth_earns  poe

Where  company    = &pe.company
And    paygroup   = &pe.paygroup
And    pay_end_dt = &pe.pay_end_dt
And    off_cycle  = &pe.off_cycle
And    page_num      = &pe.page_num
And    line_num      = &pe.line_num
And    addl_nbr      = &pe.addl_nbr
End-Select
End-Procedure


Begin-Procedure P220-Print-Summary
#debug9 Show 'P220-Print-Summary'
  Use-Report Summary

!Vendaxg Modified for ITG# on 07/08/2008 - Begin
  !Let #total = #reg + #otp + #vac +  #trn + #bns + #wcp + #hol + #other !jnb 02/15/00
  Let #total = #reg + #otp + #173 + #vac +  #trn + #bns + #wcp + #hol + #other !jnb 02/15/00
!Vendaxg Modified for ITG# on 07/08/2008 - End
  Print $group                       (+3,1)

  Print 'Regular Salaries'           (+2,5)
  Print #reg                         (,32)       Edit 999,999,999.99
  Print 'Overtime Salaries'          (+1,5)
  Print #otp                         (,32)       Edit 999,999,999.99
  !Vendaxg Added for ITG# on 07/08/2008 - Begin
  Print 'Uncontrllable OT Salaries'          (+1,5)
  Print #173                         (,32)       Edit 999,999,999.99
  !Vendaxg Added for ITG# on 07/08/2008 - End
  Print 'Vacation '                  (+1,5)
  Print #vac                         (,32)       Edit 999,999,999.99
  Print 'Training '                  (+1,5)                             !jnb 02/15/2000
  Print #trn                         (,32)       Edit 999,999,999.99    !jnb 02/15/2000 
  Print 'Bonus '                     (+1,5)                             !jnb 02/15/2000
  Print #bns                         (,32)       Edit 999,999,999.99    !jnb 02/15/2000 
  Print 'Workers Comp '              (+1,5)                             !jnb 02/15/2000
  Print #wcp                         (,32)       Edit 999,999,999.99    !jnb 02/15/2000 
  Print 'Holiday '                   (+1,5)                             !jnb 02/15/2000
  Print #hol                         (,32)       Edit 999,999,999.99    !jnb 02/15/2000 
  Print 'Other Salaries'             (+1,5)
  Print #other                       (,32)       Edit 999,999,999.99
  Print '-'                          (+1,32,14)  Fill
  Print #total                       (+1,32)     Edit 999,999,999.99
End-Procedure


Begin-Procedure P230-Evaluate-Detail
#debug9 Show 'P230-Evaluate-Detail'
  If $m-det-report = 'Y'
    Use-Report Management
    Let #det_reg_earns   = #m_det_reg_earns
    Let #det_otp_earns   = #m_det_otp_earns
    Let #det_173_earns   = #m_det_173_earns		!Vendaxg Added for ITG#   on 07/08/2008
    Let #det_vac_earns   = #m_det_vac_earns
    Let #det_trn_earns   = #m_det_trn_earns   !jnb 02/15/2000
    Let #det_bns_earns   = #m_det_bns_earns   !jnb 02/15/2000
    Let #det_wcp_earns   = #m_det_wcp_earns   !jnb 02/15/2000
    Let #det_hol_earns   = #m_det_hol_earns   !jnb 02/15/2000
    Let #det_other_earns = #m_det_other_earns
    Do P240-Print-Detail
  End-If

  If $c-det-report = 'Y'
    Use-Report Clerical
    Let #det_reg_earns   = #c_det_reg_earns
    Let #det_otp_earns   = #c_det_otp_earns
    Let #det_173_earns   = #c_det_173_earns		!Vendaxg Added for ITG#   on 07/08/2008
    Let #det_vac_earns   = #c_det_vac_earns
    Let #det_trn_earns   = #c_det_trn_earns   !jnb 02/15/2000
    Let #det_bns_earns   = #c_det_bns_earns   !jnb 02/15/2000
    Let #det_wcp_earns   = #c_det_wcp_earns   !jnb 02/15/2000
    Let #det_hol_earns   = #c_det_hol_earns   !jnb 02/15/2000
    Let #det_other_earns = #c_det_other_earns
    Do P240-Print-Detail
  End-If

  If $w-det-report = 'Y'
    Use-Report Warehouse
    Let #det_reg_earns   = #w_det_reg_earns
    Let #det_otp_earns   = #w_det_otp_earns
    Let #det_173_earns   = #w_det_173_earns		!Vendaxg Added for ITG#   on 07/08/2008
    Let #det_vac_earns   = #w_det_vac_earns
    Let #det_trn_earns   = #w_det_trn_earns   !jnb 02/15/2000
    Let #det_bns_earns   = #w_det_bns_earns   !jnb 02/15/2000
    Let #det_wcp_earns   = #w_det_wcp_earns   !jnb 02/15/2000
    Let #det_hol_earns   = #w_det_hol_earns   !jnb 02/15/2000
    Let #det_other_earns = #w_det_other_earns
    Do P240-Print-Detail
  End-If

  If $t-det-report = 'Y'
    Use-Report Transportation
    Let #det_reg_earns   = #t_det_reg_earns
    Let #det_otp_earns   = #t_det_otp_earns
    Let #det_173_earns   = #t_det_173_earns		!Vendaxg Added for ITG#   on 07/08/2008
    Let #det_vac_earns   = #t_det_vac_earns
    Let #det_trn_earns   = #t_det_trn_earns   !jnb 02/15/2000
    Let #det_bns_earns   = #t_det_bns_earns   !jnb 02/15/2000
    Let #det_wcp_earns   = #t_det_wcp_earns   !jnb 02/15/2000
    Let #det_hol_earns   = #t_det_hol_earns   !jnb 02/15/2000
    Let #det_other_earns = #t_det_other_earns
    Do P240-Print-Detail
  End-If

  If $u-det-report = 'Y'
    Use-Report Union
    Let #det_reg_earns   = #u_det_reg_earns
    Let #det_otp_earns   = #u_det_otp_earns
    Let #det_173_earns   = #u_det_173_earns		!Vendaxg Added for ITG#   on 07/08/2008
    Let #det_vac_earns   = #u_det_vac_earns
    Let #det_trn_earns   = #u_det_trn_earns   !jnb 02/15/2000
    Let #det_bns_earns   = #u_det_bns_earns   !jnb 02/15/2000
    Let #det_wcp_earns   = #u_det_wcp_earns   !jnb 02/15/2000
    Let #det_hol_earns   = #u_det_hol_earns   !jnb 02/15/2000
    Let #det_other_earns = #u_det_other_earns
    Do P240-Print-Detail
  End-If

  If $n-det-report = 'Y'
    Use-Report NonUnion
    Let #det_reg_earns   = #n_det_reg_earns
    Let #det_otp_earns   = #n_det_otp_earns
    Let #det_173_earns   = #n_det_173_earns		!Vendaxg Added for ITG#   on 07/08/2008
    Let #det_vac_earns   = #n_det_vac_earns
    Let #det_trn_earns   = #n_det_trn_earns   !jnb 02/15/2000
    Let #det_bns_earns   = #n_det_bns_earns   !jnb 02/15/2000
    Let #det_wcp_earns   = #n_det_wcp_earns   !jnb 02/15/2000
    Let #det_hol_earns   = #n_det_hol_earns   !jnb 02/15/2000
    Let #det_other_earns = #n_det_other_earns
    Do P240-Print-Detail
  End-If

  Use-Report DC
  Let #det_reg_earns   = #r_det_reg_earns
  Let #det_otp_earns   = #r_det_otp_earns
  Let #det_173_earns   = #r_det_173_earns		!Vendaxg Added for ITG#   on 07/08/2008  
  Let #det_vac_earns   = #r_det_vac_earns
  Let #det_trn_earns   = #r_det_trn_earns   !jnb 02/15/2000
  Let #det_bns_earns   = #r_det_bns_earns   !jnb 02/15/2000
  Let #det_wcp_earns   = #r_det_wcp_earns   !jnb 02/15/2000
  Let #det_hol_earns   = #r_det_hol_earns   !jnb 02/15/2000
  Let #det_other_earns = #r_det_other_earns
  Do P240-Print-Detail

  Add #m_det_reg_earns   To #dept_m_reg_earnings
  Add #m_det_otp_earns   To #dept_m_otp_earnings
  Add #m_det_173_earns   To #dept_m_173_earnings		!Vendaxg Added for ITg#    on 07/08/2008
  Add #m_det_vac_earns   To #dept_m_vac_earnings
  Add #m_det_trn_earns   To #dept_m_trn_earnings    !jnb 02/15/2000
  Add #m_det_bns_earns   To #dept_m_bns_earnings    !jnb 02/15/2000
  Add #m_det_wcp_earns   To #dept_m_wcp_earnings    !jnb 02/15/2000
  Add #m_det_hol_earns   To #dept_m_hol_earnings    !jnb 02/15/2000
  Add #m_det_other_earns To #dept_m_other_earnings

  Add #c_det_reg_earns   To #dept_c_reg_earnings
  Add #c_det_otp_earns   To #dept_c_otp_earnings
  Add #c_det_173_earns   To #dept_c_173_earnings		!Vendaxg Added for ITg#    on 07/08/2008
  Add #c_det_vac_earns   To #dept_c_vac_earnings
  Add #c_det_trn_earns   To #dept_c_trn_earnings    !jnb 02/15/2000
  Add #c_det_bns_earns   To #dept_c_bns_earnings    !jnb 02/15/2000
  Add #c_det_wcp_earns   To #dept_c_wcp_earnings    !jnb 02/15/2000
  Add #c_det_hol_earns   To #dept_c_hol_earnings    !jnb 02/15/2000
  Add #c_det_other_earns To #dept_c_other_earnings

  Add #w_det_reg_earns   To #dept_w_reg_earnings
  Add #w_det_otp_earns   To #dept_w_otp_earnings
  Add #w_det_173_earns   To #dept_w_173_earnings		!Vendaxg Added for ITg#    on 07/08/2008
  Add #w_det_vac_earns   To #dept_w_vac_earnings
  Add #w_det_trn_earns   To #dept_w_trn_earnings    !jnb 02/15/2000
  Add #w_det_bns_earns   To #dept_w_bns_earnings    !jnb 02/15/2000
  Add #w_det_wcp_earns   To #dept_w_wcp_earnings    !jnb 02/15/2000
  Add #w_det_hol_earns   To #dept_w_hol_earnings    !jnb 02/15/2000
  Add #w_det_other_earns To #dept_w_other_earnings

  Add #t_det_reg_earns   To #dept_t_reg_earnings
  Add #t_det_otp_earns   To #dept_t_otp_earnings
  Add #t_det_173_earns   To #dept_t_173_earnings		!Vendaxg Added for ITg#    on 07/08/2008
  Add #t_det_vac_earns   To #dept_t_vac_earnings
  Add #t_det_trn_earns   To #dept_t_trn_earnings    !jnb 02/15/2000
  Add #t_det_bns_earns   To #dept_t_bns_earnings    !jnb 02/15/2000
  Add #t_det_wcp_earns   To #dept_t_wcp_earnings    !jnb 02/15/2000
  Add #t_det_hol_earns   To #dept_t_hol_earnings    !jnb 02/15/2000
  Add #t_det_other_earns To #dept_t_other_earnings

  Add #u_det_reg_earns   To #dept_u_reg_earnings
  Add #u_det_otp_earns   To #dept_u_otp_earnings
  Add #u_det_173_earns   To #dept_u_173_earnings		!Vendaxg Added for ITg#    on 07/08/2008
  Add #u_det_vac_earns   To #dept_u_vac_earnings
  Add #u_det_trn_earns   To #dept_u_trn_earnings    !jnb 02/15/2000
  Add #u_det_bns_earns   To #dept_u_bns_earnings    !jnb 02/15/2000
  Add #u_det_wcp_earns   To #dept_u_wcp_earnings    !jnb 02/15/2000
  Add #u_det_hol_earns   To #dept_u_hol_earnings    !jnb 02/15/2000
  Add #u_det_other_earns To #dept_u_other_earnings

  Add #n_det_reg_earns   To #dept_n_reg_earnings
  Add #n_det_otp_earns   To #dept_n_otp_earnings
  Add #n_det_173_earns   To #dept_n_173_earnings		!Vendaxg Added for ITg#    on 07/08/2008
  Add #n_det_vac_earns   To #dept_n_vac_earnings
  Add #n_det_trn_earns   To #dept_n_trn_earnings    !jnb 02/15/2000
  Add #n_det_bns_earns   To #dept_n_bns_earnings    !jnb 02/15/2000
  Add #n_det_wcp_earns   To #dept_n_wcp_earnings    !jnb 02/15/2000
  Add #n_det_hol_earns   To #dept_n_hol_earnings    !jnb 02/15/2000
  Add #n_det_other_earns To #dept_n_other_earnings

  Add #r_det_reg_earns   To #dept_r_reg_earnings
  Add #r_det_otp_earns   To #dept_r_otp_earnings
  Add #r_det_173_earns   To #dept_r_173_earnings		!Vendaxg Added for ITg#    on 07/08/2008
  Add #r_det_vac_earns   To #dept_r_vac_earnings
  Add #r_det_trn_earns   To #dept_r_trn_earnings    !jnb 02/15/2000
  Add #r_det_bns_earns   To #dept_r_bns_earnings    !jnb 02/15/2000
  Add #r_det_wcp_earns   To #dept_r_wcp_earnings    !jnb 02/15/2000
  Add #r_det_hol_earns   To #dept_r_hol_earnings    !jnb 02/15/2000
  Add #r_det_other_earns To #dept_r_other_earnings

  Let #m_det_reg_earns   = 0
  Let #m_det_otp_earns   = 0
  Let #m_det_173_earns   = 0				!Vendaxg Added for ITG#    on 07/08/2008
  Let #m_det_vac_earns   = 0
  Let #m_det_trn_earns   = 0   !jnb 02/15/2000
  Let #m_det_bns_earns   = 0   !jnb 02/15/2000
  Let #m_det_wcp_earns   = 0   !jnb 02/15/2000
  Let #m_det_hol_earns   = 0   !jnb 02/15/2000
  Let #m_det_other_earns = 0

  Let #c_det_reg_earns   = 0
  Let #c_det_otp_earns   = 0
  Let #c_det_173_earns   = 0				!Vendaxg Added for ITG#    on 07/08/2008
  Let #c_det_vac_earns   = 0
  Let #c_det_trn_earns   = 0   !jnb 02/15/2000
  Let #c_det_bns_earns   = 0   !jnb 02/15/2000
  Let #c_det_wcp_earns   = 0   !jnb 02/15/2000
  Let #c_det_hol_earns   = 0   !jnb 02/15/2000
  Let #c_det_other_earns = 0

  Let #w_det_reg_earns   = 0
  Let #w_det_otp_earns   = 0
  Let #w_det_173_earns   = 0				!Vendaxg Added for ITG#    on 07/08/2008
  Let #w_det_vac_earns   = 0
  Let #w_det_trn_earns   = 0   !jnb 02/15/2000
  Let #w_det_bns_earns   = 0   !jnb 02/15/2000
  Let #w_det_wcp_earns   = 0   !jnb 02/15/2000
  Let #w_det_hol_earns   = 0   !jnb 02/15/2000
  Let #w_det_other_earns = 0

  Let #t_det_reg_earns   = 0
  Let #t_det_otp_earns   = 0
  Let #t_det_173_earns   = 0				!Vendaxg Added for ITG#    on 07/08/2008
  Let #t_det_vac_earns   = 0
  Let #t_det_trn_earns   = 0   !jnb 02/15/2000
  Let #t_det_bns_earns   = 0   !jnb 02/15/2000
  Let #t_det_wcp_earns   = 0   !jnb 02/15/2000
  Let #t_det_hol_earns   = 0   !jnb 02/15/2000
  Let #t_det_other_earns = 0

  Let #u_det_reg_earns   = 0
  Let #u_det_otp_earns   = 0
  Let #u_det_173_earns   = 0				!Vendaxg Added for ITG#    on 07/08/2008
  Let #u_det_vac_earns   = 0
  Let #u_det_trn_earns   = 0   !jnb 02/15/2000
  Let #u_det_bns_earns   = 0   !jnb 02/15/2000
  Let #u_det_wcp_earns   = 0   !jnb 02/15/2000
  Let #u_det_hol_earns   = 0   !jnb 02/15/2000
  Let #u_det_other_earns = 0

  Let #n_det_reg_earns   = 0
  Let #n_det_otp_earns   = 0
  Let #n_det_173_earns   = 0				!Vendaxg Added for ITG#    on 07/08/2008
  Let #n_det_vac_earns   = 0
  Let #n_det_trn_earns   = 0   !jnb 02/15/2000
  Let #n_det_bns_earns   = 0   !jnb 02/15/2000
  Let #n_det_wcp_earns   = 0   !jnb 02/15/2000
  Let #n_det_hol_earns   = 0   !jnb 02/15/2000
  Let #n_det_other_earns = 0

  Let #r_det_reg_earns   = 0
  Let #r_det_otp_earns   = 0
  Let #r_det_173_earns   = 0				!Vendaxg Added for ITG#    on 07/08/2008
  Let #r_det_vac_earns   = 0
  Let #r_det_trn_earns   = 0   !jnb 02/15/2000
  Let #r_det_bns_earns   = 0   !jnb 02/15/2000
  Let #r_det_wcp_earns   = 0   !jnb 02/15/2000
  Let #r_det_hol_earns   = 0   !jnb 02/15/2000
  Let #r_det_other_earns = 0

  Let $m-det-report = 'N'
  Let $c-det-report = 'N'
  Let $w-det-report = 'N'
  Let $t-det-report = 'N'
  Let $u-det-report = 'N'
  Let $n-det-report = 'N'
End-Procedure


Begin-Procedure P240-Print-Detail
#debug9 Show 'P240-Print-Detail'

  Do Format-DateTime($pay_end_dt, $pay_end_date, {DEFDATE}, '', '')

  Print $emplid               (+1,1)
  Print #empl_rcd             (,12)  Edit 88
  Print &p.name               (,23)
!  Print $company              (,27)
!  Print $paygroup             (,40)
  Print $pay_end_date         (,54)
  Print #det_reg_earns        (,63)  Edit 999,999.99
  
  !Vendaxg Modified for ITG# on 07/08/2008 - Begin
  Print #det_otp_earns        (,75)  Edit 999,999.99
  Print #det_173_earns        (,87)  Edit 999,999.99
  Print #det_vac_earns        (,99)  Edit 999,999.99
  Print #det_trn_earns        (,111) Edit 999,999.99   !jnb 02/15/2000
  Print #det_bns_earns        (,123) Edit 999,999.99   !jnb 02/15/2000
  Print #det_wcp_earns        (,135) Edit 999,999.99   !jnb 02/15/2000
  Print #det_hol_earns        (,147) Edit 999,999.99   !jnb 02/15/2000
  Print #det_other_earns      (,159) Edit 999,999.99
  !Print #det_otp_earns        (,78)  Edit 999,999.99
  !Print #det_vac_earns        (,93)  Edit 999,999.99
  !Print #det_trn_earns        (,108) Edit 999,999.99   !jnb 02/15/2000
  !Print #det_bns_earns        (,123) Edit 999,999.99   !jnb 02/15/2000
  !Print #det_wcp_earns        (,138) Edit 999,999.99   !jnb 02/15/2000
  !Print #det_hol_earns        (,153) Edit 999,999.99   !jnb 02/15/2000
  !Print #det_other_earns      (,167) Edit 999,999.99
  !Vendaxg Modified for ITG# on 07/08/2008 - End
End-Procedure


Begin-Procedure P250-Deptid-Break
#debug9 Show 'P250-Deptid-Break'
  Use-Report Management
  New-Page

  Use-Report Clerical
  New-Page

  Use-Report Warehouse
  New-Page

  Use-Report Transportation
  New-Page

  Use-Report Union
  New-Page

  Use-Report NonUnion
  New-Page

  Use-Report DC
  New-Page

  Let $group = 'MANAGEMENT SALARIES:'
  Let #reg   = #dept_m_reg_earnings
  Let #otp   = #dept_m_otp_earnings
  Let #173   = #dept_m_173_earnings 		!Vendaxg Added for ITG#   on 07/08/2008
  Let #vac   = #dept_m_vac_earnings
  Let #trn   = #dept_m_trn_earnings     !JNB 02/15/2000
  Let #bns   = #dept_m_bns_earnings     !JNB 02/15/2000
  Let #wcp   = #dept_m_wcp_earnings     !JNB 02/15/2000
  Let #hol   = #dept_m_hol_earnings     !JNB 02/15/2000
  Let #other = #dept_m_other_earnings
  Do P220-Print-Summary

  Let $group = 'CLERICAL SALARIES:'
  Let #reg   = #dept_c_reg_earnings
  Let #otp   = #dept_c_otp_earnings
  Let #173   = #dept_c_173_earnings 		!Vendaxg Added for ITG#   on 07/08/2008
  Let #vac   = #dept_c_vac_earnings
  Let #trn   = #dept_c_trn_earnings     !JNB 02/15/2000
  Let #bns   = #dept_c_bns_earnings     !JNB 02/15/2000
  Let #wcp   = #dept_c_wcp_earnings     !JNB 02/15/2000
  Let #hol   = #dept_c_hol_earnings     !JNB 02/15/2000
  Let #other = #dept_c_other_earnings
  Do P220-Print-Summary

  New-Page

  Let $group = 'WAREHOUSE SALARIES:'
  Let #reg   = #dept_w_reg_earnings
  Let #otp   = #dept_w_otp_earnings
  Let #173   = #dept_w_173_earnings 		!Vendaxg Added for ITG#   on 07/08/2008
  Let #vac   = #dept_w_vac_earnings
  Let #trn   = #dept_w_trn_earnings     !JNB 02/15/2000
  Let #bns   = #dept_w_bns_earnings     !JNB 02/15/2000
  Let #wcp   = #dept_w_wcp_earnings     !JNB 02/15/2000
  Let #hol   = #dept_w_hol_earnings     !JNB 02/15/2000
  Let #other = #dept_w_other_earnings
  Do P220-Print-Summary

  Let $group = 'TRANSPORTATION SALARIES:'
  Let #reg   = #dept_t_reg_earnings
  Let #otp   = #dept_t_otp_earnings
  Let #173   = #dept_t_173_earnings 		!Vendaxg Added for ITG#   on 07/08/2008
  Let #vac   = #dept_t_vac_earnings
  Let #trn   = #dept_t_trn_earnings     !JNB 02/15/2000
  Let #bns   = #dept_t_bns_earnings     !JNB 02/15/2000
  Let #wcp   = #dept_t_wcp_earnings     !JNB 02/15/2000
  Let #hol   = #dept_t_hol_earnings     !JNB 02/15/2000
  Let #other = #dept_t_other_earnings
  Do P220-Print-Summary

  New-Page

  Let $group = 'UNION SALARIES:'
  Let #reg   = #dept_u_reg_earnings
  Let #otp   = #dept_u_otp_earnings
  Let #173   = #dept_u_173_earnings 		!Vendaxg Added for ITG#   on 07/08/2008
  Let #vac   = #dept_u_vac_earnings
  Let #trn   = #dept_u_trn_earnings     !JNB 02/15/2000
  Let #bns   = #dept_u_bns_earnings     !JNB 02/15/2000
  Let #wcp   = #dept_u_wcp_earnings     !JNB 02/15/2000
  Let #hol   = #dept_u_hol_earnings     !JNB 02/15/2000
  Let #other = #dept_u_other_earnings
  Do P220-Print-Summary

  Let $group = 'NON-UNION SALARIES:'
  Let #reg   = #dept_n_reg_earnings
  Let #otp   = #dept_n_otp_earnings
  Let #173   = #dept_n_173_earnings 		!Vendaxg Added for ITG#   on 07/08/2008
  Let #vac   = #dept_n_vac_earnings
  Let #trn   = #dept_n_trn_earnings     !JNB 02/15/2000
  Let #bns   = #dept_n_bns_earnings     !JNB 02/15/2000
  Let #wcp   = #dept_n_wcp_earnings     !JNB 02/15/2000
  Let #hol   = #dept_n_hol_earnings     !JNB 02/15/2000
  Let #other = #dept_n_other_earnings
  Do P220-Print-Summary

  New-Page

  Let $group = 'DISTRIBUTION CENTER SALARIES:'
  Let #reg   = #dept_r_reg_earnings
  Let #otp   = #dept_r_otp_earnings
  Let #173   = #dept_r_173_earnings 		!Vendaxg Added for ITG#   on 07/08/2008
  Let #vac   = #dept_r_vac_earnings
  Let #trn   = #dept_r_trn_earnings     !JNB 02/15/2000
  Let #bns   = #dept_r_bns_earnings     !JNB 02/15/2000
  Let #wcp   = #dept_r_wcp_earnings     !JNB 02/15/2000
  Let #hol   = #dept_r_hol_earnings     !JNB 02/15/2000
  Let #other = #dept_r_other_earnings
  Do P220-Print-Summary

  New-Page

  Add #dept_m_reg_earnings   To #bu_m_reg_earnings
  Add #dept_m_otp_earnings   To #bu_m_otp_earnings
  Add #dept_m_173_earnings   To #bu_m_173_earnings		!Vendaxg Added for ITG#   on 07/0/2008
  Add #dept_m_vac_earnings   To #bu_m_vac_earnings
  Add #dept_m_trn_earnings   To #bu_m_trn_earnings   !jnb 02/15/2000
  Add #dept_m_bns_earnings   To #bu_m_bns_earnings   !jnb 02/15/2000
  Add #dept_m_wcp_earnings   To #bu_m_wcp_earnings   !jnb 02/15/2000
  Add #dept_m_hol_earnings   To #bu_m_hol_earnings   !jnb 02/15/2000
  Add #dept_m_other_earnings To #bu_m_other_earnings

  Add #dept_c_reg_earnings   To #bu_c_reg_earnings
  Add #dept_c_otp_earnings   To #bu_c_otp_earnings
  Add #dept_c_173_earnings   To #bu_c_173_earnings		!Vendaxg Added for ITG#   on 07/0/2008
  Add #dept_c_vac_earnings   To #bu_c_vac_earnings
  Add #dept_c_trn_earnings   To #bu_c_trn_earnings   !jnb 02/15/2000
  Add #dept_c_bns_earnings   To #bu_c_bns_earnings   !jnb 02/15/2000
  Add #dept_c_wcp_earnings   To #bu_c_wcp_earnings   !jnb 02/15/2000
  Add #dept_c_hol_earnings   To #bu_c_hol_earnings   !jnb 02/15/2000
  Add #dept_c_other_earnings To #bu_c_other_earnings

  Add #dept_w_reg_earnings   To #bu_w_reg_earnings
  Add #dept_w_otp_earnings   To #bu_w_otp_earnings
  Add #dept_w_173_earnings   To #bu_w_173_earnings		!Vendaxg Added for ITG#   on 07/0/2008
  Add #dept_w_vac_earnings   To #bu_w_vac_earnings
  Add #dept_w_trn_earnings   To #bu_w_trn_earnings   !jnb 02/15/2000
  Add #dept_w_bns_earnings   To #bu_w_bns_earnings   !jnb 02/15/2000
  Add #dept_w_wcp_earnings   To #bu_w_wcp_earnings   !jnb 02/15/2000
  Add #dept_w_hol_earnings   To #bu_w_hol_earnings   !jnb 02/15/2000
  Add #dept_w_other_earnings To #bu_w_other_earnings

  Add #dept_t_reg_earnings   To #bu_t_reg_earnings
  Add #dept_t_otp_earnings   To #bu_t_otp_earnings
  Add #dept_t_173_earnings   To #bu_t_173_earnings		!Vendaxg Added for ITG#   on 07/0/2008
  Add #dept_t_vac_earnings   To #bu_t_vac_earnings
  Add #dept_t_trn_earnings   To #bu_t_trn_earnings   !jnb 02/15/2000
  Add #dept_t_bns_earnings   To #bu_t_bns_earnings   !jnb 02/15/2000
  Add #dept_t_wcp_earnings   To #bu_t_wcp_earnings   !jnb 02/15/2000
  Add #dept_t_hol_earnings   To #bu_t_hol_earnings   !jnb 02/15/2000
  Add #dept_t_other_earnings To #bu_t_other_earnings

  Add #dept_u_reg_earnings   To #bu_u_reg_earnings
  Add #dept_u_otp_earnings   To #bu_u_otp_earnings
  Add #dept_u_173_earnings   To #bu_u_173_earnings		!Vendaxg Added for ITG#   on 07/0/2008
  Add #dept_u_vac_earnings   To #bu_u_vac_earnings
  Add #dept_u_trn_earnings   To #bu_u_trn_earnings   !jnb 02/15/2000
  Add #dept_u_bns_earnings   To #bu_u_bns_earnings   !jnb 02/15/2000
  Add #dept_u_wcp_earnings   To #bu_u_wcp_earnings   !jnb 02/15/2000
  Add #dept_u_hol_earnings   To #bu_u_hol_earnings   !jnb 02/15/2000
  Add #dept_u_other_earnings To #bu_u_other_earnings

  Add #dept_n_reg_earnings   To #bu_n_reg_earnings
  Add #dept_n_otp_earnings   To #bu_n_otp_earnings
  Add #dept_n_173_earnings   To #bu_n_173_earnings		!Vendaxg Added for ITG#   on 07/0/2008
  Add #dept_n_vac_earnings   To #bu_n_vac_earnings
  Add #dept_n_trn_earnings   To #bu_n_trn_earnings   !jnb 02/15/2000
  Add #dept_n_bns_earnings   To #bu_n_bns_earnings   !jnb 02/15/2000
  Add #dept_n_wcp_earnings   To #bu_n_wcp_earnings   !jnb 02/15/2000
  Add #dept_n_hol_earnings   To #bu_n_hol_earnings   !jnb 02/15/2000
  Add #dept_n_other_earnings To #bu_n_other_earnings

  Add #dept_r_reg_earnings   To #bu_r_reg_earnings
  Add #dept_r_otp_earnings   To #bu_r_otp_earnings
  Add #dept_r_173_earnings   To #bu_r_173_earnings		!Vendaxg Added for ITG#   on 07/0/2008
  Add #dept_r_vac_earnings   To #bu_r_vac_earnings
  Add #dept_r_trn_earnings   To #bu_r_trn_earnings   !jnb 02/15/2000
  Add #dept_r_bns_earnings   To #bu_r_bns_earnings   !jnb 02/15/2000
  Add #dept_r_wcp_earnings   To #bu_r_wcp_earnings   !jnb 02/15/2000
  Add #dept_r_hol_earnings   To #bu_r_hol_earnings   !jnb 02/15/2000
  Add #dept_r_other_earnings To #bu_r_other_earnings

  Let #dept_m_reg_earnings   = 0
  Let #dept_m_otp_earnings   = 0
  Let #dept_m_173_earnings   = 0			!Vendaxg Added for ITG#   on 07/08/2008
  Let #dept_m_vac_earnings   = 0
  Let #dept_m_trn_earnings   = 0   !jnb 02/15/2000
  Let #dept_m_bns_earnings   = 0   !jnb 02/15/2000
  Let #dept_m_wcp_earnings   = 0   !jnb 02/15/2000
  Let #dept_m_hol_earnings   = 0   !jnb 02/15/2000
  Let #dept_m_other_earnings = 0

  Let #dept_c_reg_earnings   = 0
  Let #dept_c_otp_earnings   = 0
  Let #dept_c_173_earnings   = 0			!Vendaxg Added for ITG#   on 07/08/2008
  Let #dept_c_vac_earnings   = 0
  Let #dept_c_trn_earnings   = 0   !jnb 02/15/2000
  Let #dept_c_bns_earnings   = 0   !jnb 02/15/2000
  Let #dept_c_wcp_earnings   = 0   !jnb 02/15/2000
  Let #dept_c_hol_earnings   = 0   !jnb 02/15/2000
  Let #dept_c_other_earnings = 0

  Let #dept_w_reg_earnings   = 0
  Let #dept_w_otp_earnings   = 0
  Let #dept_w_173_earnings   = 0			!Vendaxg Added for ITG#   on 07/08/2008
  Let #dept_w_vac_earnings   = 0
  Let #dept_w_trn_earnings   = 0   !jnb 02/15/2000
  Let #dept_w_bns_earnings   = 0   !jnb 02/15/2000
  Let #dept_w_wcp_earnings   = 0   !jnb 02/15/2000
  Let #dept_w_hol_earnings   = 0   !jnb 02/15/2000
  Let #dept_w_other_earnings = 0

  Let #dept_t_reg_earnings   = 0
  Let #dept_t_otp_earnings   = 0
  Let #dept_t_173_earnings   = 0			!Vendaxg Added for ITG#   on 07/08/2008
  Let #dept_t_vac_earnings   = 0
  Let #dept_t_trn_earnings   = 0   !jnb 02/15/2000
  Let #dept_t_bns_earnings   = 0   !jnb 02/15/2000
  Let #dept_t_wcp_earnings   = 0   !jnb 02/15/2000
  Let #dept_t_hol_earnings   = 0   !jnb 02/15/2000
  Let #dept_t_other_earnings = 0

  Let #dept_u_reg_earnings   = 0
  Let #dept_u_otp_earnings   = 0
  Let #dept_u_173_earnings   = 0			!Vendaxg Added for ITG#   on 07/08/2008
  Let #dept_u_vac_earnings   = 0
  Let #dept_u_trn_earnings   = 0   !jnb 02/15/2000
  Let #dept_u_bns_earnings   = 0   !jnb 02/15/2000
  Let #dept_u_wcp_earnings   = 0   !jnb 02/15/2000
  Let #dept_u_hol_earnings   = 0   !jnb 02/15/2000
  Let #dept_u_other_earnings = 0

  Let #dept_n_reg_earnings   = 0
  Let #dept_n_otp_earnings   = 0
  Let #dept_n_173_earnings   = 0			!Vendaxg Added for ITG#   on 07/08/2008
  Let #dept_n_vac_earnings   = 0
  Let #dept_n_trn_earnings   = 0   !jnb 02/15/2000
  Let #dept_n_bns_earnings   = 0   !jnb 02/15/2000
  Let #dept_n_wcp_earnings   = 0   !jnb 02/15/2000
  Let #dept_n_hol_earnings   = 0   !jnb 02/15/2000
  Let #dept_n_other_earnings = 0

  Let #dept_r_reg_earnings   = 0
  Let #dept_r_otp_earnings   = 0
  Let #dept_r_173_earnings   = 0			!Vendaxg Added for ITG#   on 07/08/2008
  Let #dept_r_vac_earnings   = 0
  Let #dept_r_trn_earnings   = 0   !jnb 02/15/2000
  Let #dept_r_bns_earnings   = 0   !jnb 02/15/2000
  Let #dept_r_wcp_earnings   = 0   !jnb 02/15/2000
  Let #dept_r_hol_earnings   = 0   !jnb 02/15/2000
  Let #dept_r_other_earnings = 0
End-Procedure


Begin-Procedure P260-Business-Unit-Break
#debug9 Show 'P260-Business-Unit-Break'
  Let $department = ''
  Let $group = 'MANAGEMENT SALARIES:'
  Let #reg   = #bu_m_reg_earnings
  Let #otp   = #bu_m_otp_earnings
  Let #173   = #bu_m_173_earnings		!Vendaxg Added for ITG#   on 07/08/2008
  Let #vac   = #bu_m_vac_earnings
  Let #trn   = #bu_m_trn_earnings   !jnb 02/15/2000
  Let #bns   = #bu_m_bns_earnings   !jnb 02/15/2000
  Let #wcp   = #bu_m_wcp_earnings   !jnb 02/15/2000
  Let #hol   = #bu_m_hol_earnings   !jnb 02/15/2000

  Let #other = #bu_m_other_earnings
  Do P220-Print-Summary

  Let $group = 'CLERICAL SALARIES:'
  Let #reg   = #bu_c_reg_earnings
  Let #otp   = #bu_c_otp_earnings
  Let #173   = #bu_c_173_earnings		!Vendaxg Added for ITG#   on 07/08/2008
  Let #vac   = #bu_c_vac_earnings
  Let #trn   = #bu_c_trn_earnings   !jnb 02/15/2000
  Let #bns   = #bu_c_bns_earnings   !jnb 02/15/2000
  Let #wcp   = #bu_c_wcp_earnings   !jnb 02/15/2000
  Let #hol   = #bu_c_hol_earnings   !jnb 02/15/2000
  Let #other = #bu_c_other_earnings
  Do P220-Print-Summary

  Let $group = 'WAREHOUSE SALARIES:'
  Let #reg   = #bu_w_reg_earnings
  Let #otp   = #bu_w_otp_earnings
  Let #173   = #bu_w_173_earnings		!Vendaxg Added for ITG#   on 07/08/2008
  Let #vac   = #bu_w_vac_earnings
  Let #trn   = #bu_w_trn_earnings   !jnb 02/15/2000
  Let #bns   = #bu_w_bns_earnings   !jnb 02/15/2000
  Let #wcp   = #bu_w_wcp_earnings   !jnb 02/15/2000
  Let #hol   = #bu_w_hol_earnings   !jnb 02/15/2000
  Let #other = #bu_w_other_earnings
  Do P220-Print-Summary

  Let $group = 'TRANSPORTATION SALARIES:'
  Let #reg   = #bu_t_reg_earnings
  Let #otp   = #bu_t_otp_earnings
  Let #173   = #bu_t_173_earnings		!Vendaxg Added for ITG#   on 07/08/2008
  Let #vac   = #bu_t_vac_earnings
  Let #trn   = #bu_t_trn_earnings   !jnb 02/15/2000
  Let #bns   = #bu_t_bns_earnings   !jnb 02/15/2000
  Let #wcp   = #bu_t_wcp_earnings   !jnb 02/15/2000
  Let #hol   = #bu_t_hol_earnings   !jnb 02/15/2000
  Let #other = #bu_t_other_earnings
  Do P220-Print-Summary

  New-Page

  Let $group = 'UNION SALARIES:'
  Let #reg   = #bu_u_reg_earnings
  Let #otp   = #bu_u_otp_earnings
  Let #173   = #bu_u_173_earnings		!Vendaxg Added for ITG#   on 07/08/2008
  Let #vac   = #bu_u_vac_earnings
  Let #trn   = #bu_u_trn_earnings   !jnb 02/15/2000
  Let #bns   = #bu_u_bns_earnings   !jnb 02/15/2000
  Let #wcp   = #bu_u_wcp_earnings   !jnb 02/15/2000
  Let #hol   = #bu_u_hol_earnings   !jnb 02/15/2000
  Let #other = #bu_u_other_earnings
  Do P220-Print-Summary

  Let $group = 'NON-UNION SALARIES:'
  Let #reg   = #bu_n_reg_earnings
  Let #otp   = #bu_n_otp_earnings
  Let #173   = #bu_n_173_earnings		!Vendaxg Added for ITG#   on 07/08/2008
  Let #vac   = #bu_n_vac_earnings
  Let #trn   = #bu_n_trn_earnings   !jnb 02/15/2000
  Let #bns   = #bu_n_bns_earnings   !jnb 02/15/2000
  Let #wcp   = #bu_n_wcp_earnings   !jnb 02/15/2000
  Let #hol   = #bu_n_hol_earnings   !jnb 02/15/2000
  Let #other = #bu_n_other_earnings
  Do P220-Print-Summary

  New-Page

  Let $group = 'DISTRIBUTION CENTER SALARIES:'
  Let #reg   = #bu_r_reg_earnings
  Let #otp   = #bu_r_otp_earnings
  Let #173   = #bu_r_173_earnings		!Vendaxg Added for ITG#   on 07/08/2008
  Let #vac   = #bu_r_vac_earnings
  Let #trn   = #bu_r_trn_earnings   !jnb 02/15/2000
  Let #bns   = #bu_r_bns_earnings   !jnb 02/15/2000
  Let #wcp   = #bu_r_wcp_earnings   !jnb 02/15/2000
  Let #hol   = #bu_r_hol_earnings   !jnb 02/15/2000
  Let #other = #bu_r_other_earnings
  Do P220-Print-Summary

  New-Page
End-Procedure

! JNB 01/31/2000  begin

!*********************************************************************
!Gets the pay end date of the previous pay cycle.
!*********************************************************************

Begin-Procedure get-pay-end-dt
#debug9 Show 'get-pay-end-dt'

move 'N' to $found

begin-select 
PAY.PAY_BEGIN_DT
PAY.PAY_END_DT

  move &PAY.PAY_END_DT to $ThruDate
  move &PAY.PAY_BEGIN_DT to $FromDate

  display 'From Date:' noline
  display $FromDate
  display 'Thru Date:' noline
  display $ThruDate
  move 'Y' to $found
  exit-select

FROM PS_PAY_CALENDAR PAY

WHERE PAY.PAY_CONFIRM_RUN = 'Y'
  AND PAY.COMPANY  = 'GEI'
  AND PAY.PAYGROUP = 'RET'
  AND PAY.PAY_END_DT = (SELECT MAX(PAY_END_DT)
		      FROM PS_PAY_CALENDAR
		     WHERE PAY_END_DT <= $AsOfToday
		       AND PAY_CONFIRM_RUN = 'Y'
                   AND COMPANY = 'GEI'
                   AND PAYGROUP = 'RET') 

end-select

if $found = 'N'
   print 'No Previously confirmed Pay Cycle as of:' (,34)
   print $AsOfToday ()
   stop
end-if

end-procedure



Begin-Procedure P300-Finalization
#debug9 Show 'P300-Finalization'
  date-time () HH:MI:SS &timeEnded
  date-time () MM/DD/YYYY &dateEnded
  show 'Report Ended at ' &timeEnded ' on ' &dateEnded
  show ' '

  If $m-data-found <> 'Y'
    Use-Report Management
    Print 'NO DATA SELECTED FOR THIS REPORT RUN'	(25,) Center
  End-If

  If $c-data-found <> 'Y'
    Use-Report Clerical
    Print 'NO DATA SELECTED FOR THIS REPORT RUN'	(25,) Center
  End-If

  If $w-data-found <> 'Y'
    Use-Report Warehouse
    Print 'NO DATA SELECTED FOR THIS REPORT RUN'	(25,) Center
  End-If

  If $t-data-found <> 'Y'
    Use-Report Transportation
    Print 'NO DATA SELECTED FOR THIS REPORT RUN'	(25,) Center
  End-If

  If $u-data-found <> 'Y'
    Use-Report Union
    Print 'NO DATA SELECTED FOR THIS REPORT RUN'	(25,) Center
  End-If

  If $n-data-found <> 'Y'
    Use-Report NonUnion
    Print 'NO DATA SELECTED FOR THIS REPORT RUN'	(25,) Center
  End-If

  If $m-data-found <> 'Y' And
     $c-data-found <> 'Y' And
     $w-data-found <> 'Y' And
     $t-data-found <> 'Y' And
     $u-data-found <> 'Y' And
     $n-data-found <> 'Y'
    Use-Report DC
    Print 'NO DATA SELECTED FOR THIS REPORT RUN'	(25,) Center
    Use-Report Summary
    Print 'NO DATA SELECTED FOR THIS REPORT RUN'	(25,) Center
  End-If

  Do Reset                   !reset.sqc
  Do Stdapi-Term             !stdapi.sqc
  Show 'Successful end of report'
End-Procedure


#include 'gexxx935.sqc'  !Get department multiple row table
#include 'gexxx936.sqc'  !Get business_unit multiple row table
#include 'gexxx922.sqc'  !Get pay single row run control
#Include 'reset.sqc'     !Reset printer procedure
#Include 'curdttim.sqc'  !Get-Current-DateTime procedure
#Include 'datetime.sqc'  !Routines for date and time formatting
#Include 'number.sqc'    !Routines to format numbers
#Include 'stdapi.sqc'    !Update Process API
#Include 'datemath.sqc'  !Does the date-math functions
#Include 'getbalid.sqc'  !Get-Calendar-Year-Id
#Include 'askftd.sqc'    !Ask-From-Thru-Date procedure

